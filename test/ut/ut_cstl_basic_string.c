#include <stddef.h>
#include <stdarg.h>
#include <setjmp.h>
#include <google/cmockery.h>

#include "cstl/cstl_def.h"
#include "cstl/citerator.h"
#include "cstl/clist.h"
#include "cstl/cvector.h"
#include "cstl/cstl_basic_string_iterator.h"
#include "cstl/cstl_basic_string_private.h"
#include "cstl/cstl_basic_string.h"
#include "cstl_basic_string_aux.h"

#include "ut_def.h"
#include "ut_cstl_basic_string.h"

UT_SUIT_DEFINATION(cstl_basic_string, basic_string_init)

/*
 * test basic_string_init
 */
UT_CASE_DEFINATION(basic_string_init)
void test_basic_string_init__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_init(NULL));
}

void test_basic_string_init__non_created(void** state)
{
    basic_string_t bstr;
    bstr._pby_string = NULL;
    expect_assert_failure(basic_string_init(&bstr));
}

void test_basic_string_init__successfully_c_builtin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_size(pt_basic_string) == 0);
    assert_true(basic_string_capacity(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init__successfully_cstl_builtin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_size(pt_basic_string) == 0);
    assert_true(basic_string_capacity(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init__successfully_cstr(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_size(pt_basic_string) == 0);
    assert_true(basic_string_capacity(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init__successfully_user_defined(void** state)
{
    typedef struct _tagtest_basic_string_init__successfully_user_defined
    {
        int n_elem;
    }_test_basic_string_init__successfully_user_defined_t;
    basic_string_t* pt_basic_string = NULL;

    type_register(_test_basic_string_init__successfully_user_defined_t, NULL, NULL, NULL, NULL);

    pt_basic_string = create_basic_string(_test_basic_string_init__successfully_user_defined_t);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_size(pt_basic_string) == 0);
    assert_true(basic_string_capacity(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_init_cstr
 */
UT_CASE_DEFINATION(basic_string_init_cstr)
void test_basic_string_init_cstr__null_container(void** state)
{
    expect_assert_failure(basic_string_init_cstr(NULL, "abcdef"));
}

void test_basic_string_init_cstr__non_created_container(void** state)
{
    basic_string_t bstr;
    bstr._t_typeinfo._t_style = 24455656;
    expect_assert_failure(basic_string_init_cstr(&bstr, "abcdefg"));
}

void test_basic_string_init_cstr__null_valuestring(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_init_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_cstr__c_builtin_init_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elem = 0;

    basic_string_init_cstr(pt_basic_string, &elem);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_cstr__c_builtin_init_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);
    assert_true(*(int*)basic_string_at(pt_basic_string, 2) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_cstr__char_init_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "");
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_cstr__char_init_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abc");
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(*(char*)basic_string_at(pt_basic_string, 0) == 'a');
    assert_true(*(char*)basic_string_at(pt_basic_string, 1) == 'b');
    assert_true(*(char*)basic_string_at(pt_basic_string, 2) == 'c');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_cstr__cstr_init_empty(void** state)
{
    /*
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    */
    assert_true(false);
}

void test_basic_string_init_cstr__cstr_init_non_empty(void** state)
{
    /*
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "hij") == 0);

    basic_string_destroy(pt_basic_string);
    */
    assert_true(false);
}

void test_basic_string_init_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_cstr__libcstl_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_init_cstr__user_define
{
    int n_elem;
    double d_elem;
}_test_basic_string_init_cstr__user_define_t;
void test_basic_string_init_cstr__user_define_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_init_cstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_init_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_init_cstr__user_define_t);

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_cstr__user_define_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_init_cstr__user_define_t);
    _test_basic_string_init_cstr__user_define_t t_user1;
    _test_basic_string_init_cstr__user_define_t t_user2;
    _test_basic_string_init_cstr__user_define_t* elems[5] = {&t_user1, &t_user2, &t_user2, NULL, &t_user1};

    t_user1.n_elem = 4;
    t_user1.d_elem = 9.4;
    t_user2.n_elem = 0;
    t_user2.d_elem = 0.0;
    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(((_test_basic_string_init_cstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_init_cstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 9.4);
    assert_true(((_test_basic_string_init_cstr__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 0);
    assert_true(((_test_basic_string_init_cstr__user_define_t*)basic_string_at(pt_basic_string, 1))->d_elem == 0.0);
    assert_true(((_test_basic_string_init_cstr__user_define_t*)basic_string_at(pt_basic_string, 2))->n_elem == 0);
    assert_true(((_test_basic_string_init_cstr__user_define_t*)basic_string_at(pt_basic_string, 2))->d_elem == 0.0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_init_subcstr
 */
UT_CASE_DEFINATION(basic_string_init_subcstr)
void test_basic_string_init_subcstr__null_container(void** state)
{
    expect_assert_failure(basic_string_init_subcstr(NULL, "abcdef", 0));
}

void test_basic_string_init_subcstr__non_created_container(void** state)
{
    basic_string_t bstr;
    bstr._t_typeinfo._t_style = 24455656;
    expect_assert_failure(basic_string_init_subcstr(&bstr, "abcdefg", NPOS));
}

void test_basic_string_init_subcstr__null_valuestring(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_init_subcstr(pt_basic_string, NULL, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__length_ge_max_size(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    expect_assert_failure(basic_string_init_subcstr(pt_basic_string, elems, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__c_builtin_init_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__c_builtin_init_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init_subcstr(pt_basic_string, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__c_builtin_init_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init_subcstr(pt_basic_string, elems, 6);
    assert_true(basic_string_size(pt_basic_string) == 6);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);
    assert_true(*(int*)basic_string_at(pt_basic_string, 2) == 2);
    assert_true(*(int*)basic_string_at(pt_basic_string, 3) == 0);
    assert_true(*(int*)basic_string_at(pt_basic_string, 4) == 13);
    assert_true(*(int*)basic_string_at(pt_basic_string, 5) == 5455);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__char_init_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_subcstr(pt_basic_string, "abc", 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__char_init_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_subcstr(pt_basic_string, "abc", 1);
    assert_true(basic_string_size(pt_basic_string) == 1);
    assert_true(*(char*)basic_string_at(pt_basic_string, 0) == 'a');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__char_init_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    char a[] = {'a', 'b', 'c', '\0', 'd', 'e'};

    basic_string_init_subcstr(pt_basic_string, a, 6);
    assert_true(basic_string_size(pt_basic_string) == 6);
    assert_true(*(char*)basic_string_at(pt_basic_string, 0) == 'a');
    assert_true(*(char*)basic_string_at(pt_basic_string, 1) == 'b');
    assert_true(*(char*)basic_string_at(pt_basic_string, 2) == 'c');
    assert_true(*(char*)basic_string_at(pt_basic_string, 3) == '\0');
    assert_true(*(char*)basic_string_at(pt_basic_string, 4) == 'd');
    assert_true(*(char*)basic_string_at(pt_basic_string, 5) == 'e');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__cstr_init_empty(void** state)
{
    /*
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    */
    assert_true(false);
}

void test_basic_string_init_subcstr__cstr_init_non_empty(void** state)
{
    /*
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_subcstr(pt_basic_string, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);

    basic_string_destroy(pt_basic_string);
    */
    assert_true(false);
}

void test_basic_string_init_subcstr__cstr_init_total(void** state)
{
    /*
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_subcstr(pt_basic_string, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "hij") == 0);

    basic_string_destroy(pt_basic_string);
    */
    assert_true(false);
}

void test_basic_string_init_subcstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_init_subcstr__libcstl_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init_subcstr(pt_basic_string, elems, 1);
    assert_true(basic_string_size(pt_basic_string) == 1);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_init_subcstr__libcstl_builtin_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init_subcstr(pt_basic_string, elems, 5);
    assert_true(basic_string_size(pt_basic_string) == 5);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_init_subcstr__user_define
{
    int n_elem;
    double d_elem;
}_test_basic_string_init_subcstr__user_define_t;
void test_basic_string_init_subcstr__user_define_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_init_subcstr__user_define_t t_user;
    _test_basic_string_init_subcstr__user_define_t* elems[5] = {&t_user, &t_user, &t_user, NULL, &t_user};

    type_register(_test_basic_string_init_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_init_subcstr__user_define_t);

    basic_string_init_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__user_define_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_init_subcstr__user_define_t);
    _test_basic_string_init_subcstr__user_define_t t_user;
    _test_basic_string_init_subcstr__user_define_t* elems[5] = {&t_user, &t_user, &t_user, NULL, &t_user};

    t_user.n_elem = 4;
    t_user.d_elem = 0.0;
    basic_string_init_subcstr(pt_basic_string, elems, 1);
    assert_true(basic_string_size(pt_basic_string) == 1);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 0.0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_subcstr__user_define_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_init_subcstr__user_define_t);
    _test_basic_string_init_subcstr__user_define_t t_user1;
    _test_basic_string_init_subcstr__user_define_t t_user2;
    _test_basic_string_init_subcstr__user_define_t t_user3;
    _test_basic_string_init_subcstr__user_define_t* elems[5] = {&t_user1, &t_user2, &t_user3, NULL, &t_user1};

    t_user1.n_elem = 4; t_user1.d_elem = 0.0;
    t_user2.n_elem = 0; t_user2.d_elem = 9.24;
    t_user3.n_elem = 0; t_user3.d_elem = 0.0;
    basic_string_init_subcstr(pt_basic_string, elems, 5);
    assert_true(basic_string_size(pt_basic_string) == 5);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 0.0);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 0);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 1))->d_elem == 9.24);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 2))->n_elem == 0);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 2))->d_elem == 0.0);
    assert_true(basic_string_at(pt_basic_string, 3) == NULL);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 4))->n_elem == 4);
    assert_true(((_test_basic_string_init_subcstr__user_define_t*)basic_string_at(pt_basic_string, 4))->d_elem == 0.0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_init_copy
 */
UT_CASE_DEFINATION(basic_string_init_copy)
void test_basic_string_init_copy__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_init_copy(NULL, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_copy__null_src(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_init_copy(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_copy__non_create_dest(void** state)
{
    basic_string_t bstr;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    bstr._t_typeinfo._pt_type = NULL;
    expect_assert_failure(basic_string_init_copy(&bstr, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_copy__non_inited_src(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    expect_assert_failure(basic_string_init_copy(pt_dest, pt_src));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);
    basic_string_init(pt_src);

    expect_assert_failure(basic_string_init_copy(pt_dest, pt_src));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__successfully_c_builtin_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 0);
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__successfully_c_builtin_little(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_src, 10, 2010);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 10);
    /*assert_true(basic_string_capacity(pt_dest) == 26);*/
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__successfully_c_builtin_huge(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_src, 1000, 2010);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 1000);
    /*assert_true(basic_string_capacity(pt_dest) == 1500);*/
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__successfully_cstr_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 0);
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__successfully_cstr_little(void** state)
{
    /*
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_src, 19, "c-string");

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 35);
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy__successfully_cstr_huge(void** state)
{
    /*
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_src, 19000, "c-string");

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 28500);
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy__successfully_cstl_builtin_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init_elem(pt_elem, 23, 21234);
    basic_string_init(pt_src);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 0);
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy__successfully_cstl_builtin_little(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init_elem(pt_elem, 23, 21234);
    basic_string_init_elem(pt_src, 32, pt_elem);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 32);
    /*assert_true(basic_string_capacity(pt_dest) == 48);*/
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy__successfully_cstl_builtin_huge(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init_elem(pt_elem, 23, 21234);
    basic_string_init_elem(pt_src, 3702, pt_elem);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 3702);
    /*assert_true(basic_string_capacity(pt_dest) == 5553);*/
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

typedef struct _tag_test_basic_string_init_copy__successfully_user_define
{
    int n_elem;
}_test_basic_string_init_copy__successfully_user_define_t;
void test_basic_string_init_copy__successfully_user_define_empty(void** state)
{
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    type_register(_test_basic_string_init_copy__successfully_user_define_t, NULL, NULL, NULL, NULL);
    pt_dest = create_basic_string(_test_basic_string_init_copy__successfully_user_define_t);
    pt_src = create_basic_string(_test_basic_string_init_copy__successfully_user_define_t);
    basic_string_init(pt_src);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 0);
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__successfully_user_define_little(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy__successfully_user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_src, 17, &t_user);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 17);
    /*assert_true(basic_string_capacity(pt_dest) == 33);*/
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__successfully_user_define_huge(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy__successfully_user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_src, 11117, &t_user);

    basic_string_init_copy(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == basic_string_size(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 11117);
    /*assert_true(basic_string_capacity(pt_dest) == 16675);*/
    assert_true(pt_dest->_pby_string == pt_src->_pby_string);
    assert_true(_basic_string_rep_is_shared(_basic_string_rep_get_representation(pt_dest->_pby_string)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy__multi_shared(void** state)
{
    basic_string_t* pbstr1 = create_basic_string(int);
    basic_string_t* pbstr2 = create_basic_string(int);
    basic_string_t* pbstr3 = create_basic_string(int);
    basic_string_t* pbstr4 = create_basic_string(int);

    basic_string_init(pbstr1);
    basic_string_init_copy(pbstr2, pbstr1);
    basic_string_init_copy(pbstr3, pbstr2);
    basic_string_init_copy(pbstr4, pbstr2);

    assert(pbstr1->_pby_string == pbstr2->_pby_string);
    assert(pbstr3->_pby_string == pbstr2->_pby_string);
    assert(pbstr3->_pby_string == pbstr4->_pby_string);
    assert(_basic_string_rep_get_representation(pbstr1->_pby_string)->_n_refcount == 3);

    basic_string_destroy(pbstr1);
    basic_string_destroy(pbstr2);
    basic_string_destroy(pbstr3);
    basic_string_destroy(pbstr4);
}

/*
 * test basic_string_init_copy_substring
 */
UT_CASE_DEFINATION(basic_string_init_copy_substring)
void test_basic_string_init_copy_substring__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_init_copy_substring(NULL, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_copy_substring__null_src(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_init_copy_substring(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_copy_substring__non_create_dest(void** state)
{
    basic_string_t bstr;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    bstr._t_typeinfo._pt_type = NULL;
    expect_assert_failure(basic_string_init_copy_substring(&bstr, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_init_copy_substring__non_inited_src(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, 0, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);
    basic_string_init(pt_src);

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, 0, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_begin_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_src, 10, 100);

    basic_string_init_copy_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);
    assert_true(basic_string_capacity(pt_dest) == 0);
    assert_true(pt_dest->_pby_string != pt_src->_pby_string);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(basic_string_capacity(pt_dest) == 3);
    assert_true(pt_dest->_pby_string != pt_src->_pby_string);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_begin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == basic_string_length(pt_src));
    assert_true(basic_string_capacity(pt_dest) == 10);
    assert_true(pt_dest->_pby_string != pt_src->_pby_string);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == basic_string_length(pt_src));
    assert_true(pt_dest->_pby_string != pt_src->_pby_string);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 0);
    assert_true(basic_string_capacity(pt_dest) == 0);
    assert_true(pt_dest->_pby_string != pt_src->_pby_string);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, 4);
    assert_true(basic_string_size(pt_dest) == 4);
    assert_true(basic_string_capacity(pt_dest) == 4);
    assert_true(pt_dest->_pby_string != pt_src->_pby_string);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_middle_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, basic_string_length(pt_src)-3);
    assert_true(basic_string_size(pt_dest) == 7);
    assert_true(basic_string_capacity(pt_dest) == 7);
    assert_true(pt_dest->_pby_string != pt_src->_pby_string);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 7);
    assert_true(basic_string_capacity(pt_dest) == 7);
    assert_true(pt_dest->_pby_string != pt_src->_pby_string);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_end(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_c_builtin_src_non_empty_npos(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_begin_empty(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_src, 10, "abcdefg");

    basic_string_init_copy_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);
    assert_true(basic_string_capacity(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_begin_non_empty(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_init_copy_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "hij") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_begin_length(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_init_copy_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 5);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 3), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 4), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_begin_npos(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_init_copy_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 5);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 3), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 4), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_middle_empty(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_init_copy_substring(pt_dest, pt_src, 2, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_middle_non_empty(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_init_copy_substring(pt_dest, pt_src, 2, 2);
    assert_true(basic_string_size(pt_dest) == 2);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "klm") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_middle_length(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_init_copy_substring(pt_dest, pt_src, 2, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_middle_npos(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_init_copy_substring(pt_dest, pt_src, 2, NPOS);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_end(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, basic_string_length(pt_src), 0));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstr_src_non_empty_npos(void** state)
{
    /*
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, NPOS, 0));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_src_non_empty_begin_empty(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);
    assert_true(basic_string_capacity(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, 2);
    assert_true(basic_string_size(pt_dest) == 2);
    assert_true(basic_string_capacity(pt_dest) == 2);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_non_empty_begin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 10);
    assert_true(basic_string_capacity(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 10);
    assert_true(basic_string_capacity(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 0);
    assert_true(basic_string_capacity(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(basic_string_capacity(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_non_empty_middle_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 7);
    assert_true(basic_string_capacity(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 7);
    assert_true(basic_string_capacity(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_substring__successfully_cstl_builtin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

typedef struct _tag_test_basic_string_init_copy_substring__successfully_user_define
{
    int n_elem;
}_test_basic_string_init_copy_substring__successfully_user_define_t;
void test_basic_string_init_copy_substring__successfully_user_define_non_empty_begin_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    type_register(_test_basic_string_init_copy_substring__successfully_user_define_t, NULL, NULL, NULL, NULL);
    pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_init_copy_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_begin_length(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_init_copy_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_init_copy_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_init_copy_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_middle_length(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_init_copy_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_init_copy_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_init_copy_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_end(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_substring__successfully_user_define_non_empty_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_init_copy_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_init_copy_substring__successfully_user_define_t);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    expect_assert_failure(basic_string_init_copy_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_init_copy_range
 */
UT_CASE_DEFINATION(basic_string_init_copy_range)
void test_basic_string_init_copy_range__null_dest(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt);
    it_begin = basic_string_begin(pt);
    it_end = basic_string_end(pt);

    expect_assert_failure(basic_string_init_copy_range(NULL, it_begin, it_end));

    basic_string_destroy(pt);
}

void test_basic_string_init_copy_range__invalid_begin_iterator(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_src);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    it_begin._t_iteratortype = 23445;
    expect_assert_failure(basic_string_init_copy_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_range__invalid_end_iterator(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_src);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    it_end._t_containertype = 9999;
    expect_assert_failure(basic_string_init_copy_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_range__invalid_range(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    expect_assert_failure(basic_string_init_copy_range(pt_dest, it_end, it_begin));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_range__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    expect_assert_failure(basic_string_init_copy_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_range__successfully_empty_range(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    basic_string_init_copy_range(pt_dest, it_begin, it_begin);
    assert_true(basic_string_size(pt_dest) == 0);
    assert_true(basic_string_capacity(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_range__successfully_c_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }
    it_begin = iterator_next_n(basic_string_begin(pt_src), 3);
    it_end = iterator_next_n(it_begin, 5);

    basic_string_init_copy_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    assert_true(basic_string_capacity(pt_dest) == 5);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_init_copy_range__successfully_cstr(void** state)
{
    /*
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_src, 100, "abcdefg");
    it_begin = basic_string_begin(pt_src);
    it_end = iterator_next_n(it_begin, 10);

    basic_string_init_copy_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    assert_true(basic_string_capacity(pt_dest) == 26);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(strcmp((char*)basic_string_at(pt_dest, i), "abcdefg") == 0);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
    assert_true(false);
}

void test_basic_string_init_copy_range__successfully_cstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    list_init_elem(pt_elem, 18, 23);
    basic_string_init_elem(pt_src, 1004, pt_elem);
    it_begin = iterator_next_n(basic_string_begin(pt_src), 100);
    it_end = basic_string_end(pt_src);

    basic_string_init_copy_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    assert_true(basic_string_capacity(pt_dest) == 904);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(list_equal((list_t*)basic_string_at(pt_dest, i), pt_elem));
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_init_copy_range__successfully_user_define(void** state)
{
    typedef struct _tag_test_basic_string_init_copy_range__successfully_user_define
    {
        int n_elem;
    }_test_basic_string_init_copy_range__successfully_user_define_t;

    size_t i = 0;
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;
    _test_basic_string_init_copy_range__successfully_user_define_t t_user;

    type_register(_test_basic_string_init_copy_range__successfully_user_define_t, NULL, NULL, NULL, NULL);

    pt_dest = create_basic_string(_test_basic_string_init_copy_range__successfully_user_define_t);
    pt_src = create_basic_string(_test_basic_string_init_copy_range__successfully_user_define_t);

    t_user.n_elem = 28743;
    basic_string_init_elem(pt_src, 10000, &t_user);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    basic_string_init_copy_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    assert_true(basic_string_capacity(pt_dest) == 10000);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(memcmp((_test_basic_string_init_copy_range__successfully_user_define_t*)basic_string_at(pt_dest, i),
            &t_user, sizeof(t_user)) == 0);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_destroy
 */
UT_CASE_DEFINATION(basic_string_destroy)
void test_basic_string_destroy__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_destroy(NULL));
}

void test_basic_string_destroy__non_created(void** state)
{
    basic_string_t bstr;
    bstr._t_typeinfo._t_style = 99999;

    expect_assert_failure(basic_string_destroy(&bstr));
}

void test_basic_string_destroy__created_non_inited(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_destroy__inited_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_destroy__inited_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 199, 100);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_destroy__shared(void** state)
{
    basic_string_t* pbstr1 = create_basic_string(int);
    basic_string_t* pbstr2 = create_basic_string(int);
    basic_string_init_elem(pbstr1, 10, 111);
    basic_string_init_copy(pbstr2, pbstr1);
    assert_true(_basic_string_rep_get_representation(pbstr1->_pby_string)->_n_refcount == 1);
    basic_string_destroy(pbstr2);
    assert_true(_basic_string_rep_get_representation(pbstr1->_pby_string)->_n_refcount == 0);
    basic_string_destroy(pbstr1);
}

/*
 * test basic_string_c_str
 */
UT_CASE_DEFINATION(basic_string_c_str)
void test_basic_string_c_str__null_container(void** state)
{
    expect_assert_failure(basic_string_c_str(NULL));
}

void test_basic_string_c_str__non_inited_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_c_str(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_c_str__empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int* pn = NULL;

    basic_string_init(pt_basic_string);
    pn = (int*)basic_string_c_str(pt_basic_string);
    assert_true(pn != NULL);
    assert_true(pn[0] == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_c_str__non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int* pn = NULL;

    basic_string_init(pt_basic_string);
    basic_string_push_back(pt_basic_string, 0);
    basic_string_push_back(pt_basic_string, 2);
    basic_string_push_back(pt_basic_string, 199);
    basic_string_push_back(pt_basic_string, 5);
    pn = (int*)basic_string_c_str(pt_basic_string);
    assert_true(pn != NULL);
    assert_true(pn[0] == 0);
    assert_true(pn[1] == 2);
    assert_true(pn[2] == 199);
    assert_true(pn[3] == 5);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_data
 */
UT_CASE_DEFINATION(basic_string_data)
void test_basic_string_data__null_container(void** state)
{
    expect_assert_failure(basic_string_data(NULL));
}

void test_basic_string_data__non_inited_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_data(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_data__empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int* pn = NULL;

    basic_string_init(pt_basic_string);
    pn = (int*)basic_string_data(pt_basic_string);
    assert_true(pn != NULL);
    assert_true(pn[0] == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_data__non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int* pn = NULL;

    basic_string_init(pt_basic_string);
    basic_string_push_back(pt_basic_string, 0);
    basic_string_push_back(pt_basic_string, 2);
    basic_string_push_back(pt_basic_string, 199);
    basic_string_push_back(pt_basic_string, 5);
    pn = (int*)basic_string_data(pt_basic_string);
    assert_true(pn != NULL);
    assert_true(pn[0] == 0);
    assert_true(pn[1] == 2);
    assert_true(pn[2] == 199);
    assert_true(pn[3] == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_data__shared(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pbstr = create_basic_string(int);
    int* pn = NULL;
    int* pn1 = NULL;

    basic_string_init(pt_basic_string);
    basic_string_push_back(pt_basic_string, 0);
    basic_string_push_back(pt_basic_string, 2);
    basic_string_push_back(pt_basic_string, 199);
    basic_string_push_back(pt_basic_string, 5);
    basic_string_init_copy(pbstr, pt_basic_string);
    pn = (int*)basic_string_data(pt_basic_string);
    assert_true(pn != NULL);
    assert_true(pn[0] == 0);
    assert_true(pn[1] == 2);
    assert_true(pn[2] == 199);
    assert_true(pn[3] == 5);
    pn1 = (int*)basic_string_data(pbstr);
    assert_true(pn == pn1);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pbstr);
}

/*
 * test basic_string_copy
 */
UT_CASE_DEFINATION(basic_string_copy)
void test_basic_string_copy__null_container(void** state)
{
    int buffer[10];
    expect_assert_failure(basic_string_copy(NULL, buffer, 0, 0));
}

void test_basic_string_copy__non_inited_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[10];

    expect_assert_failure(basic_string_copy(pt_basic_string, buffer, 0, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__null_buffer(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_copy(pt_basic_string, NULL, 0, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__invalid_position(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[10];
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_copy(pt_basic_string, buffer, 0, 100));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[10] = {0};
    size_t t_size = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);

    t_size = basic_string_copy(pt_basic_string, buffer, 0, 0);
    assert_true(t_size == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__begin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[10] = {0};
    size_t t_size = 0;
    size_t i = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);

    t_size = basic_string_copy(pt_basic_string, buffer, 4, 0);
    assert_true(t_size == 4);
    for(i = 0; i < 10; ++i)
    {
        if(i < t_size)
        {
            assert_true(buffer[i] == 100);
        }
        else
        {
            assert_true(buffer[i] == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__begin_length(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[20] = {0};
    size_t t_size = 0;
    size_t i = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);

    t_size = basic_string_copy(pt_basic_string, buffer, 10, 0);
    assert_true(t_size == 10);
    for(i = 0; i < 20; ++i)
    {
        if(i < t_size)
        {
            assert_true(buffer[i] == 100);
        }
        else
        {
            assert_true(buffer[i] == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__begin_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[20] = {0};
    size_t t_size = 0;
    size_t i = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);

    t_size = basic_string_copy(pt_basic_string, buffer, NPOS, 0);
    assert_true(t_size == 10);
    for(i = 0; i < 20; ++i)
    {
        if(i < t_size)
        {
            assert_true(buffer[i] == 100);
        }
        else
        {
            assert_true(buffer[i] == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[10] = {0};
    size_t t_size = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);

    t_size = basic_string_copy(pt_basic_string, buffer, 0, 5);
    assert_true(t_size == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__middle_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[10] = {0};
    size_t t_size = 0;
    size_t i = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);

    t_size = basic_string_copy(pt_basic_string, buffer, 4, 5);
    assert_true(t_size == 4);
    for(i = 0; i < 10; ++i)
    {
        if(i < t_size)
        {
            assert_true(buffer[i] == 100);
        }
        else
        {
            assert_true(buffer[i] == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__middle_length(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[20] = {0};
    size_t t_size = 0;
    size_t i = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);

    t_size = basic_string_copy(pt_basic_string, buffer, 5, 5);
    assert_true(t_size == 5);
    for(i = 0; i < 20; ++i)
    {
        if(i < t_size)
        {
            assert_true(buffer[i] == 100);
        }
        else
        {
            assert_true(buffer[i] == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__middle_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[20] = {0};
    size_t t_size = 0;
    size_t i = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);

    t_size = basic_string_copy(pt_basic_string, buffer, NPOS, 5);
    assert_true(t_size == 5);
    for(i = 0; i < 20; ++i)
    {
        if(i < t_size)
        {
            assert_true(buffer[i] == 100);
        }
        else
        {
            assert_true(buffer[i] == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__end(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[10];
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_copy(pt_basic_string, buffer, 0, 10));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int buffer[10];
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_copy(pt_basic_string, buffer, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_copy__shared(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pbstr = create_basic_string(int);
    int buffer[20] = {0};
    size_t t_size = 0;
    size_t i = 0;
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_copy(pbstr, pt_basic_string);

    t_size = basic_string_copy(pt_basic_string, buffer, NPOS, 5);
    assert_true(t_size == 5);
    for(i = 0; i < 20; ++i)
    {
        if(i < t_size)
        {
            assert_true(buffer[i] == 100);
        }
        else
        {
            assert_true(buffer[i] == 0);
        }
    }
    assert_true(pbstr->_pby_string == pt_basic_string->_pby_string);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pbstr);
}


/*
 * test basic_string_size
 */
UT_CASE_DEFINATION(basic_string_size)
void test_basic_string_size__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_size(NULL));
}

void test_basic_string_size__non_inited(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_size(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_size__successfully_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_size__successfully_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 45, 10);

    assert_true(basic_string_size(pt_basic_string) == 45);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_length
 */
UT_CASE_DEFINATION(basic_string_length)
void test_basic_string_length__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_length(NULL));
}

void test_basic_string_length__non_inited(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_length(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_length__successfully_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_length(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_length__successfully_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 45, 10);

    assert_true(basic_string_length(pt_basic_string) == 45);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_empty
 */
UT_CASE_DEFINATION(basic_string_empty)
void test_basic_string_empty__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_empty(NULL));
}

void test_basic_string_empty__non_inited(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_empty(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_empty__successfully_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_empty(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_empty__successfully_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 239, 100);
    assert_false(basic_string_empty(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_max_size
 */
UT_CASE_DEFINATION(basic_string_max_size)
void test_basic_string_max_size__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_max_size(NULL));
}

void test_basic_string_max_size__non_created(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    pt_basic_string->_t_typeinfo._t_style = 9999;
    expect_assert_failure(basic_string_max_size(pt_basic_string));
    pt_basic_string->_t_typeinfo._t_style = _TYPE_C_BUILTIN;

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_max_size__successfully(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_max_size(pt_basic_string) ==
        ((NPOS - sizeof(_basic_string_rep_t)) / pt_basic_string->_t_typeinfo._pt_type->_t_typesize) - 1);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_capacity
 */
UT_CASE_DEFINATION(basic_string_capacity)
void test_basic_string_capacity__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_capacity(NULL));
}

void test_basic_string_capacity__non_inited(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    expect_assert_failure(basic_string_capacity(pt_basic_string));
    basic_string_destroy(pt_basic_string);
}

void test_basic_string_capacity__successfully_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_capacity(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_capacity__successfully_little(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 3, 100);
    assert_true(basic_string_capacity(pt_basic_string) == 3);
    /*assert_true(basic_string_capacity(pt_basic_string) == 19);*/

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_capacity__successfully_huge(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 3983, 100);
    assert_true(basic_string_capacity(pt_basic_string) == 3983);
    /*assert_true(basic_string_capacity(pt_basic_string) == 5974);*/

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_at
 */
UT_CASE_DEFINATION(basic_string_at)
void test_basic_string_at__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_at(NULL, 0));
}

void test_basic_string_at__non_inited_basic_string_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_at(pt_basic_string, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_at__invalid_subscript_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_at(pt_basic_string, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_at__invalid_subscript_end(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_at(pt_basic_string, basic_string_size(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_at__invalid_subscript(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_at(pt_basic_string, 132));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_at__c_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pbstr = create_basic_string(int);
    basic_string_init_elem(pbstr, 10, 111);

    for (i = 0; i < basic_string_size(pbstr); ++i) {
        assert_true(*(int*)basic_string_at(pbstr, i) == 111);
    }
    basic_string_destroy(pbstr);
}

void test_basic_string_at__cstl(void** state)
{
    size_t i = 0;
    list_t* plist = create_list(int);
    basic_string_t* pbstr = create_basic_string(list_t<int>);
    list_init_elem(plist, 10, 100);
    basic_string_init_elem(pbstr, 10, plist);

    for (i = 0; i < basic_string_size(pbstr); ++i) {
        assert_true(list_equal((list_t*)basic_string_at(pbstr, i), plist));
    }

    list_destroy(plist);
    basic_string_destroy(pbstr);
}

typedef struct _tag_test_basic_string_at__user_define {int a;}_test_basic_string_at__user_define_t;
void test_basic_string_at__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pbstr = NULL;
    _test_basic_string_at__user_define_t t_elem;

    type_register(_test_basic_string_at__user_define_t, NULL, NULL, NULL, NULL);
    pbstr = create_basic_string(_test_basic_string_at__user_define_t);
    t_elem.a = 100;
    basic_string_init_elem(pbstr, 10, &t_elem);

    for (i = 0; i < 10; ++i) {
        assert_true(memcmp(basic_string_at(pbstr, i), &t_elem, sizeof(_test_basic_string_at__user_define_t)) == 0);
    }

    basic_string_destroy(pbstr);
}

void test_basic_string_at__successfully(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }

    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == i);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_at__successfully_cstr(void** state)
{
    /*
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_init(pt_basic_string);

    basic_string_push_back(pt_basic_string, "abc");
    basic_string_push_back(pt_basic_string, "def");
    basic_string_push_back(pt_basic_string, "hij");

    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "hij") == 0);

    basic_string_destroy(pt_basic_string);
    */
    assert_true(false);
}

void test_basic_string_at__sharable(void** state)
{
    size_t i = 0;
    basic_string_t* pbstr1 = create_basic_string(int);
    basic_string_t* pbstr2 = create_basic_string(int);

    basic_string_init_elem(pbstr1, 10, 111);
    basic_string_init_copy(pbstr2, pbstr1);

    assert(pbstr1->_pby_string == pbstr2->_pby_string);
    assert(*(int*)basic_string_at(pbstr2, 0) == 111);
    assert(pbstr1->_pby_string != pbstr2->_pby_string);
    *(int*)basic_string_at(pbstr1, 0) = -99;
    for (i = 0; i < basic_string_size(pbstr1); ++i) {
        if (i == 0) {
            assert(*(int*)basic_string_at(pbstr1, i) == -99);
        } else {
            assert(*(int*)basic_string_at(pbstr1, i) == 111);
        }
    }
    for (i = 0; i < basic_string_size(pbstr2); ++i) {
        assert(*(int*)basic_string_at(pbstr2, i) == 111);
    }

    basic_string_destroy(pbstr1);
    basic_string_destroy(pbstr2);
}

/*
 * test basic_string_equal
 */
UT_CASE_DEFINATION(basic_string_equal)
void test_basic_string_equal__null_first(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_equal(NULL, pt));

    basic_string_destroy(pt);
}

void test_basic_string_equal__null_second(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_equal(pt, NULL));

    basic_string_destroy(pt);
}

void test_basic_string_equal__non_inited_first(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_second);
    expect_assert_failure(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__non_inited_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    expect_assert_failure(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_false(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__same_basic_string(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    assert_true(basic_string_equal(pt, pt));

    basic_string_destroy(pt);
}

void test_basic_string_equal__size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, 0);
    assert_false(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 233, 0);
    basic_string_init_elem(pt_second, 48, 0);
    assert_false(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 4545);
    assert_false(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 45);
    assert_false(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_equal__shared(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_copy(pt_second, pt_first);
    assert_true(basic_string_equal(pt_first, pt_second));
    assert_true(pt_first->_pby_string == pt_second->_pby_string);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

/*
 * test basic_string_not_equal
 */
UT_CASE_DEFINATION(basic_string_not_equal)
void test_basic_string_not_equal__null_first(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_not_equal(NULL, pt));

    basic_string_destroy(pt);
}

void test_basic_string_not_equal__null_second(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_not_equal(pt, NULL));

    basic_string_destroy(pt);
}

void test_basic_string_not_equal__non_inited_first(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_second);
    pt_first->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_not_equal(pt_first, pt_second));

    pt_first->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_not_equal__non_inited_second(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    pt_second->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_not_equal(pt_first, pt_second));

    pt_second->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_not_equal__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_not_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_not_equal__same_basic_string(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    assert_false(basic_string_not_equal(pt, pt));

    basic_string_destroy(pt);
}

void test_basic_string_not_equal__size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, 0);
    assert_true(basic_string_not_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_not_equal__size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 233, 0);
    basic_string_init_elem(pt_second, 48, 0);
    assert_true(basic_string_not_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_not_equal__size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_false(basic_string_not_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_not_equal__size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 4545);
    assert_true(basic_string_not_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_not_equal__size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 45);
    assert_true(basic_string_not_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_not_equal__size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_false(basic_string_not_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

/*
 * test basic_string_less
 */
UT_CASE_DEFINATION(basic_string_less)
void test_basic_string_less__null_first(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_less(NULL, pt));

    basic_string_destroy(pt);
}

void test_basic_string_less__null_second(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_less(pt, NULL));

    basic_string_destroy(pt);
}

void test_basic_string_less__non_inited_first(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_second);
    pt_first->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_less(pt_first, pt_second));

    pt_first->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_less__non_inited_second(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    pt_second->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_less(pt_first, pt_second));

    pt_second->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_less__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    expect_assert_failure(basic_string_less(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less__same_basic_string(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    assert_false(basic_string_less(pt, pt));

    basic_string_destroy(pt);
}

void test_basic_string_less__size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, 0);
    assert_true(basic_string_less(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less__size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 233, 0);
    basic_string_init_elem(pt_second, 48, 0);
    assert_false(basic_string_less(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less__size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_false(basic_string_less(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less__size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 4545);
    assert_true(basic_string_less(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less__size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 45);
    assert_false(basic_string_less(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less__size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_false(basic_string_less(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

/*
 * test basic_string_less_equal
 */
UT_CASE_DEFINATION(basic_string_less_equal)
void test_basic_string_less_equal__null_first(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_less_equal(NULL, pt));

    basic_string_destroy(pt);
}

void test_basic_string_less_equal__null_second(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_less_equal(pt, NULL));

    basic_string_destroy(pt);
}

void test_basic_string_less_equal__non_inited_first(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_second);
    pt_first->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_less_equal(pt_first, pt_second));

    pt_first->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_less_equal__non_inited_second(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    pt_second->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_less_equal(pt_first, pt_second));

    pt_second->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_less_equal__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    expect_assert_failure(basic_string_less_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less_equal__same_basic_string(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    assert_true(basic_string_less_equal(pt, pt));

    basic_string_destroy(pt);
}

void test_basic_string_less_equal__size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, 0);
    assert_true(basic_string_less_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less_equal__size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 233, 0);
    basic_string_init_elem(pt_second, 48, 0);
    assert_false(basic_string_less_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less_equal__size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_less_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less_equal__size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 4545);
    assert_true(basic_string_less_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less_equal__size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 45);
    assert_false(basic_string_less_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_less_equal__size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_less_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

/*
 * test basic_string_greater
 */
UT_CASE_DEFINATION(basic_string_greater)
void test_basic_string_greater__null_first(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_greater(NULL, pt));

    basic_string_destroy(pt);
}

void test_basic_string_greater__null_second(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_greater(pt, NULL));

    basic_string_destroy(pt);
}

void test_basic_string_greater__non_inited_first(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_second);
    pt_first->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_greater(pt_first, pt_second));

    pt_first->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_greater__non_inited_second(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    pt_second->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_greater(pt_first, pt_second));

    pt_second->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_greater__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    expect_assert_failure(basic_string_greater(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater__same_basic_string(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    assert_false(basic_string_greater(pt, pt));

    basic_string_destroy(pt);
}

void test_basic_string_greater__size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, 0);
    assert_false(basic_string_greater(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater__size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 233, 0);
    basic_string_init_elem(pt_second, 48, 0);
    assert_true(basic_string_greater(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater__size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_false(basic_string_greater(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater__size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 4545);
    assert_false(basic_string_greater(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater__size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 45);
    assert_true(basic_string_greater(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater__size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_false(basic_string_greater(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

/*
 * test basic_string_greater_equal
 */
UT_CASE_DEFINATION(basic_string_greater_equal)
void test_basic_string_greater_equal__null_first(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_greater_equal(NULL, pt));

    basic_string_destroy(pt);
}

void test_basic_string_greater_equal__null_second(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_greater_equal(pt, NULL));

    basic_string_destroy(pt);
}

void test_basic_string_greater_equal__non_inited_first(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_second);
    pt_first->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_greater_equal(pt_first, pt_second));

    pt_first->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_greater_equal__non_inited_second(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    pt_second->_vec_base._pby_finish = (_byte_t*)0x73;
    expect_assert_failure(basic_string_greater_equal(pt_first, pt_second));

    pt_second->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_greater_equal__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    expect_assert_failure(basic_string_greater_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater_equal__same_basic_string(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    assert_true(basic_string_greater_equal(pt, pt));

    basic_string_destroy(pt);
}

void test_basic_string_greater_equal__size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, 0);
    assert_false(basic_string_greater_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater_equal__size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 233, 0);
    basic_string_init_elem(pt_second, 48, 0);
    assert_true(basic_string_greater_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater_equal__size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_greater_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater_equal__size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 4545);
    assert_false(basic_string_greater_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater_equal__size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 45);
    assert_true(basic_string_greater_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_greater_equal__size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_greater_equal(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

/*
 * test basic_string_equal_cstr
 */
UT_CASE_DEFINATION(basic_string_equal_cstr)
void test_basic_string_equal_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_equal_cstr(NULL, elems));
}

void test_basic_string_equal_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_equal_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_equal_cstr(pt_basic_string, elems));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_equal_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__c_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 2, 100);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__c_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__c_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 7, 100);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__c_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__c_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 200);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_equal_cstr(pt_basic_string, ""));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__char_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'a');

    assert_false(basic_string_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__char_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_true(basic_string_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__char_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'a');

    assert_false(basic_string_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__char_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_false(basic_string_equal_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__char_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_false(basic_string_equal_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__cstr_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 3, "abc");

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__cstr_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_true(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__cstr_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 5, "abc");

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__cstr_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__cstr_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ttt");

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__libcstl_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 2, pvec);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_equal_cstr__libcstl_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_equal_cstr__libcstl_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 4, pvec);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_equal_cstr__libcstl_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_equal_cstr__libcstl_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_equal_cstr__user_defined
{
    int n_elem;
}_test_basic_string_equal_cstr__user_defined_t;
void test_basic_string_equal_cstr__user_defined_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_equal_cstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_equal_cstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_equal_cstr__user_defined_t);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__user_defined_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_equal_cstr__user_defined_t);
    _test_basic_string_equal_cstr__user_defined_t t_elem;
    _test_basic_string_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__user_defined_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_equal_cstr__user_defined_t);
    _test_basic_string_equal_cstr__user_defined_t t_elem;
    _test_basic_string_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_true(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__user_defined_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_equal_cstr__user_defined_t);
    _test_basic_string_equal_cstr__user_defined_t t_elem;
    _test_basic_string_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 4, &t_elem);

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__user_defined_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_equal_cstr__user_defined_t);
    _test_basic_string_equal_cstr__user_defined_t t_elem;
    _test_basic_string_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 100;

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_equal_cstr__user_defined_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_equal_cstr__user_defined_t);
    _test_basic_string_equal_cstr__user_defined_t t_elem;
    _test_basic_string_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 0;

    assert_false(basic_string_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_not_equal_cstr
 */
UT_CASE_DEFINATION(basic_string_not_equal_cstr)
void test_basic_string_not_equal_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_not_equal_cstr(NULL, elems));
}

void test_basic_string_not_equal_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_not_equal_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_not_equal_cstr(pt_basic_string, elems));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_not_equal_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__c_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 2, 100);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__c_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_false(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__c_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 7, 100);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__c_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__c_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 200);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init(pt_basic_string);

    assert_false(basic_string_not_equal_cstr(pt_basic_string, ""));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__char_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'a');

    assert_true(basic_string_not_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__char_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_false(basic_string_not_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__char_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'a');

    assert_true(basic_string_not_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__char_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_true(basic_string_not_equal_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__char_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_true(basic_string_not_equal_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__cstr_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 3, "abc");

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__cstr_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_false(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__cstr_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 5, "abc");

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__cstr_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__cstr_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ttt");

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__libcstl_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 2, pvec);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_not_equal_cstr__libcstl_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_not_equal_cstr__libcstl_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 4, pvec);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_not_equal_cstr__libcstl_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_not_equal_cstr__libcstl_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_not_equal_cstr__user_defined
{
    int n_elem;
}_test_basic_string_not_equal_cstr__user_defined_t;
void test_basic_string_not_equal_cstr__user_defined_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_not_equal_cstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_not_equal_cstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_not_equal_cstr__user_defined_t);
    basic_string_init(pt_basic_string);

    assert_false(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__user_defined_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_not_equal_cstr__user_defined_t);
    _test_basic_string_not_equal_cstr__user_defined_t t_elem;
    _test_basic_string_not_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__user_defined_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_not_equal_cstr__user_defined_t);
    _test_basic_string_not_equal_cstr__user_defined_t t_elem;
    _test_basic_string_not_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_false(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__user_defined_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_not_equal_cstr__user_defined_t);
    _test_basic_string_not_equal_cstr__user_defined_t t_elem;
    _test_basic_string_not_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 4, &t_elem);

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__user_defined_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_not_equal_cstr__user_defined_t);
    _test_basic_string_not_equal_cstr__user_defined_t t_elem;
    _test_basic_string_not_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 100;

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_not_equal_cstr__user_defined_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_not_equal_cstr__user_defined_t);
    _test_basic_string_not_equal_cstr__user_defined_t t_elem;
    _test_basic_string_not_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 0;

    assert_true(basic_string_not_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_less_cstr
 */
UT_CASE_DEFINATION(basic_string_less_cstr)
void test_basic_string_less_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_less_cstr(NULL, elems));
}

void test_basic_string_less_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_less_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_less_cstr(pt_basic_string, elems));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_less_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__c_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 2, 100);

    assert_true(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__c_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__c_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 7, 100);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__c_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__c_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 200);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init(pt_basic_string);

    assert_false(basic_string_less_cstr(pt_basic_string, ""));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__char_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'a');

    assert_true(basic_string_less_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__char_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_false(basic_string_less_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__char_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'a');

    assert_false(basic_string_less_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__char_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_true(basic_string_less_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__char_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_false(basic_string_less_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__cstr_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 3, "abc");

    assert_true(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__cstr_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__cstr_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 5, "abc");

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__cstr_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_true(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__cstr_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ttt");

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__libcstl_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 2, pvec);

    assert_true(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_less_cstr__libcstl_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_less_cstr__libcstl_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 4, pvec);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_less_cstr__libcstl_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_less_cstr__libcstl_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_less_cstr__user_defined
{
    int n_elem;
}_test_basic_string_less_cstr__user_defined_t;
void test_basic_string_less_cstr__user_defined_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_less_cstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_less_cstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_less_cstr__user_defined_t);
    basic_string_init(pt_basic_string);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__user_defined_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_cstr__user_defined_t);
    _test_basic_string_less_cstr__user_defined_t t_elem;
    _test_basic_string_less_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_true(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__user_defined_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_cstr__user_defined_t);
    _test_basic_string_less_cstr__user_defined_t t_elem;
    _test_basic_string_less_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__user_defined_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_cstr__user_defined_t);
    _test_basic_string_less_cstr__user_defined_t t_elem;
    _test_basic_string_less_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 4, &t_elem);

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__user_defined_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_cstr__user_defined_t);
    _test_basic_string_less_cstr__user_defined_t t_elem;
    _test_basic_string_less_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 100;

    assert_true(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_cstr__user_defined_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_cstr__user_defined_t);
    _test_basic_string_less_cstr__user_defined_t t_elem;
    _test_basic_string_less_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 0;

    assert_false(basic_string_less_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_less_equal_cstr
 */
UT_CASE_DEFINATION(basic_string_less_equal_cstr)
void test_basic_string_less_equal_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_less_equal_cstr(NULL, elems));
}

void test_basic_string_less_equal_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_less_equal_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_less_equal_cstr(pt_basic_string, elems));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_less_equal_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__c_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 2, 100);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__c_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__c_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 7, 100);

    assert_false(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__c_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__c_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 200);

    assert_false(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, ""));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__char_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'a');

    assert_true(basic_string_less_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__char_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_true(basic_string_less_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__char_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'a');

    assert_false(basic_string_less_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__char_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_true(basic_string_less_equal_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__char_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_false(basic_string_less_equal_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__cstr_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 3, "abc");

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__cstr_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__cstr_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 5, "abc");

    assert_false(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__cstr_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__cstr_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ttt");

    assert_false(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__libcstl_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 2, pvec);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_less_equal_cstr__libcstl_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_less_equal_cstr__libcstl_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 4, pvec);

    assert_false(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_less_equal_cstr__libcstl_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_less_equal_cstr__libcstl_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_less_equal_cstr__user_defined
{
    int n_elem;
}_test_basic_string_less_equal_cstr__user_defined_t;
void test_basic_string_less_equal_cstr__user_defined_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_less_equal_cstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_less_equal_cstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_less_equal_cstr__user_defined_t);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__user_defined_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_equal_cstr__user_defined_t);
    _test_basic_string_less_equal_cstr__user_defined_t t_elem;
    _test_basic_string_less_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__user_defined_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_equal_cstr__user_defined_t);
    _test_basic_string_less_equal_cstr__user_defined_t t_elem;
    _test_basic_string_less_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__user_defined_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_equal_cstr__user_defined_t);
    _test_basic_string_less_equal_cstr__user_defined_t t_elem;
    _test_basic_string_less_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 4, &t_elem);

    assert_false(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__user_defined_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_equal_cstr__user_defined_t);
    _test_basic_string_less_equal_cstr__user_defined_t t_elem;
    _test_basic_string_less_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 100;

    assert_true(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_less_equal_cstr__user_defined_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_less_equal_cstr__user_defined_t);
    _test_basic_string_less_equal_cstr__user_defined_t t_elem;
    _test_basic_string_less_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 0;

    assert_false(basic_string_less_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_greater_cstr
 */
UT_CASE_DEFINATION(basic_string_greater_cstr)
void test_basic_string_greater_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_greater_cstr(NULL, elems));
}

void test_basic_string_greater_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_greater_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_greater_cstr(pt_basic_string, elems));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_greater_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__c_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 2, 100);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__c_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__c_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 7, 100);

    assert_true(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__c_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__c_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 200);

    assert_true(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init(pt_basic_string);

    assert_false(basic_string_greater_cstr(pt_basic_string, ""));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__char_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'a');

    assert_false(basic_string_greater_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__char_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_false(basic_string_greater_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__char_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'a');

    assert_true(basic_string_greater_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__char_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_false(basic_string_greater_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__char_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_true(basic_string_greater_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__cstr_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 3, "abc");

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__cstr_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__cstr_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 5, "abc");

    assert_true(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__cstr_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__cstr_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ttt");

    assert_true(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__libcstl_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 2, pvec);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_greater_cstr__libcstl_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_greater_cstr__libcstl_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 4, pvec);

    assert_true(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_greater_cstr__libcstl_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_greater_cstr__libcstl_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_greater_cstr__user_defined
{
    int n_elem;
}_test_basic_string_greater_cstr__user_defined_t;
void test_basic_string_greater_cstr__user_defined_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_greater_cstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_greater_cstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_greater_cstr__user_defined_t);
    basic_string_init(pt_basic_string);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__user_defined_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_cstr__user_defined_t);
    _test_basic_string_greater_cstr__user_defined_t t_elem;
    _test_basic_string_greater_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__user_defined_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_cstr__user_defined_t);
    _test_basic_string_greater_cstr__user_defined_t t_elem;
    _test_basic_string_greater_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__user_defined_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_cstr__user_defined_t);
    _test_basic_string_greater_cstr__user_defined_t t_elem;
    _test_basic_string_greater_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 4, &t_elem);

    assert_true(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__user_defined_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_cstr__user_defined_t);
    _test_basic_string_greater_cstr__user_defined_t t_elem;
    _test_basic_string_greater_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 100;

    assert_false(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_cstr__user_defined_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_cstr__user_defined_t);
    _test_basic_string_greater_cstr__user_defined_t t_elem;
    _test_basic_string_greater_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 0;

    assert_true(basic_string_greater_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_greater_equal_cstr
 */
UT_CASE_DEFINATION(basic_string_greater_equal_cstr)
void test_basic_string_greater_equal_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_greater_equal_cstr(NULL, elems));
}

void test_basic_string_greater_equal_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_greater_equal_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_greater_equal_cstr(pt_basic_string, elems));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_greater_equal_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__c_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 2, 100);

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__c_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__c_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 7, 100);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__c_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__c_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 200);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, ""));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__char_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'a');

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__char_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__char_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'a');

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, "aaaaa"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__char_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__char_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, "bbbbb"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__cstr_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 3, "abc");

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__cstr_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__cstr_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 5, "abc");

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__cstr_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__cstr_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ttt");

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__libcstl_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 2, pvec);

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_greater_equal_cstr__libcstl_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_greater_equal_cstr__libcstl_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 4, pvec);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_greater_equal_cstr__libcstl_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_greater_equal_cstr__libcstl_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_greater_equal_cstr__user_defined
{
    int n_elem;
}_test_basic_string_greater_equal_cstr__user_defined_t;
void test_basic_string_greater_equal_cstr__user_defined_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_greater_equal_cstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_greater_equal_cstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_greater_equal_cstr__user_defined_t);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__user_defined_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_equal_cstr__user_defined_t);
    _test_basic_string_greater_equal_cstr__user_defined_t t_elem;
    _test_basic_string_greater_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__user_defined_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_equal_cstr__user_defined_t);
    _test_basic_string_greater_equal_cstr__user_defined_t t_elem;
    _test_basic_string_greater_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__user_defined_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_equal_cstr__user_defined_t);
    _test_basic_string_greater_equal_cstr__user_defined_t t_elem;
    _test_basic_string_greater_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 4, &t_elem);

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__user_defined_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_equal_cstr__user_defined_t);
    _test_basic_string_greater_equal_cstr__user_defined_t t_elem;
    _test_basic_string_greater_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 100;

    assert_false(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_greater_equal_cstr__user_defined_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_greater_equal_cstr__user_defined_t);
    _test_basic_string_greater_equal_cstr__user_defined_t t_elem;
    _test_basic_string_greater_equal_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 0;

    assert_true(basic_string_greater_equal_cstr(pt_basic_string, elems));

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_compare
 */
UT_CASE_DEFINATION(basic_string_compare)
void test_basic_string_compare__null_first(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_compare(NULL, pt));

    basic_string_destroy(pt);
}

void test_basic_string_compare__null_second(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    expect_assert_failure(basic_string_compare(pt, NULL));

    basic_string_destroy(pt);
}

void test_basic_string_compare__non_inited_first(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_second);
    expect_assert_failure(basic_string_compare(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__non_inited_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    expect_assert_failure(basic_string_compare(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    expect_assert_failure(basic_string_compare(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__same_basic_string(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_init(pt);

    assert_true(basic_string_compare(pt, pt) == 0);

    basic_string_destroy(pt);
}

void test_basic_string_compare__c_builtin_size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, 0);
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__c_builtin_size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 233, 0);
    basic_string_init_elem(pt_second, 48, 0);
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__c_builtin_size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__c_builtin_size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 4545);
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__c_builtin_size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 45);
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__c_builtin_size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__char_size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, 'a');
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__char_size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 233, 'a');
    basic_string_init_elem(pt_second, 48, 'a');
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__char_size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__char_size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 10, 'c');
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__char_size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'g');
    basic_string_init_elem(pt_second, 10, 'c');
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__char_size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'x');
    basic_string_init_elem(pt_second, 10, 'x');
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__cstr_size_first_less_than_second(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, "abc");
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare__cstr_size_first_greater_than_second(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 233, "abc");
    basic_string_init_elem(pt_second, 48, "abc");
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare__cstr_size_equal_0(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare__cstr_size_equal_elem_first_less_than_second(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "abc");
    basic_string_init_elem(pt_second, 10, "xyz");
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare__cstr_size_equal_elem_first_greater_than_second(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "dde");
    basic_string_init_elem(pt_second, 10, "abc");
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare__cstr_size_equal_elem_equal(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "xxx");
    basic_string_init_elem(pt_second, 10, "xxx");
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare__libcstl_builtin_size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, pvec);
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare__libcstl_builtin_size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 233, pvec);
    basic_string_init_elem(pt_second, 48, pvec);
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare__libcstl_builtin_size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__libcstl_builtin_size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_push_back(pvec, 100);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare__libcstl_builtin_size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 10, 1111);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare__libcstl_builtin_size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_n(pvec, 10);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_compare__user_defined
{
    int n_elem;
}_test_basic_string_compare__user_define_t;
void test_basic_string_compare__user_define_size_first_less_than_second(void** state)
{
    basic_string_t* pt_first = NULL;
    basic_string_t* pt_second = NULL;
    _test_basic_string_compare__user_define_t t_elem;

    type_register(_test_basic_string_compare__user_define_t, NULL, NULL, NULL, NULL);
    pt_first = create_basic_string(_test_basic_string_compare__user_define_t);
    pt_second = create_basic_string(_test_basic_string_compare__user_define_t);

    t_elem.n_elem = 0;
    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 48, &t_elem);
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__user_define_size_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare__user_define_t);
    _test_basic_string_compare__user_define_t t_elem;

    t_elem.n_elem = 9;
    basic_string_init_elem(pt_first, 233, &t_elem);
    basic_string_init_elem(pt_second, 48, &t_elem);
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__user_define_size_equal_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare__user_define_t);

    basic_string_init(pt_first);
    basic_string_init(pt_second);
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__user_define_size_equal_elem_first_less_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare__user_define_t);
    _test_basic_string_compare__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 1000;
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare(pt_first, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__user_define_size_equal_elem_first_greater_than_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare__user_define_t);
    _test_basic_string_compare__user_define_t t_elem;

    t_elem.n_elem = 1111;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare(pt_first, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__user_define_size_equal_elem_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare__user_define_t);
    _test_basic_string_compare__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare(pt_first, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare__shared(void** state)
{
    basic_string_t* pbstr1 = create_basic_string(int);
    basic_string_t* pbstr2 = create_basic_string(int);
    basic_string_init_elem(pbstr1, 10, 111);
    basic_string_init_copy(pbstr2, pbstr1);

    assert_true(basic_string_compare(pbstr1, pbstr2) == 0);
    assert_true(pbstr1->_pby_string == pbstr2->_pby_string);

    basic_string_destroy(pbstr1);
    basic_string_destroy(pbstr2);
}

/*
 * test basic_string_compare_substring_string
 */
UT_CASE_DEFINATION(basic_string_compare_substring_string)
void test_basic_string_compare_substring_string__null_first(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_compare_substring_string(NULL, 0, NPOS, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_string__null_second(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_compare_substring_string(pt_basic_string, 0, NPOS, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_string__non_inited_first(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_second, 10, 100);
    expect_assert_failure(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__non_inited_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    expect_assert_failure(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__invalid_pos(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    expect_assert_failure(basic_string_compare_substring_string(pt_first, 100, NPOS, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100.0);
    expect_assert_failure(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_sub_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_sub_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 3, 500);
    assert_true(basic_string_compare_substring_string(pt_first, 4, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_sub_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 3, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 7, 3, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_sub_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 3, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 5, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_sub_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 500);
    basic_string_init_elem(pt_second, 3, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 7, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_all_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 30, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_all_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 300);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_all_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_all_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 20, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_all_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 200);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_empty_non_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 200);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_non_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 200);
    basic_string_init_elem(pt_second, 0, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__c_builtin_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 200);
    basic_string_init_elem(pt_second, 0, 100);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_sub_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 0, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_sub_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 3, 'c');
    assert_true(basic_string_compare_substring_string(pt_first, 4, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_sub_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 3, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 7, 3, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_sub_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 3, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 5, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_sub_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'd');
    basic_string_init_elem(pt_second, 3, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 7, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_all_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 30, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_all_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 10, 'd');
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_all_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_all_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 20, 'a');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_all_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'e');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_empty_non_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'b');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_non_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'b');
    basic_string_init_elem(pt_second, 0, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__char_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'b');
    basic_string_init_elem(pt_second, 0, 'a');
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__cstr_sub_size_less(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 0, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_sub_content_less(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 3, "ccc");
    assert_true(basic_string_compare_substring_string(pt_first, 4, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_sub_equal(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 3, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 7, 3, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_sub_size_greater(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 3, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 5, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_sub_content_greater(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "ddd");
    basic_string_init_elem(pt_second, 3, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 7, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_all_size_less(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 30, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_all_content_less(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 10, "ddd");
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_all_equal(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_all_size_greater(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 20, "aaa");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_all_content_greater(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "eee");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_empty_non_empty(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "bbb");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_non_empty_empty(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "bbb");
    basic_string_init_elem(pt_second, 0, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__cstr_empty_empty(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "bbb");
    basic_string_init_elem(pt_second, 0, "aaa");
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_string__libcstl_builtin_sub_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_sub_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_push_back(pvec, 100);
    basic_string_init_elem(pt_second, 3, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 4, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_sub_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 3, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 7, 3, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_sub_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 3, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 5, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_sub_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 12, 99);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 3, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 7, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_all_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 30, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_all_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_push_back(pvec, 2);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_all_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_all_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 20, pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_all_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 2, 4);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_empty_non_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 2, 4);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_non_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 2, 4);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 0, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_string__libcstl_builtin_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 2, 4);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 0, pvec);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_compare_substring_string__user_define
{
    int n_elem;
}_test_basic_string_compare_substring_string__user_define_t;
void test_basic_string_compare_substring_string__user_define_sub_size_less(void** state)
{
    basic_string_t* pt_first = NULL;
    basic_string_t* pt_second = NULL;
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    type_register(_test_basic_string_compare_substring_string__user_define_t, NULL, NULL, NULL, NULL);
    pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    t_elem.n_elem = 5555;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_sub_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 100;
    basic_string_init_elem(pt_second, 3, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 4, 3, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_sub_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 4;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 3, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 7, 3, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_sub_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 3, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 5, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_sub_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 99;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 3, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 7, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_all_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 30, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_all_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 2;
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_all_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 9;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_all_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 20, &t_elem);
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_all_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 5;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_empty_non_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 5;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_non_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 5;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 0, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, NPOS, pt_second) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__user_define_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_string__user_define_t);
    _test_basic_string_compare_substring_string__user_define_t t_elem;

    t_elem.n_elem = 5;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 0, &t_elem);
    assert_true(basic_string_compare_substring_string(pt_first, 0, 0, pt_second) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_string__shared(void** state)
{
    basic_string_t* pbstr1 = create_basic_string(int);
    basic_string_t* pbstr2 = create_basic_string(int);
    basic_string_init_elem(pbstr1, 10, 100);
    basic_string_init_copy(pbstr2, pbstr1);

    assert_true(basic_string_compare_substring_string(pbstr1, 0, NPOS, pbstr2) == 0);
    assert_true(pbstr1->_pby_string == pbstr2->_pby_string);

    basic_string_destroy(pbstr1);
    basic_string_destroy(pbstr2);
}

/*
 * test basic_string_compare_substring_substring
 */
UT_CASE_DEFINATION(basic_string_compare_substring_substring)
void test_basic_string_compare_substring_substring__null_first(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 0, 100);
    expect_assert_failure(basic_string_compare_substring_substring(NULL, 0, NPOS, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_substring__null_second(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_compare_substring_substring(pt_basic_string, 0, NPOS, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_substring__non_inited_first(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_second, 10, 100);
    expect_assert_failure(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__non_inited_second(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    expect_assert_failure(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__invalid_first_pos(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    expect_assert_failure(basic_string_compare_substring_substring(pt_first, 100, NPOS, pt_second, 0, NPOS));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__invalid_second_pos(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    expect_assert_failure(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 100, NPOS));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100.0);
    expect_assert_failure(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_sub_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 3, pt_second, 0, 4) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_sub_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 500);
    assert_true(basic_string_compare_substring_substring(pt_first, 4, 3, pt_second, 2, 3) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_sub_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 7, 3, pt_second, 0, 3) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_sub_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 5, NPOS, pt_second, 7, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_sub_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 500);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 7, NPOS, pt_second, 3, 3) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_all_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 30, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_all_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 300);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_all_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_all_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 20, 100);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_all_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 200);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_empty_non_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 200);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_non_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 200);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, 0) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__c_builtin_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init_elem(pt_first, 10, 200);
    basic_string_init_elem(pt_second, 10, 100);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 0, 0) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_sub_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 3, pt_second, 3, 4444) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_sub_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 3, 'c');
    assert_true(basic_string_compare_substring_substring(pt_first, 4, 3, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_sub_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 13, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 7, 3, pt_second, 3, 3) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_sub_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 13, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 5, NPOS, pt_second, 2, 4) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_sub_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'd');
    basic_string_init_elem(pt_second, 3, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 7, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_all_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 30, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_all_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 10, 'd');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_all_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'a');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_all_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 20, 'a');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_all_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'e');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_empty_non_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'b');
    basic_string_init_elem(pt_second, 10, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_non_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'b');
    basic_string_init_elem(pt_second, 5, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__char_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(char);
    basic_string_t* pt_second = create_basic_string(char);

    basic_string_init_elem(pt_first, 10, 'b');
    basic_string_init_elem(pt_second, 3, 'a');
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 0, 0) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__cstr_sub_size_less(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 3, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_sub_content_less(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 3, "ccc");
    assert_true(basic_string_compare_substring_substring(pt_first, 4, 3, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_sub_equal(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 3, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 7, 3, pt_second, 0, NPOS) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_sub_size_greater(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 3, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 5, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_sub_content_greater(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "ddd");
    basic_string_init_elem(pt_second, 3, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 7, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_all_size_less(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 30, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_all_content_less(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 10, "ddd");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_all_equal(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "aaa");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_all_size_greater(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 20, "aaa");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_all_content_greater(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "eee");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_empty_non_empty(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "bbb");
    basic_string_init_elem(pt_second, 10, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_non_empty_empty(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "bbb");
    basic_string_init_elem(pt_second, 100, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__cstr_empty_empty(void** state)
{
    /*
    basic_string_t* pt_first = create_basic_string(char*);
    basic_string_t* pt_second = create_basic_string(char*);

    basic_string_init_elem(pt_first, 10, "bbb");
    basic_string_init_elem(pt_second, 100, "aaa");
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 0, 0) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
    assert_true(false);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_sub_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 3, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_sub_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_push_back(pvec, 100);
    basic_string_init_elem(pt_second, 3, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 4, 3, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_sub_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 3, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 7, 3, pt_second, 0, NPOS) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_sub_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 3, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 5, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_sub_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 12, 99);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 3, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 7, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_all_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 30, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_all_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_push_back(pvec, 2);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_all_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 10, pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_all_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_first, 20, pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_all_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 2, 4);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_empty_non_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 2, 4);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 10, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_non_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 2, 4);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 20, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_substring__libcstl_builtin_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(vector_t<int>);
    basic_string_t* pt_second = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init_elem(pvec, 2, 4);
    basic_string_init_elem(pt_first, 10, pvec);
    vector_clear(pvec);
    basic_string_init_elem(pt_second, 4, pvec);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 3, 0) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_compare_substring_substring__user_define
{
    int n_elem;
}_test_basic_string_compare_substring_substring__user_define_t;
void test_basic_string_compare_substring_substring__user_define_sub_size_less(void** state)
{
    basic_string_t* pt_first = NULL;
    basic_string_t* pt_second = NULL;
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    type_register(_test_basic_string_compare_substring_substring__user_define_t, NULL, NULL, NULL, NULL);
    pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    t_elem.n_elem = 5555;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 3, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_sub_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 100;
    basic_string_init_elem(pt_second, 3, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 4, 3, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_sub_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 4;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 3, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 7, 3, pt_second, 0, NPOS) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_sub_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 3, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 5, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_sub_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 99;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 3, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 7, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_all_size_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 30, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_all_content_less(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 2;
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_all_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 9;
    basic_string_init_elem(pt_first, 10, &t_elem);
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_all_size_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_first, 20, &t_elem);
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_all_content_greater(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 5;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, NPOS) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_empty_non_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 5;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 10, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 0, NPOS) < 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_non_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 5;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 5, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, NPOS, pt_second, 0, 0) > 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__user_define_empty_empty(void** state)
{
    basic_string_t* pt_first = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    basic_string_t* pt_second = create_basic_string(_test_basic_string_compare_substring_substring__user_define_t);
    _test_basic_string_compare_substring_substring__user_define_t t_elem;

    t_elem.n_elem = 5;
    basic_string_init_elem(pt_first, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_second, 5, &t_elem);
    assert_true(basic_string_compare_substring_substring(pt_first, 0, 0, pt_second, 3, 0) == 0);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_compare_substring_substring__shared(void** state)
{
    basic_string_t* pbstr1 = create_basic_string(int);
    basic_string_t* pbstr2 = create_basic_string(int);
    basic_string_init_elem(pbstr1, 10, 100);
    basic_string_init_copy(pbstr2, pbstr1);

    assert_true(basic_string_compare_substring_substring(pbstr1, 0, NPOS, pbstr2, 0, NPOS) == 0);
    assert_true(pbstr1->_pby_string == pbstr2->_pby_string);

    basic_string_destroy(pbstr1);
    basic_string_destroy(pbstr2);
}

/*
 * test basic_string_compare_cstr
 */
UT_CASE_DEFINATION(basic_string_compare_cstr)
void test_basic_string_compare_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_compare_cstr(NULL, elems));
}

void test_basic_string_compare_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_compare_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_compare_cstr(pt_basic_string, elems));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_compare_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__c_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 2, 100);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__c_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__c_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 7, 100);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__c_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__c_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {111, 111, 111, 111, 0};
    basic_string_init_elem(pt_basic_string, 4, 200);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_compare_cstr(pt_basic_string, "") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__char_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'a');

    assert_true(basic_string_compare_cstr(pt_basic_string, "aaaaa") < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__char_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_true(basic_string_compare_cstr(pt_basic_string, "aaaaa") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__char_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'a');

    assert_true(basic_string_compare_cstr(pt_basic_string, "aaaaa") > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__char_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'a');

    assert_true(basic_string_compare_cstr(pt_basic_string, "bbbbb") < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__char_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_true(basic_string_compare_cstr(pt_basic_string, "bbbbb") > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__cstr_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 3, "abc");

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__cstr_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__cstr_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 5, "abc");

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__cstr_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__cstr_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ttt");

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};
    basic_string_init(pt_basic_string);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__libcstl_builtin_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 2, pvec);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_cstr__libcstl_builtin_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_cstr__libcstl_builtin_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 4, pvec);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_cstr__libcstl_builtin_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_compare_cstr__libcstl_builtin_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_compare_cstr__user_defined
{
    int n_elem;
}_test_basic_string_compare_cstr__user_defined_t;
void test_basic_string_compare_cstr__user_defined_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_compare_cstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_compare_cstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_compare_cstr__user_defined_t);
    basic_string_init(pt_basic_string);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__user_defined_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_cstr__user_defined_t);
    _test_basic_string_compare_cstr__user_defined_t t_elem;
    _test_basic_string_compare_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__user_defined_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_cstr__user_defined_t);
    _test_basic_string_compare_cstr__user_defined_t t_elem;
    _test_basic_string_compare_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__user_defined_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_cstr__user_defined_t);
    _test_basic_string_compare_cstr__user_defined_t t_elem;
    _test_basic_string_compare_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 4, &t_elem);

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__user_defined_size_equal_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_cstr__user_defined_t);
    _test_basic_string_compare_cstr__user_defined_t t_elem;
    _test_basic_string_compare_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 100;

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_cstr__user_defined_size_equal_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_cstr__user_defined_t);
    _test_basic_string_compare_cstr__user_defined_t t_elem;
    _test_basic_string_compare_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 0;

    assert_true(basic_string_compare_cstr(pt_basic_string, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_compare_substring_cstr
 */
UT_CASE_DEFINATION(basic_string_compare_substring_cstr)
void test_basic_string_compare_substring_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_compare_substring_cstr(NULL, 0, NPOS, elems));
}

void test_basic_string_compare_substring_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_compare_substring_cstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_compare_substring_cstr(pt_basic_string, 30, NPOS, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 0, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 0, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);


    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 2, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 10);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 4, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 3, 4, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 2, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 150);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 2, 4, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 1, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 10);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__c_builtin_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {11, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 5, 0, "") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 5, 2, "") > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 5, 0, "bcd") < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 13, 'a');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 1, 3, "aaaaa") < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 13, 'a');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 1, 5, "bbbbb") < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 15, 'a');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 5, "aaaaa") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 16, 'a');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, NPOS, "aaaaa") > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'c');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 5, NPOS, "aaaaa") > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'b');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, "bbbbb") < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'b');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, "ttttt") < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, "ccccc") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'c');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, "ccccc") > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__char_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, "aaaaa") > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 0, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 3, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 0, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 3, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "aaa");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 4, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 4, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 3, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "uuu");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 3, 4, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 2, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 14, "abc");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__cstr_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ggg");

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 0, elems) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 3, elems) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 0, elems) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 2, elems) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 13, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 3, elems) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 13, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 5, 3, elems) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 14, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 6, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 500);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 13, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 3, elems) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 1, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_cstr__libcstl_builtin_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_compare_substring_cstr__user_defined
{
    int n_elem;
}_test_basic_string_compare_substring_cstr__user_defined_t;
void test_basic_string_compare_substring_cstr__user_defined_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_compare_substring_cstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 12, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 3, 0, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {NULL};

    pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 12, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 3, 3, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 12, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 3, 0, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 12, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 3, 1, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);
    t_elem.n_elem = 100;

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 3, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 2, 3, elems) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 14, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 199, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 11111;;
    basic_string_init_elem(pt_basic_string, 14, &t_elem);
    t_elem.n_elem = 0;

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 4, 3, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 11, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 199;

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, 11, elems) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) == 0);

    basic_string_destroy(pt_basic_string);
}


void test_basic_string_compare_substring_cstr__user_defined_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 6, &t_elem);

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_cstr__user_defined_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_cstr__user_defined_t);
    _test_basic_string_compare_substring_cstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_cstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 4;

    assert_true(basic_string_compare_substring_cstr(pt_basic_string, 0, NPOS, elems) > 0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_compare_substring_subcstr
 */
UT_CASE_DEFINATION(basic_string_compare_substring_subcstr)
void test_basic_string_compare_substring_subcstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_compare_substring_subcstr(NULL, 0, NPOS, elems, NPOS));
}

void test_basic_string_compare_substring_subcstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, NULL, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x3454;
    expect_assert_failure(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS));

    pt_basic_string->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_compare_substring_subcstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_compare_substring_subcstr(pt_basic_string, 30, NPOS, elems, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 0, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 0, elems, 109) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 2, elems, 3) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 10);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 2, elems, 2) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 3, 4, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 2, NPOS, elems, 1111) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 150);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 2, 4, elems, 4) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 1, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, 3) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 10);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, 4) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {100, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__c_builtin_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {11, 100, 100, 100, 0};
    basic_string_init_elem(pt_basic_string, 4, 100);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, 2) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 5, 0, "aaaaaaa", 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 5, 2, "", 3434) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 5, 0, "bcd", NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 13, 'a');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 1, 3, "aaaaa", NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 13, 'a');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 1, 5, "bbbbb", 3) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 15, 'a');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 5, "aaaaa", NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 16, 'a');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, NPOS, "aaaaa", NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'c');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 5, NPOS, "aaaaa", 1) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 3, 'b');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, "bbbbb", 22222) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'b');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, "ttttt", 4) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, "ccccc", NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 6, 'c');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, "ccccc", 5) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__char_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 5, 'c');

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, "aaaaa", 2) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 0, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 3, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 0, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 3, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "aaa");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 4, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 4, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 3, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 10, "uuu");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 3, 4, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 2, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "aaa");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 14, "abc");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__cstr_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    basic_string_init_elem(pt_basic_string, 4, "ggg");

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 0, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 3, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 0, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 2, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 13, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 3, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 13, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 5, 3, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 14, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 6, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 500);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 13, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 3, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 1, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init(pvec);
    vector_init_elem(pvec_elem, 10, 100);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_compare_substring_subcstr__libcstl_builtin_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem = create_vector(int);
    vector_t* elems[] = {pvec_elem, pvec_elem, pvec_elem, NULL};
    vector_init_elem(pvec, 10, 100);
    vector_init(pvec_elem);
    basic_string_init_elem(pt_basic_string, 3, pvec);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem);
}

typedef struct _tagtest_basic_string_compare_substring_subcstr__user_defined
{
    int n_elem;
}_test_basic_string_compare_substring_subcstr__user_defined_t;
void test_basic_string_compare_substring_subcstr__user_defined_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {NULL};

    type_register(_test_basic_string_compare_substring_subcstr__user_defined_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 12, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 3, 0, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {NULL};

    pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 12, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 3, 3, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 12, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 3, 0, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_sub_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 12, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 3, 1, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_sub_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);
    t_elem.n_elem = 100;

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 3, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_sub_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 2, 3, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_sub_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 14, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 199, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_sub_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 11111;;
    basic_string_init_elem(pt_basic_string, 14, &t_elem);
    t_elem.n_elem = 0;

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 4, 3, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_all_size_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 2, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 11, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_all_content_less(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 199;

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, 11, elems, NPOS) < 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_all_equal(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}


void test_basic_string_compare_substring_subcstr__user_defined_all_size_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 6, &t_elem);

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_compare_substring_subcstr__user_defined_all_content_greater(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_compare_substring_subcstr__user_defined_t);
    _test_basic_string_compare_substring_subcstr__user_defined_t t_elem;
    _test_basic_string_compare_substring_subcstr__user_defined_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 3, &t_elem);
    t_elem.n_elem = 4;

    assert_true(basic_string_compare_substring_subcstr(pt_basic_string, 0, NPOS, elems, NPOS) > 0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_substr
 */
UT_CASE_DEFINATION(basic_string_substr)
void test_basic_string_substr__null_basic_string(void** state)
{
    expect_assert_failure(basic_string_substr(NULL, 0, NPOS));
}

void test_basic_string_substr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x899;
    expect_assert_failure(basic_string_substr(pt_basic_string, 0, NPOS));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_substr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_substr(pt_basic_string, 100, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_substr__empty_substr(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_substr = NULL;

    basic_string_init_elem(pt_basic_string, 10, 100);
    pt_substr = basic_string_substr(pt_basic_string, 0, 0);
    assert_true(pt_substr != NULL);
    assert_true(_basic_string_same_type(pt_basic_string, pt_substr));
    assert_true(basic_string_empty(pt_substr));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_substr);
}

void test_basic_string_substr__all(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_substr = NULL;

    basic_string_init_elem(pt_basic_string, 10, 100);
    pt_substr = basic_string_substr(pt_basic_string, 0, NPOS);
    assert_true(basic_string_equal(pt_basic_string, pt_substr));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_substr);
}

void test_basic_string_substr__c_builtin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_substr = NULL;

    basic_string_init_elem(pt_basic_string, 10, 100);
    pt_substr = basic_string_substr(pt_basic_string, 5, 3);
    assert_true(pt_substr != NULL);
    assert_true(_basic_string_same_type(pt_basic_string, pt_substr));
    assert_true(basic_string_size(pt_substr) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_substr);
}

void test_basic_string_substr__char(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_substr = NULL;

    basic_string_init_cstr(pt_basic_string, "abcdefgh");
    pt_substr = basic_string_substr(pt_basic_string, 5, 100);
    assert_true(pt_substr != NULL);
    assert_true(_basic_string_same_type(pt_basic_string, pt_substr));
    assert_true(basic_string_size(pt_substr) == 3);
    assert_true(*(char*)basic_string_at(pt_substr, 0) == 'f');
    assert_true(*(char*)basic_string_at(pt_substr, 1) == 'g');
    assert_true(*(char*)basic_string_at(pt_substr, 2) == 'h');

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_substr);
}

void test_basic_string_substr__cstr(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_substr = NULL;

    basic_string_init_elem(pt_basic_string, 5, "abcdefgh");
    pt_substr = basic_string_substr(pt_basic_string, 3, NPOS);
    assert_true(pt_substr != NULL);
    assert_true(_basic_string_same_type(pt_basic_string, pt_substr));
    assert_true(basic_string_size(pt_substr) == 2);
    assert_true(strcmp(basic_string_at(pt_basic_string, 0), "abcdefgh") == 0);
    assert_true(strcmp(basic_string_at(pt_basic_string, 1), "abcdefgh") == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_substr);
}

void test_basic_string_substr__libcstl(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_substr = NULL;
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    vector_init(pvec);
    basic_string_push_back(pt_basic_string, pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_basic_string, pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_basic_string, pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_basic_string, pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_basic_string, pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_basic_string, pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_basic_string, pvec);
    vector_destroy(pvec);
    pvec = NULL;
    pt_substr = basic_string_substr(pt_basic_string, 3, NPOS);
    assert_true(pt_substr != NULL);
    assert_true(_basic_string_same_type(pt_basic_string, pt_substr));
    assert_true(basic_string_size(pt_substr) == 4);
    for(i = 0; i < basic_string_size(pt_substr); ++i)
    {
        pvec = basic_string_at(pt_substr, i);
        assert_true(pvec != NULL);
        assert_true(vector_size(pvec) == 3 + i);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_substr);
}

typedef struct _tag_test_basic_string_substr__user_define
{
    int n_elem;
}_test_basic_string_substr__user_define_t;
void test_basic_string_substr__user_define(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_substr = NULL;
    _test_basic_string_substr__user_define_t t_elem;
    _test_basic_string_substr__user_define_t* p_elem = NULL;
    size_t i = 0;

    type_register(_test_basic_string_substr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_substr__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    pt_substr = basic_string_substr(pt_basic_string, 3, 3);
    assert_true(pt_substr != NULL);
    assert_true(_basic_string_same_type(pt_basic_string, pt_substr));
    assert_true(basic_string_size(pt_substr) == 3);
    for(i = 0; i < basic_string_size(pt_substr); ++i)
    {
        p_elem = basic_string_at(pt_substr, i);
        assert_true(p_elem != NULL);
        assert_true(p_elem->n_elem == i + 3);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_substr);
}

/*
 * test basic_string_connect
 */
UT_CASE_DEFINATION(basic_string_connect)
void test_basic_string_connect__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_connect(NULL, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect__null_src(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_connect(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_src);
    pt_dest->_vec_base._pby_finish = (_byte_t*)0x888;
    expect_assert_failure(basic_string_connect(pt_dest, pt_src));
    pt_dest->_vec_base._pby_finish = NULL;

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_connect__non_inited_src(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    pt_src->_vec_base._pby_finish = (_byte_t*)0x888;
    expect_assert_failure(basic_string_connect(pt_dest, pt_src));
    pt_src->_vec_base._pby_finish = NULL;

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_connect__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    expect_assert_failure(basic_string_connect(pt_dest, pt_src));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_connect__empty_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_connect(pt_dest, pt_src);
    assert_true(basic_string_empty(pt_dest));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_connect__non_empty_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 10, 100);
    basic_string_init(pt_src);
    basic_string_connect(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 10);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_connect__empty_non_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_src, 10, 100);
    basic_string_init(pt_dest);
    basic_string_connect(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 10);
    assert_true(basic_string_equal(pt_dest, pt_src));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_connect__same(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }

    basic_string_connect(pt_basic_string, pt_basic_string);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == i % 10);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect__c_builtin(void** state)
{
    basic_string_t* pt_dest = create_basic_string(double);
    basic_string_t* pt_src = create_basic_string(double);
    size_t i = 0;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 4; ++i)
    {
        basic_string_push_back(pt_dest, 45.09);
        basic_string_push_back(pt_src, -0.00874);
    }
    basic_string_connect(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 8);
    for(i = 0; i < 8; ++i)
    {
        if(i < 4)
        {
            assert_true(*(double*)basic_string_at(pt_dest, i) == 45.09);
        }
        else
        {
            assert_true(*(double*)basic_string_at(pt_dest, i) == -0.00874);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_connect__char(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char);
    basic_string_t* pt_src = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 4; ++i)
    {
        basic_string_push_back(pt_dest, 'a');
        basic_string_push_back(pt_src, 'd');
    }
    basic_string_connect(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 8);
    for(i = 0; i < 8; ++i)
    {
        if(i < 4)
        {
            assert_true(*(char*)basic_string_at(pt_dest, i) == 'a');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_dest, i) == 'd');
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_connect__cstr(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    size_t i = 0;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 4; ++i)
    {
        basic_string_push_back(pt_dest, "abcd");
        basic_string_push_back(pt_src, "xyz");
    }
    basic_string_connect(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 8);
    for(i = 0; i < 8; ++i)
    {
        if(i < 4)
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "abcd") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "xyz") == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_connect__libcstl(void** state)
{
    basic_string_t* pt_dest = create_basic_string(vector_t<int>);
    basic_string_t* pt_src = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 4; ++i)
    {
        vector_clear(pvec);
        basic_string_push_back(pt_dest, pvec);
        vector_push_back(pvec, 100);
        basic_string_push_back(pt_src, pvec);
    }
    basic_string_connect(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 8);
    for(i = 0; i < 8; ++i)
    {
        if(i < 4)
        {
            assert_true(vector_empty((vector_t*)basic_string_at(pt_dest, i)));
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_dest, i)) == 1);
            assert_true(*(int*)vector_front((vector_t*)basic_string_at(pt_dest, i)) == 100);
        }
    }

    vector_destroy(pvec);
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

typedef struct _tag_test_basic_string_connect__user_define
{
    int n_elem;
}_test_basic_string_connect__user_define_t;
void test_basic_string_connect__user_define(void** state)
{
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    _test_basic_string_connect__user_define_t t_elem;
    size_t i = 0;

    type_register(_test_basic_string_connect__user_define_t, NULL, NULL, NULL, NULL);
    pt_dest = create_basic_string(_test_basic_string_connect__user_define_t);
    pt_src = create_basic_string(_test_basic_string_connect__user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 4; ++i)
    {
        t_elem.n_elem = 0;
        basic_string_push_back(pt_dest, &t_elem);
        t_elem.n_elem = 100;
        basic_string_push_back(pt_src, &t_elem);
    }
    basic_string_connect(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 8);
    for(i = 0; i < 8; ++i)
    {
        if(i < 4)
        {
            assert_true(((_test_basic_string_connect__user_define_t*)basic_string_at(pt_dest, i))->n_elem == 0);
        }
        else
        {
            assert_true(((_test_basic_string_connect__user_define_t*)basic_string_at(pt_dest, i))->n_elem == 100);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_connect_cstr
 */
UT_CASE_DEFINATION(basic_string_connect_cstr)
void test_basic_string_connect_cstr__null_basic_string(void** state)
{
    int elems[] = {0};

    expect_assert_failure(basic_string_connect_cstr(NULL, elems));
}

void test_basic_string_connect_cstr__null_value_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_connect_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x999;
    expect_assert_failure(basic_string_connect_cstr(pt_basic_string, elems));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_connect_cstr__empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    basic_string_connect_cstr(pt_basic_string, elems);
    assert_true(basic_string_empty(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect_cstr__non_empty_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    size_t i = 0;
    int elems[] = {0};

    basic_string_init_elem(pt_basic_string, 9, 100);
    basic_string_connect_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect_cstr__empty_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    size_t i = 0;
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    basic_string_connect_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == i + 1);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect_cstr__c_builtin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(double);
    size_t i = 0;
    double elems[] = {1.0, 2.0, 3.0, 4.0, 5.0, 0.0};

    basic_string_init_elem(pt_basic_string, 10, 100.0);
    basic_string_connect_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(double*)basic_string_at(pt_basic_string, i) == 100.0);
        }
        else
        {
            assert_true(*(double*)basic_string_at(pt_basic_string, i) == (i - 9) * 1.0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect_cstr__char(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "aaaaa");
    basic_string_connect_cstr(pt_basic_string, "bbbb");
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect_cstr__cstr(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "abc", "abc", "abc", NULL};
    size_t i = 0;

    basic_string_init_elem(pt_basic_string, 10, "aaaaa");
    basic_string_connect_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 14);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "aaaaa") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_connect_cstr__libcstl(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 100);
    basic_string_connect_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 13);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(vector_empty((vector_t*)basic_string_at(pt_basic_string, i)));
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
            assert_true(*(int*)vector_front((vector_t*)basic_string_at(pt_basic_string, i)) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_connect_cstr__user_define
{
    int n_elem;
}_test_basic_string_connect_cstr__user_define_t;
void test_basic_string_connect_cstr__user_define(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_connect_cstr__user_define_t t_elem;
    _test_basic_string_connect_cstr__user_define_t* elems[] = {&t_elem, &t_elem, &t_elem, NULL};
    size_t i = 0;

    type_register(_test_basic_string_connect_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_connect_cstr__user_define_t);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);
    t_elem.n_elem = 100;
    basic_string_connect_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 13);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(
                ((_test_basic_string_connect_cstr__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 0);
        }
        else
        {
            assert_true(
                ((_test_basic_string_connect_cstr__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find
 */
UT_CASE_DEFINATION(basic_string_find)
void test_basic_string_find__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find(NULL, pt_basic_string, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_find);
    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find(pt_basic_string, pt_find, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find__non_inited_find(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    pt_find->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find(pt_basic_string, pt_find, 0));
    pt_find->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(double);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_find(pt_basic_string, pt_find, 0));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_find(pt_basic_string, pt_find, 100));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__same_begin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find(pt_basic_string, pt_basic_string, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find__same_middle(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find(pt_basic_string, pt_basic_string, 4) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 4);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 4);
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 4);
    assert_true(basic_string_find(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "ooo");
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "yyy");
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "def");
    basic_string_push_back(pt_find, "ghi");
    assert_true(basic_string_find(pt_basic_string, pt_find, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 13);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 14);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 30);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 40);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_find__user_define
{
    int n_elem;
}_test_basic_string_find__user_define_t;
void test_basic_string_find__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_find = NULL;
    _test_basic_string_find__user_define_t t_elem;
    size_t i = 0;

    type_register(_test_basic_string_find__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find__user_define_t);
    pt_find = create_basic_string(_test_basic_string_find__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find__user_define_t);
    _test_basic_string_find__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find__user_define_t);
    _test_basic_string_find__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 13;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 14;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find__user_define_t);
    _test_basic_string_find__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find__user_define_t);
    _test_basic_string_find__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find__user_define_t);
    _test_basic_string_find__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 30;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 40;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find__user_define_t);
    _test_basic_string_find__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

/*
 * test basic_string_find_cstr
 */
UT_CASE_DEFINATION(basic_string_find_cstr)
void test_basic_string_find_cstr__null_basic_string(void** state)
{
    int elems[] = {1, 2, 0};
    expect_assert_failure(basic_string_find_cstr(NULL, elems, 0));
}

void test_basic_string_find_cstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_cstr(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_cstr(pt_basic_string, elems, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_cstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_find_cstr(pt_basic_string, elems, 100));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, "", 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, "de", 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, "xy", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, "", 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, "de", 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, "xy", 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, "de", 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_cstr(pt_basic_string, values, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_cstr(pt_basic_string, values, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_cstr(pt_basic_string, values, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_cstr(pt_basic_string, values, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_cstr(pt_basic_string, values, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_cstr(pt_basic_string, values, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_cstr(pt_basic_string, values, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_cstr__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_cstr__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 13);
    vector_push_back(pvec_elem2, 14);
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_cstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_cstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_cstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 30);
    vector_push_back(pvec_elem2, 40);
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_cstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_cstr__user_define
{
    int n_elem;
}_test_basic_string_find_cstr__user_define_t;
void test_basic_string_find_cstr__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_cstr__user_define_t t_elem;
    _test_basic_string_find_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    type_register(_test_basic_string_find_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_cstr__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_cstr__user_define_t);
    _test_basic_string_find_cstr__user_define_t t_elem;
    _test_basic_string_find_cstr__user_define_t t_elem1;
    _test_basic_string_find_cstr__user_define_t t_elem2;
    _test_basic_string_find_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_cstr__user_define_t);
    _test_basic_string_find_cstr__user_define_t t_elem;
    _test_basic_string_find_cstr__user_define_t t_elem1;
    _test_basic_string_find_cstr__user_define_t t_elem2;
    _test_basic_string_find_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 13;
    t_elem2.n_elem = 14;
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_cstr__user_define_t);
    _test_basic_string_find_cstr__user_define_t t_elem;
    _test_basic_string_find_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_cstr__user_define_t);
    _test_basic_string_find_cstr__user_define_t t_elem;
    _test_basic_string_find_cstr__user_define_t t_elem1;
    _test_basic_string_find_cstr__user_define_t t_elem2;
    _test_basic_string_find_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_cstr__user_define_t);
    _test_basic_string_find_cstr__user_define_t t_elem;
    _test_basic_string_find_cstr__user_define_t t_elem1;
    _test_basic_string_find_cstr__user_define_t t_elem2;
    _test_basic_string_find_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 30;
    t_elem2.n_elem = 40;
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_cstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_cstr__user_define_t);
    _test_basic_string_find_cstr__user_define_t t_elem;
    _test_basic_string_find_cstr__user_define_t t_elem1;
    _test_basic_string_find_cstr__user_define_t t_elem2;
    _test_basic_string_find_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_subcstr
 */
UT_CASE_DEFINATION(basic_string_find_subcstr)
void test_basic_string_find_subcstr__null_basic_string(void** state)
{
    int elems[] = {1, 2, 0};
    expect_assert_failure(basic_string_find_subcstr(NULL, elems, 0, NPOS));
}

void test_basic_string_find_subcstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_subcstr(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_subcstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_find_subcstr(pt_basic_string, elems, 100, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 8, 100, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, 1) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 5, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 4, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 5, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "", 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "de", 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "d", 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "x", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "", 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "de", 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "de", 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "xy", 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, "de", 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_subcstr(pt_basic_string, values, 3, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_subcstr__libcstl_builtin_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_subcstr__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_subcstr__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 13);
    vector_push_back(pvec_elem2, 14);
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_subcstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_subcstr__libcstl_builtin_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_subcstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_subcstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 30);
    vector_push_back(pvec_elem2, 40);
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_subcstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_subcstr__user_define
{
    int n_elem;
}_test_basic_string_find_subcstr__user_define_t;
void test_basic_string_find_subcstr__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    type_register(_test_basic_string_find_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__user_define_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t t_elem1;
    _test_basic_string_find_subcstr__user_define_t t_elem2;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t t_elem1;
    _test_basic_string_find_subcstr__user_define_t t_elem2;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t t_elem1;
    _test_basic_string_find_subcstr__user_define_t t_elem2;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 13;
    t_elem2.n_elem = 14;
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__user_define_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t t_elem1;
    _test_basic_string_find_subcstr__user_define_t t_elem2;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t t_elem1;
    _test_basic_string_find_subcstr__user_define_t t_elem2;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t t_elem1;
    _test_basic_string_find_subcstr__user_define_t t_elem2;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 30;
    t_elem2.n_elem = 40;
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_subcstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_subcstr__user_define_t);
    _test_basic_string_find_subcstr__user_define_t t_elem;
    _test_basic_string_find_subcstr__user_define_t t_elem1;
    _test_basic_string_find_subcstr__user_define_t t_elem2;
    _test_basic_string_find_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_rfind
 */
UT_CASE_DEFINATION(basic_string_rfind)
void test_basic_string_rfind__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_rfind(NULL, pt_basic_string, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_rfind(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_find);
    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_rfind(pt_basic_string, pt_find, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_rfind__non_inited_find(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    pt_find->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_rfind(pt_basic_string, pt_find, 0));
    pt_find->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_rfind__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(double);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_rfind(pt_basic_string, pt_find, 0));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__same_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_rfind(pt_basic_string, pt_basic_string, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind__same_middle(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_rfind(pt_basic_string, pt_basic_string, 4) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 5) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 7) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 7);
    basic_string_push_back(pt_find, 8);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 4);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 4);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 4);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    basic_string_init_cstr(pt_find, elems);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    basic_string_init_cstr(pt_find, elems);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "ooo");
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 4) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "yyy");
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 8) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "def");
    basic_string_push_back(pt_find, "ghi");
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_find, pvec);
    }
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_rfind__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_find, pvec);
    }
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_rfind__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_rfind__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_rfind__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 13);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 14);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_rfind__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_rfind__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 8) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_rfind__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 30);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 40);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_rfind__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_rfind__user_define
{
    int n_elem;
}_test_basic_string_rfind__user_define_t;
void test_basic_string_rfind__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_find = NULL;

    type_register(_test_basic_string_rfind__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_find, &t_elem);
    }
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_find, &t_elem);
    }
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 13;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 14;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 8) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 30;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 40;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_rfind__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_rfind__user_define_t);
    _test_basic_string_rfind__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_rfind(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

/*
 * test basic_string_rfind_cstr
 */
UT_CASE_DEFINATION(basic_string_rfind_cstr)
void test_basic_string_rfind_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_rfind_cstr(NULL, elems, 0));
}

void test_basic_string_rfind_cstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_rfind_cstr(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_rfind_cstr(pt_basic_string, elems, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_rfind_cstr__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 5) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 7) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {7, 8, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, "", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, "", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, "abcd", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, "abcd", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_cstr(pt_basic_string, "", NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_cstr(pt_basic_string, "de", NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_cstr(pt_basic_string, "xy", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_cstr(pt_basic_string, "", 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_cstr(pt_basic_string, "de", 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_cstr(pt_basic_string, "xy", 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_cstr(pt_basic_string, "de", 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 4) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 8) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_cstr__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_cstr__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_cstr__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_cstr__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 13);
    vector_push_back(pvec_elem2, 14);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_cstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_cstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 8) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_cstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 30);
    vector_push_back(pvec_elem2, 40);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_cstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_rfind_cstr__user_define
{
    int n_elem;
}_test_basic_string_rfind_cstr__user_define_t;
void test_basic_string_rfind_cstr__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_rfind_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t t_elem1;
    _test_basic_string_rfind_cstr__user_define_t t_elem2;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t t_elem1;
    _test_basic_string_rfind_cstr__user_define_t t_elem2;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 13;
    t_elem2.n_elem = 14;
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t t_elem1;
    _test_basic_string_rfind_cstr__user_define_t t_elem2;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 8) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t t_elem1;
    _test_basic_string_rfind_cstr__user_define_t t_elem2;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 30;
    t_elem2.n_elem = 40;
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_cstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_cstr__user_define_t);
    _test_basic_string_rfind_cstr__user_define_t t_elem;
    _test_basic_string_rfind_cstr__user_define_t t_elem1;
    _test_basic_string_rfind_cstr__user_define_t t_elem2;
    _test_basic_string_rfind_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_rfind_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_rfind_subcstr
 */
UT_CASE_DEFINATION(basic_string_rfind_subcstr)
void test_basic_string_rfind_subcstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_rfind_subcstr(NULL, elems, 0, NPOS));
}

void test_basic_string_rfind_subcstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_rfind_subcstr(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_rfind_subcstr__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 19, 444, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 5, 999) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_middle_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 5, 0) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 999, 6, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 5, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 7, 100) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {7, 8, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "abcd", 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "abcd", NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "abcd", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "abcd", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "", NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "abcdefghij", NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "de", NPOS, 15676) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "abcxy", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "", 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "defgh", 5, 0) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "de", 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "xy", 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_rfind_subcstr(pt_basic_string, "de", 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "def", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 0) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"ghi", "jkl", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mno", "lskdlk", "xxxx", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 4, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"def", "www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 8, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 13);
    vector_push_back(pvec_elem2, 14);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 8, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 30);
    vector_push_back(pvec_elem2, 40);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_rfind_subcstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 1, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_rfind_subcstr__user_define
{
    int n_elem;
}_test_basic_string_rfind_subcstr__user_define_t;
void test_basic_string_rfind_subcstr__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_rfind_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t t_elem1;
    _test_basic_string_rfind_subcstr__user_define_t t_elem2;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t t_elem1;
    _test_basic_string_rfind_subcstr__user_define_t t_elem2;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t t_elem1;
    _test_basic_string_rfind_subcstr__user_define_t t_elem2;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 13;
    t_elem2.n_elem = 14;
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t t_elem1;
    _test_basic_string_rfind_subcstr__user_define_t t_elem2;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t t_elem1;
    _test_basic_string_rfind_subcstr__user_define_t t_elem2;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 8, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t t_elem1;
    _test_basic_string_rfind_subcstr__user_define_t t_elem2;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 30;
    t_elem2.n_elem = 40;
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_rfind_subcstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_rfind_subcstr__user_define_t);
    _test_basic_string_rfind_subcstr__user_define_t t_elem;
    _test_basic_string_rfind_subcstr__user_define_t t_elem1;
    _test_basic_string_rfind_subcstr__user_define_t t_elem2;
    _test_basic_string_rfind_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_rfind_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_first_of
 */
UT_CASE_DEFINATION(basic_string_find_first_of)
void test_basic_string_find_first_of__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_first_of(NULL, pt_basic_string, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_first_of(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_find);
    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_first_of(pt_basic_string, pt_find, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find_first_of__non_inited_find(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    pt_find->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_first_of(pt_basic_string, pt_find, 0));
    pt_find->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find_first_of__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(double);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_find_first_of(pt_basic_string, pt_find, 0));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_find_first_of(pt_basic_string, pt_find, 100));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__same_begin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_basic_string, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of__same_middle(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_basic_string, 4) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 122);
    basic_string_push_back(pt_find, 3);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 15);
    basic_string_push_back(pt_find, 'a' + 3);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 4);
    basic_string_push_back(pt_find, 'a' + 5);
    basic_string_push_back(pt_find, 'a' + 3);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 4);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "ooo");
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "yyy");
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "ghi");
    basic_string_push_back(pt_find, "def");
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 13);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 14);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 30);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 40);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_find_first_of__user_define
{
    int n_elem;
}_test_basic_string_find_first_of__user_define_t;
void test_basic_string_find_first_of__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_find = NULL;
    _test_basic_string_find_first_of__user_define_t t_elem;
    size_t i = 0;

    type_register(_test_basic_string_find_first_of__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    pt_find = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    _test_basic_string_find_first_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    _test_basic_string_find_first_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 13;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 14;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    _test_basic_string_find_first_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    _test_basic_string_find_first_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    _test_basic_string_find_first_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 30;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 40;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_of__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_of__user_define_t);
    _test_basic_string_find_first_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_first_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

/*
 * test basic_string_find_first_of_cstr
 */
UT_CASE_DEFINATION(basic_string_find_first_of_cstr)
void test_basic_string_find_first_of_cstr__null_basic_string(void** state)
{
    int elems[] = {1, 2, 0};
    expect_assert_failure(basic_string_find_first_of_cstr(NULL, elems, 0));
}

void test_basic_string_find_first_of_cstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_first_of_cstr(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_first_of_cstr(pt_basic_string, elems, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_first_of_cstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_find_first_of_cstr(pt_basic_string, elems, 100));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1113, 3, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, "", 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, "xydeh", 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, "xy", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, "", 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, "fed", 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, "xy", 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, "de", 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, values, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, values, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, values, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, values, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, values, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, values, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, values, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of_cstr__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_cstr__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 13);
    vector_push_back(pvec_elem2, 14);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_cstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of_cstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_cstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 30);
    vector_push_back(pvec_elem2, 40);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_cstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_first_of_cstr__user_define
{
    int n_elem;
}_test_basic_string_find_first_of_cstr__user_define_t;
void test_basic_string_find_first_of_cstr__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_of_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    type_register(_test_basic_string_find_first_of_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_first_of_cstr__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_cstr__user_define_t);
    _test_basic_string_find_first_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_cstr__user_define_t);
    _test_basic_string_find_first_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 13;
    t_elem2.n_elem = 14;
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_cstr__user_define_t);
    _test_basic_string_find_first_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_of_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_cstr__user_define_t);
    _test_basic_string_find_first_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_cstr__user_define_t);
    _test_basic_string_find_first_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 30;
    t_elem2.n_elem = 40;
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_cstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_cstr__user_define_t);
    _test_basic_string_find_first_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_of_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_first_of_subcstr
 */
UT_CASE_DEFINATION(basic_string_find_first_of_subcstr)
void test_basic_string_find_first_of_subcstr__null_basic_string(void** state)
{
    int elems[] = {1, 2, 0};
    expect_assert_failure(basic_string_find_first_of_subcstr(NULL, elems, 0, NPOS));
}

void test_basic_string_find_first_of_subcstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_first_of_subcstr(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_first_of_subcstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_find_first_of_subcstr(pt_basic_string, elems, 100, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {4, 3, 8, 100, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {73, 54, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {63, 3, 4, 6, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {23, 24, 25, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, 4) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 5, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "", 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "de", 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "de", 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "xy", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "", 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "de", 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "de", 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "xy", 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, "de", 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, values, 3, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 13);
    vector_push_back(pvec_elem2, 14);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 30);
    vector_push_back(pvec_elem2, 40);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_of_subcstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_first_of_subcstr__user_define
{
    int n_elem;
}_test_basic_string_find_first_of_subcstr__user_define_t;
void test_basic_string_find_first_of_subcstr__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    type_register(_test_basic_string_find_first_of_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__user_define_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 13;
    t_elem2.n_elem = 14;
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__user_define_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 30;
    t_elem2.n_elem = 40;
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_of_subcstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_of_subcstr__user_define_t);
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_of_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_first_not_of
 */
UT_CASE_DEFINATION(basic_string_find_first_not_of)
void test_basic_string_find_first_not_of__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_first_not_of(NULL, pt_basic_string, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_first_not_of(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_find);
    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_first_not_of(pt_basic_string, pt_find, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find_first_not_of__non_inited_find(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    pt_find->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_first_not_of(pt_basic_string, pt_find, 0));
    pt_find->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find_first_not_of__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(double);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_find_first_not_of(pt_basic_string, pt_find, 0));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_find_first_not_of(pt_basic_string, pt_find, 100));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__same_begin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_basic_string, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of__same_middle(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_basic_string, 4) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 1);
    basic_string_push_back(pt_find, 2);
    basic_string_push_back(pt_find, 0);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 0);
    basic_string_push_back(pt_find, 2);
    basic_string_push_back(pt_find, 1);
    basic_string_push_back(pt_find, 5);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 1);
    basic_string_push_back(pt_find, 'a' + 2);
    basic_string_push_back(pt_find, 'a' + 0);
    basic_string_push_back(pt_find, 'a' + 4);
    basic_string_push_back(pt_find, 'a' + 5);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 4);
    basic_string_push_back(pt_find, 'a' + 5);
    basic_string_push_back(pt_find, 'a' + 2);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "ghi");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init_cstr(pt_find, elems);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init_cstr(pt_find, elems);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 1);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 2);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_find_first_not_of__user_define
{
    int n_elem;
}_test_basic_string_find_first_not_of__user_define_t;
void test_basic_string_find_first_not_of__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_find = NULL;
    _test_basic_string_find_first_not_of__user_define_t t_elem;
    size_t i = 0;

    type_register(_test_basic_string_find_first_not_of__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    pt_find = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    _test_basic_string_find_first_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 0;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 1;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == 2);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    _test_basic_string_find_first_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    _test_basic_string_find_first_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    _test_basic_string_find_first_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 2;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    _test_basic_string_find_first_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_first_not_of__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_first_not_of__user_define_t);
    _test_basic_string_find_first_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    basic_string_init_copy(pt_find, pt_basic_string);
    assert_true(basic_string_find_first_not_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

/*
 * test basic_string_find_first_not_of_cstr
 */
UT_CASE_DEFINATION(basic_string_find_first_not_of_cstr)
void test_basic_string_find_first_not_of_cstr__null_basic_string(void** state)
{
    int elems[] = {1, 2, 0};
    expect_assert_failure(basic_string_find_first_not_of_cstr(NULL, elems, 0));
}

void test_basic_string_find_first_not_of_cstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_first_not_of_cstr(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_first_not_of_cstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 100));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 5, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 5, 6, 7, 8, 9, 10, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {6, 7, 8, 9, 10, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, "", 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, "abcefghijklmn", 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, "jklmnxfghiyabcde", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, "", 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, "efghijklmnabc", 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, "abcdxyeopfgqhijklmn", 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, "fghijklmnopq", 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, values, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"mno", "abc", "ghi", "def", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, values, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"def", "ghi", "abc", "jkl", "mno", "www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, values, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, values, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"mno", "def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, values, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "abc", "def", "ghi", "jkl", "mno", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, values, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, values, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of_cstr__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 0);
    vector_push_back(pvec_elem2, 2);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == 1);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_cstr__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 0);
    vector_push_back(pvec_elem2, 1);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_cstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of_cstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 2);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_cstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 4; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 2);
    vector_push_back(pvec_elem2, 3);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_cstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 7; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 5);
    vector_push_back(pvec_elem2, 6);
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_first_not_of_cstr__user_define
{
    int n_elem;
}_test_basic_string_find_first_not_of_cstr__user_define_t;
void test_basic_string_find_first_not_of_cstr__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    type_register(_test_basic_string_find_first_not_of_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_cstr__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_cstr__user_define_t);
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 0;
    t_elem2.n_elem = 1;
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_cstr__user_define_t);
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 0;
    t_elem2.n_elem = 1;
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_cstr__user_define_t);
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_cstr__user_define_t);
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 2;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 2) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_cstr__user_define_t);
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 4; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 2;
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_cstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_cstr__user_define_t);
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 7; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 5;
    t_elem2.n_elem = 6;
    assert_true(basic_string_find_first_not_of_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_first_not_of_subcstr
 */
UT_CASE_DEFINATION(basic_string_find_first_not_of_subcstr)
void test_basic_string_find_first_not_of_subcstr__null_basic_string(void** state)
{
    int elems[] = {1, 2, 0};
    expect_assert_failure(basic_string_find_first_not_of_subcstr(NULL, elems, 0, NPOS));
}

void test_basic_string_find_first_not_of_subcstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_first_not_of_subcstr(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_first_not_of_subcstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 0};

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 100, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 5, 6, 7, 9, 10, 3, 8, 100, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, 15) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 5, 6, 7, 9, 10, 3, 8, 4, 100, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 5, 6, 7, 9, 10, 3, 8, 100, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 5, 6, 7, 9, 10, 3, 8, 4, 100, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, 12) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 5, 6, 7, 9, 10, 3, 8, 4, 100, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "", 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "de", 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "abcefghijklmn", 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "xyabcdefghijklmn", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "", 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "de", 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "abcefghijklmn", 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "xyabcdefghijklmn", 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, "fghijklmn", 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"abc", "def", "ghi", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 0, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "abc", "def", "ghi", "jkl", "mno", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"abc", "def", "ghi", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"www", "ghi", "jkl", "mno", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* values[] = {"def", "ghi", "abc", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, values, 3, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 1);
    vector_push_back(pvec_elem2, 2);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 0);
    vector_push_back(pvec_elem2, 1);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 2);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 4; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 2);
    vector_push_back(pvec_elem2, 3);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_first_not_of_subcstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 7; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 5);
    vector_push_back(pvec_elem2, 6);
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_first_not_of_subcstr__user_define
{
    int n_elem;
}_test_basic_string_find_first_not_of_subcstr__user_define_t;
void test_basic_string_find_first_not_of_subcstr__user_define_begin_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    type_register(_test_basic_string_find_first_not_of_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__user_define_begin_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, 0) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__user_define_begin_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 0;
    t_elem2.n_elem = 2;
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == 1);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__user_define_begin_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 0;
    t_elem2.n_elem = 1;
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__user_define_middle_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, 0) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 2;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 4; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 2;
    t_elem2.n_elem = 3;
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_first_not_of_subcstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_first_not_of_subcstr__user_define_t);
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_first_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_first_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 7; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 5;
    t_elem2.n_elem = 6;
    assert_true(basic_string_find_first_not_of_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_last_of
 */
UT_CASE_DEFINATION(basic_string_find_last_of)
void test_basic_string_find_last_of__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_last_of(NULL, pt_basic_string, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_last_of(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_find);
    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_last_of(pt_basic_string, pt_find, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find_last_of__non_inited_find(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    pt_find->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_last_of(pt_basic_string, pt_find, 0));
    pt_find->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find_last_of__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(double);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_find_last_of(pt_basic_string, pt_find, 0));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__same_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_basic_string, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of__same_middle(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_basic_string, 4) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 5) == 4);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 7) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 7);
    basic_string_push_back(pt_find, 8);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 4);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    basic_string_init_cstr(pt_find, elems);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    basic_string_init_cstr(pt_find, elems);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mnoxxxx");
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "ooo");
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mnoxxxx");
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 4) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "yyy");
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 8) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "def");
    basic_string_push_back(pt_find, "ghi");
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_find, pvec);
    }
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_find, pvec);
    }
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 14);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 13);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 14);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 8) == 4);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 30);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 40);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 3);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 4);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_find_last_of__user_define
{
    int n_elem;
}_test_basic_string_find_last_of__user_define_t;
void test_basic_string_find_last_of__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_find = NULL;

    type_register(_test_basic_string_find_last_of__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_find, &t_elem);
    }
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_find, &t_elem);
    }
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 13;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 14;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 8) == 4);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 30;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 40;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_of__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_of__user_define_t);
    _test_basic_string_find_last_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 4;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

/*
 * test basic_string_find_last_of_cstr
 */
UT_CASE_DEFINATION(basic_string_find_last_of_cstr)
void test_basic_string_find_last_of_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_find_last_of_cstr(NULL, elems, 0));
}

void test_basic_string_find_last_of_cstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_last_of_cstr(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_last_of_cstr(pt_basic_string, elems, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_last_of_cstr__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 49, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 5) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 7) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {7, 8, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "abcd", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "abcd", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "", NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "dxyz", NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "xy", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "", 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "de", 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "xy", 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, "de", 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mnx", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mnx", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 4) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 8) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 13);
    vector_push_back(pvec_elem2, 14);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 8) == 4);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 30);
    vector_push_back(pvec_elem2, 40);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_cstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_last_of_cstr__user_define
{
    int n_elem;
}_test_basic_string_find_last_of_cstr__user_define_t;
void test_basic_string_find_last_of_cstr__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_find_last_of_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 13;
    t_elem2.n_elem = 14;
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 8) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 30;
    t_elem2.n_elem = 40;
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_cstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_cstr__user_define_t);
    _test_basic_string_find_last_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_last_of_subcstr
 */
UT_CASE_DEFINATION(basic_string_find_last_of_subcstr)
void test_basic_string_find_last_of_subcstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_find_last_of_subcstr(NULL, elems, 0, NPOS));
}

void test_basic_string_find_last_of_subcstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_last_of_subcstr(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_last_of_subcstr__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {11, 4, 19, 444, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 2) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 5, 999) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_middle_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 5, 0) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 999, 6, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 5, 2) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {23, 24, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 7, 100) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {7, 8, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "abcd", 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "abcd", NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "abcd", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "abcd", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "", NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "abcdefghij", NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "de", NPOS, 15676) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "wwwxy", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "", 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "defgh", 5, 0) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "de", 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "xy", 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, "de", 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "def", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 0) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"ghi", "jkl", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mno", "lskdlk", "xxxx", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 4, 2) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"drf", "www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 8, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 13);
    vector_push_back(pvec_elem2, 14);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 8, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 30);
    vector_push_back(pvec_elem2, 40);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_of_subcstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 1, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_last_of_subcstr__user_define
{
    int n_elem;
}_test_basic_string_find_last_of_subcstr__user_define_t;
void test_basic_string_find_last_of_subcstr__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_find_last_of_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 13;
    t_elem2.n_elem = 14;
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 8, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 30;
    t_elem2.n_elem = 40;
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_of_subcstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_of_subcstr__user_define_t);
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_of_subcstr(pt_basic_string, elems, 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_last_not_of
 */
UT_CASE_DEFINATION(basic_string_find_last_not_of)
void test_basic_string_find_last_not_of__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_last_not_of(NULL, pt_basic_string, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_last_not_of(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_find);
    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_last_not_of(pt_basic_string, pt_find, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find_last_not_of__non_inited_find(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    pt_find->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_last_not_of(pt_basic_string, pt_find, 0));
    pt_find->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    */
}

void test_basic_string_find_last_not_of__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(double);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    expect_assert_failure(basic_string_find_last_not_of(pt_basic_string, pt_find, 0));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__same_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_basic_string, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of__same_middle(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_basic_string, 4) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 9);
    basic_string_push_back(pt_find, 4);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 8);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 3);
    basic_string_push_back(pt_find, 4);
    basic_string_push_back(pt_find, 5);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 5) == 2);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    basic_string_push_back(pt_find, 13);
    basic_string_push_back(pt_find, 14);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 7) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_find = create_basic_string(int);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    basic_string_push_back(pt_find, 7);
    basic_string_push_back(pt_find, 8);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);

    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_find, 10, 100);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 5) == 5);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 3);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 3) == 2);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    basic_string_push_back(pt_find, 'a' + 13);
    basic_string_push_back(pt_find, 'a' + 14);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_find = create_basic_string(char);
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, 'a' + i);
    }
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, 'a' + 0);
    basic_string_push_back(pt_find, 'a' + 1);
    basic_string_push_back(pt_find, 'a' + 2);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    basic_string_init_cstr(pt_find, elems);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    basic_string_init_cstr(pt_find, elems);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 2);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init_copy(pt_find, pt_basic_string);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "ooo");
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "jkl");
    basic_string_push_back(pt_find, "mno");
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 4) == 2);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init_copy(pt_find, pt_basic_string);
    basic_string_push_back(pt_find, "www");
    basic_string_push_back(pt_find, "yyy");
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 8) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_find = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_init(pt_find);
    basic_string_push_back(pt_find, "def");
    basic_string_push_back(pt_find, "abc");
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_find, pvec);
    }
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_find, pvec);
    }
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 9);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 14);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 8);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    vector_clear(pvec);
    vector_push_back(pvec, 13);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 14);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 8);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 7);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 8) == 6);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 2);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 1);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_find = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    basic_string_init(pt_find);
    vector_clear(pvec);
    vector_push_back(pvec, 1);
    basic_string_push_back(pt_find, pvec);
    vector_clear(pvec);
    vector_push_back(pvec, 0);
    basic_string_push_back(pt_find, pvec);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_find_last_not_of__user_define
{
    int n_elem;
}_test_basic_string_find_last_not_of__user_define_t;
void test_basic_string_find_last_not_of__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_find = NULL;

    type_register(_test_basic_string_find_last_not_of__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_find, &t_elem);
    }
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    basic_string_init(pt_find);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_find, &t_elem);
    }
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 3;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 9;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == 8);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init_copy(pt_find, pt_basic_string);
    t_elem.n_elem = 13;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 14;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 3) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 8;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 7;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 8) == 6);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 0;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 2;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 1;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

void test_basic_string_find_last_not_of__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    basic_string_t* pt_find = create_basic_string(_test_basic_string_find_last_not_of__user_define_t);
    _test_basic_string_find_last_not_of__user_define_t t_elem;
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    basic_string_init(pt_find);
    t_elem.n_elem = 0;
    basic_string_push_back(pt_find, &t_elem);
    t_elem.n_elem = 1;
    basic_string_push_back(pt_find, &t_elem);
    assert_true(basic_string_find_last_not_of(pt_basic_string, pt_find, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_find);
}

/*
 * test basic_string_find_last_not_of_cstr
 */
UT_CASE_DEFINATION(basic_string_find_last_not_of_cstr)
void test_basic_string_find_last_not_of_cstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_find_last_not_of_cstr(NULL, elems, 0));
}

void test_basic_string_find_last_not_of_cstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_last_not_of_cstr(pt_basic_string, NULL, 0));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_last_not_of_cstr__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 8, 3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == 7);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 8, 7, 6, 5, 4, 3, 2, 1, 10, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {6, 5, 49, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 5) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {8, 7, 6, 5, 4, 3, 2, 1, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 7) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {6, 5, 4, 3, 2, 1, 7, 8, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "abcd", 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "abcd", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "", NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "abcefghij", NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "abcdefghij", NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "", 5) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "abcef", 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "abcdefghij", 5) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, "abc", 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "def", "ghi", "jjj", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", "www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "ghi", "jkl", "mnx", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 2) == 1);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", "www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 8) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"def", "abc", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 4; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 2);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == 1);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 1);
    vector_push_back(pvec_elem2, 0);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 8);
    vector_push_back(pvec_elem2, 7);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 8) == 6);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 0);
    vector_push_back(pvec_elem2, 1);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_cstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 0);
    vector_push_back(pvec_elem2, 1);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 1) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_last_not_of_cstr__user_define
{
    int n_elem;
}_test_basic_string_find_last_not_of_cstr__user_define_t;
void test_basic_string_find_last_not_of_cstr__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_find_last_not_of_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 1;
    t_elem2.n_elem = 0;
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 3) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 8;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 8) == 7);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 0;
    t_elem2.n_elem = 1;
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_cstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_cstr__user_define_t);
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_cstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_cstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 1;
    t_elem2.n_elem = 0;
    assert_true(basic_string_find_last_not_of_cstr(pt_basic_string, elems, 2) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_find_last_not_of_subcstr
 */
UT_CASE_DEFINATION(basic_string_find_last_not_of_subcstr)
void test_basic_string_find_last_not_of_subcstr__null_basic_string(void** state)
{
    int elems[] = {0};
    expect_assert_failure(basic_string_find_last_not_of_subcstr(NULL, elems, 0, NPOS));
}

void test_basic_string_find_last_not_of_subcstr__null_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_find_last_not_of_subcstr(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    pt_basic_string->_vec_base._pby_start = (_byte_t*)0x888;
    expect_assert_failure(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS));
    pt_basic_string->_vec_base._pby_start = NULL;

    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, 3) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {11, 9, 8, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 2) == 8);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 5, 999) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_middle_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 5, 0) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 999, 6, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }
    basic_string_push_back(pt_basic_string, 3);
    basic_string_push_back(pt_basic_string, 4);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 5, 2) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 23, 24, 13, 14, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 7, 100) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__c_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {7, 8, 6, 5, 4, 3, 2, 1, 0};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i + 1);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "abcd", 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "abcd", NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "abcd", 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "abcd", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "", NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "abcdefghij", NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "fghijklmn", NPOS, 15676) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "wabcdewfghijwklmxnoy", NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "", 5, NPOS) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "defgh", 5, 0) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "abcefg", 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "xabcdefgy", 5, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__char_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    size_t i = 0;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, "abcde", 2, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "def", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 0) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mnx", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "ghi", "jkl", "def", "mno", "www", "ooo", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"ghi", "jkl", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"jkl", "mno", "lskdlk", "xxxx", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 4, 3) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "ghi", "jkl", "mno", "def", "www", "yyy", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 8, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__cstr_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* values[] = {"abc", "def", "ghi", "jkl", "mno", NULL};
    const char* elems[] = {"abc", "def", "ghi", NULL};

    basic_string_init_cstr(pt_basic_string, values);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 9);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 8);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 0);
    vector_push_back(pvec_elem2, 1);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {NULL};
    size_t i = 0;

    vector_init(pvec);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 3);
    vector_push_back(pvec_elem2, 4);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 8);
    vector_push_back(pvec_elem2, 7);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 8, NPOS) == 6);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 0);
    vector_push_back(pvec_elem2, 1);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 1, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

void test_basic_string_find_last_not_of_subcstr__libcstl_builtin_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* pvec_elem1 = create_vector(int);
    vector_t* pvec_elem2 = create_vector(int);
    vector_t* elems[] = {pvec_elem1, pvec_elem2, NULL};
    size_t i = 0;

    vector_init(pvec);
    vector_init(pvec_elem1);
    vector_init(pvec_elem2);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        vector_clear(pvec);
        vector_push_back(pvec, i);
        basic_string_push_back(pt_basic_string, pvec);
    }
    vector_push_back(pvec_elem1, 0);
    vector_push_back(pvec_elem2, 1);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 1, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
    vector_destroy(pvec_elem1);
    vector_destroy(pvec_elem2);
}

typedef struct _tag_test_basic_string_find_last_not_of_subcstr__user_define
{
    int n_elem;
}_test_basic_string_find_last_not_of_subcstr__user_define_t;
void test_basic_string_find_last_not_of_subcstr__user_define_empty_empty_0(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_find_last_not_of_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_empty_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_empty_non_empty_0_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_empty_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 0) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_empty_non_empty_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 0, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_empty_non_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem, &t_elem, NULL};

    basic_string_init(pt_basic_string);
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_empty_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_non_empty_npos_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, 0) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == 9);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_not_find_npos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 2; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 1;
    t_elem2.n_elem = 0;
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, NPOS, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_middle_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 3, NPOS) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_middle_non_empty_length_0(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 3;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 3, 0) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_middle_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 8;
    t_elem2.n_elem = 4;
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 8, NPOS) == 7);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_middle_not_find(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 1;
    t_elem2.n_elem = 0;
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 1, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_find_last_not_of_subcstr__user_define_middle_not_find_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_find_last_not_of_subcstr__user_define_t);
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem1;
    _test_basic_string_find_last_not_of_subcstr__user_define_t t_elem2;
    _test_basic_string_find_last_not_of_subcstr__user_define_t* elems[] = {&t_elem1, &t_elem2, NULL};
    size_t i = 0;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_elem.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_elem);
    }
    t_elem1.n_elem = 1;
    t_elem2.n_elem = 0;
    assert_true(basic_string_find_last_not_of_subcstr(pt_basic_string, elems, 1, NPOS) == NPOS);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_begin
 */
UT_CASE_DEFINATION(basic_string_begin)
void test_basic_string_begin__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_begin(NULL));
}

void test_basic_string_begin__non_inited_basic_string_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_begin(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_begin__empty(void** state)
{
    basic_string_iterator_t it_begin;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    it_begin = basic_string_begin(pt_basic_string);
    assert_true(iterator_equal(it_begin, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_begin__non_empty(void** state)
{
    basic_string_iterator_t it_begin;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_push_back(pt_basic_string, 123);
    basic_string_push_back(pt_basic_string, 209);
    basic_string_push_back(pt_basic_string, 3);

    it_begin = basic_string_begin(pt_basic_string);
    assert_true(it_begin._t_pos._pby_corepos == pt_basic_string->_pby_string);
    assert_true(*(int*)iterator_get_pointer(it_begin) == 123);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_begin__shared(void** state)
{
    basic_string_iterator_t it_begin;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pbstr = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_push_back(pt_basic_string, 123);
    basic_string_push_back(pt_basic_string, 209);
    basic_string_push_back(pt_basic_string, 3);
    basic_string_init_copy(pbstr, pt_basic_string);

    assert_true(pbstr->_pby_string == pt_basic_string->_pby_string);
    it_begin = basic_string_begin(pt_basic_string);
    assert_true(it_begin._t_pos._pby_corepos == pt_basic_string->_pby_string);
    assert_true(*(int*)iterator_get_pointer(it_begin) == 123);
    assert_true(pbstr->_pby_string != pt_basic_string->_pby_string);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(basic_string_capacity(pt_basic_string) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pbstr);
}

/*
 * test basic_string_end
 */
UT_CASE_DEFINATION(basic_string_end)
void test_basic_string_end__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_end(NULL));
}

void test_basic_string_end__non_inited_basic_string_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_end(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_end__empty(void** state)
{
    basic_string_iterator_t it_end;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    it_end = basic_string_end(pt_basic_string);
    assert_true(iterator_equal(it_end, basic_string_begin(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_end__non_empty(void** state)
{
    basic_string_iterator_t it_end;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_push_back(pt_basic_string, 123);
    basic_string_push_back(pt_basic_string, 209);
    basic_string_push_back(pt_basic_string, 3);

    it_end = basic_string_end(pt_basic_string);
    assert_true(it_end._t_pos._pby_corepos ==
        pt_basic_string->_pby_string + _GET_BASIC_STRING_TYPE_SIZE(pt_basic_string) * basic_string_size(pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_end__shared(void** state)
{
    basic_string_iterator_t it_end;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pbstr = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_push_back(pt_basic_string, 123);
    basic_string_push_back(pt_basic_string, 209);
    basic_string_push_back(pt_basic_string, 3);
    basic_string_init_copy(pbstr, pt_basic_string);

    assert_true(pbstr->_pby_string == pt_basic_string->_pby_string);
    it_end = basic_string_end(pt_basic_string);
    assert_true(it_end._t_pos._pby_corepos ==
        pt_basic_string->_pby_string + _GET_BASIC_STRING_TYPE_SIZE(pt_basic_string) * basic_string_size(pt_basic_string));
    assert_true(pbstr->_pby_string != pt_basic_string->_pby_string);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(basic_string_capacity(pt_basic_string) == 3);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pbstr);
}


/*
 * test basic_string_clear
 */
UT_CASE_DEFINATION(basic_string_clear)
void test_basic_string_clear__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_clear(NULL));
}

void test_basic_string_clear__non_inited_basic_string_container(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x89;
    expect_assert_failure(basic_string_clear(pt_basic_string));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_clear__empty_basic_string_container(void** state)
{
    size_t t_oldcapacity = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    t_oldcapacity = basic_string_capacity(pt_basic_string);

    basic_string_clear(pt_basic_string);
    assert_true(basic_string_size(pt_basic_string) == 0);
    assert_true(basic_string_capacity(pt_basic_string) == t_oldcapacity);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_clear__non_empty_basic_string_container(void** state)
{
    size_t t_oldcapacity = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 198, 100);
    t_oldcapacity = basic_string_capacity(pt_basic_string);

    basic_string_clear(pt_basic_string);
    assert_true(basic_string_size(pt_basic_string) == 0);
    assert_true(basic_string_capacity(pt_basic_string) == t_oldcapacity);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_swap
 */
UT_CASE_DEFINATION(basic_string_swap)
void test_basic_string_swap__null_first(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_swap(NULL, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_swap__null_second(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_swap(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_swap__non_inited_first(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_second);
    pt_first->_vec_base._pby_finish = (_byte_t*)0x88;

    expect_assert_failure(basic_string_swap(pt_first, pt_second));

    pt_first->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_swap__non_inited_second(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    pt_second->_vec_base._pby_finish = (_byte_t*)0x88;

    expect_assert_failure(basic_string_swap(pt_first, pt_second));

    pt_second->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
    */
}

void test_basic_string_swap__not_same_type(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(double);

    basic_string_init(pt_first);
    basic_string_init(pt_second);

    expect_assert_failure(basic_string_swap(pt_first, pt_second));

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__basic_string_equal(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);

    basic_string_init(pt_first);
    basic_string_init(pt_second);

    basic_string_swap(pt_first, pt_second);

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__0_swap_10(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);
    size_t t_firstsize = 0;
    size_t t_firstcapacity = 0;
    size_t t_secondsize = 0;
    size_t t_secondcapacity = 0;
    size_t i = 0;

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 10, 100);

    t_firstsize = basic_string_size(pt_first);
    t_firstcapacity = basic_string_capacity(pt_first);
    t_secondsize = basic_string_size(pt_second);
    t_secondcapacity = basic_string_capacity(pt_second);
    basic_string_swap(pt_first, pt_second);

    assert_true(basic_string_size(pt_first) == t_secondsize);
    assert_true(basic_string_capacity(pt_first) == t_secondcapacity);
    assert_true(basic_string_size(pt_second) == t_firstsize);
    assert_true(basic_string_capacity(pt_second) == t_firstcapacity);
    for(i = 0; i < basic_string_size(pt_first); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_first, i) == 100);
    }
    for(i = 0; i < basic_string_size(pt_second); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_second, i) == 0);
    }

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__0_swap_1000(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);
    size_t t_firstsize = 0;
    size_t t_firstcapacity = 0;
    size_t t_secondsize = 0;
    size_t t_secondcapacity = 0;
    size_t i = 0;

    basic_string_init(pt_first);
    basic_string_init_elem(pt_second, 1000, 100);

    t_firstsize = basic_string_size(pt_first);
    t_firstcapacity = basic_string_capacity(pt_first);
    t_secondsize = basic_string_size(pt_second);
    t_secondcapacity = basic_string_capacity(pt_second);
    basic_string_swap(pt_first, pt_second);

    assert_true(basic_string_size(pt_first) == t_secondsize);
    assert_true(basic_string_capacity(pt_first) == t_secondcapacity);
    assert_true(basic_string_size(pt_second) == t_firstsize);
    assert_true(basic_string_capacity(pt_second) == t_firstcapacity);
    for(i = 0; i < basic_string_size(pt_first); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_first, i) == 100);
    }
    for(i = 0; i < basic_string_size(pt_second); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_second, i) == 0);
    }

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__10_swap_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);
    size_t t_firstsize = 0;
    size_t t_firstcapacity = 0;
    size_t t_secondsize = 0;
    size_t t_secondcapacity = 0;
    size_t i = 0;

    basic_string_init_elem(pt_first, 10, 0);
    basic_string_init(pt_second);

    t_firstsize = basic_string_size(pt_first);
    t_firstcapacity = basic_string_capacity(pt_first);
    t_secondsize = basic_string_size(pt_second);
    t_secondcapacity = basic_string_capacity(pt_second);
    basic_string_swap(pt_first, pt_second);

    assert_true(basic_string_size(pt_first) == t_secondsize);
    assert_true(basic_string_capacity(pt_first) == t_secondcapacity);
    assert_true(basic_string_size(pt_second) == t_firstsize);
    assert_true(basic_string_capacity(pt_second) == t_firstcapacity);
    for(i = 0; i < basic_string_size(pt_first); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_first, i) == 100);
    }
    for(i = 0; i < basic_string_size(pt_second); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_second, i) == 0);
    }

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__10_swap_10(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);
    size_t t_firstsize = 0;
    size_t t_firstcapacity = 0;
    size_t t_secondsize = 0;
    size_t t_secondcapacity = 0;
    size_t i = 0;

    basic_string_init_elem(pt_first, 10, 0);
    basic_string_init_elem(pt_second, 10, 100);

    t_firstsize = basic_string_size(pt_first);
    t_firstcapacity = basic_string_capacity(pt_first);
    t_secondsize = basic_string_size(pt_second);
    t_secondcapacity = basic_string_capacity(pt_second);
    basic_string_swap(pt_first, pt_second);

    assert_true(basic_string_size(pt_first) == t_secondsize);
    assert_true(basic_string_capacity(pt_first) == t_secondcapacity);
    assert_true(basic_string_size(pt_second) == t_firstsize);
    assert_true(basic_string_capacity(pt_second) == t_firstcapacity);
    for(i = 0; i < basic_string_size(pt_first); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_first, i) == 100);
    }
    for(i = 0; i < basic_string_size(pt_second); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_second, i) == 0);
    }

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__10_swap_1000(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);
    size_t t_firstsize = 0;
    size_t t_firstcapacity = 0;
    size_t t_secondsize = 0;
    size_t t_secondcapacity = 0;
    size_t i = 0;

    basic_string_init_elem(pt_first, 10, 0);
    basic_string_init_elem(pt_second, 1000, 100);

    t_firstsize = basic_string_size(pt_first);
    t_firstcapacity = basic_string_capacity(pt_first);
    t_secondsize = basic_string_size(pt_second);
    t_secondcapacity = basic_string_capacity(pt_second);
    basic_string_swap(pt_first, pt_second);

    assert_true(basic_string_size(pt_first) == t_secondsize);
    assert_true(basic_string_capacity(pt_first) == t_secondcapacity);
    assert_true(basic_string_size(pt_second) == t_firstsize);
    assert_true(basic_string_capacity(pt_second) == t_firstcapacity);
    for(i = 0; i < basic_string_size(pt_first); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_first, i) == 100);
    }
    for(i = 0; i < basic_string_size(pt_second); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_second, i) == 0);
    }

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__1000_swap_0(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);
    size_t t_firstsize = 0;
    size_t t_firstcapacity = 0;
    size_t t_secondsize = 0;
    size_t t_secondcapacity = 0;
    size_t i = 0;

    basic_string_init_elem(pt_first, 1000, 0);
    basic_string_init_elem(pt_second, 0, 100);

    t_firstsize = basic_string_size(pt_first);
    t_firstcapacity = basic_string_capacity(pt_first);
    t_secondsize = basic_string_size(pt_second);
    t_secondcapacity = basic_string_capacity(pt_second);
    basic_string_swap(pt_first, pt_second);

    assert_true(basic_string_size(pt_first) == t_secondsize);
    assert_true(basic_string_capacity(pt_first) == t_secondcapacity);
    assert_true(basic_string_size(pt_second) == t_firstsize);
    assert_true(basic_string_capacity(pt_second) == t_firstcapacity);
    for(i = 0; i < basic_string_size(pt_first); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_first, i) == 100);
    }
    for(i = 0; i < basic_string_size(pt_second); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_second, i) == 0);
    }

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__1000_swap_10(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);
    size_t t_firstsize = 0;
    size_t t_firstcapacity = 0;
    size_t t_secondsize = 0;
    size_t t_secondcapacity = 0;
    size_t i = 0;

    basic_string_init_elem(pt_first, 1000, 0);
    basic_string_init_elem(pt_second, 10, 100);

    t_firstsize = basic_string_size(pt_first);
    t_firstcapacity = basic_string_capacity(pt_first);
    t_secondsize = basic_string_size(pt_second);
    t_secondcapacity = basic_string_capacity(pt_second);
    basic_string_swap(pt_first, pt_second);

    assert_true(basic_string_size(pt_first) == t_secondsize);
    assert_true(basic_string_capacity(pt_first) == t_secondcapacity);
    assert_true(basic_string_size(pt_second) == t_firstsize);
    assert_true(basic_string_capacity(pt_second) == t_firstcapacity);
    for(i = 0; i < basic_string_size(pt_first); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_first, i) == 100);
    }
    for(i = 0; i < basic_string_size(pt_second); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_second, i) == 0);
    }

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

void test_basic_string_swap__1000_swap_1010(void** state)
{
    basic_string_t* pt_first = create_basic_string(int);
    basic_string_t* pt_second = create_basic_string(int);
    size_t t_firstsize = 0;
    size_t t_firstcapacity = 0;
    size_t t_secondsize = 0;
    size_t t_secondcapacity = 0;
    size_t i = 0;

    basic_string_init_elem(pt_first, 1000, 0);
    basic_string_init_elem(pt_second, 1010, 100);

    t_firstsize = basic_string_size(pt_first);
    t_firstcapacity = basic_string_capacity(pt_first);
    t_secondsize = basic_string_size(pt_second);
    t_secondcapacity = basic_string_capacity(pt_second);
    basic_string_swap(pt_first, pt_second);

    assert_true(basic_string_size(pt_first) == t_secondsize);
    assert_true(basic_string_capacity(pt_first) == t_secondcapacity);
    assert_true(basic_string_size(pt_second) == t_firstsize);
    assert_true(basic_string_capacity(pt_second) == t_firstcapacity);
    for(i = 0; i < basic_string_size(pt_first); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_first, i) == 100);
    }
    for(i = 0; i < basic_string_size(pt_second); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_second, i) == 0);
    }

    basic_string_destroy(pt_first);
    basic_string_destroy(pt_second);
}

/*
 * test basic_string_reserve
 */
UT_CASE_DEFINATION(basic_string_reserve)
void test_basic_string_reserve__null_basic_string_container(void** state)
{
    expect_assert_failure(basic_string_reserve(NULL, 100));
}

void test_basic_string_reserve__non_inited(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_reserve(pt_basic_string, 100));    

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_reserve__max_size(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 100, 0);
    expect_assert_failure(basic_string_reserve(pt_basic_string, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_reserve__shrink(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 100, 0);
    assert_true(basic_string_capacity(pt_basic_string) == 100);
    basic_string_reserve(pt_basic_string, 0);
    assert_true(basic_string_capacity(pt_basic_string) == 100);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_reserve__not_change(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 100, 0);
    assert_true(basic_string_capacity(pt_basic_string) == 100);
    basic_string_reserve(pt_basic_string, 100);
    assert_true(basic_string_capacity(pt_basic_string) == 100);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_reserve__expand(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 100, 0);
    assert_true(basic_string_capacity(pt_basic_string) == 100);
    basic_string_reserve(pt_basic_string, 850);
    assert_true(basic_string_capacity(pt_basic_string) == 850);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_reserve__shared(void** state)
{
    basic_string_t* pbstr1 = create_basic_string(int);
    basic_string_t* pbstr2 = create_basic_string(int);

    basic_string_init_elem(pbstr1, 100, 0);
    basic_string_init_copy(pbstr2, pbstr1);

    assert_true(basic_string_capacity(pbstr1) == 100);
    assert_true(pbstr1->_pby_string == pbstr2->_pby_string);
    basic_string_reserve(pbstr2, 150);
    assert_true(basic_string_capacity(pbstr1) == 100);
    assert_true(basic_string_capacity(pbstr2) == 200);
    assert_true(basic_string_size(pbstr2) == 100);
    assert_true(pbstr1->_pby_string != pbstr2->_pby_string);

    basic_string_destroy(pbstr1);
    basic_string_destroy(pbstr2);
}

/*
 * test basic_string_assign
 */
UT_CASE_DEFINATION(basic_string_assign)
void test_basic_string_assign__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_assign(NULL, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign__null_src(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_assign(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_src);
    pt_dest->_vec_base._pby_finish = (_byte_t*)0x22;

    expect_assert_failure(basic_string_assign(pt_dest, pt_src));

    pt_dest->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_assign__non_inited_src(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    pt_src->_vec_base._pby_finish = (_byte_t*)0x22;

    expect_assert_failure(basic_string_assign(pt_dest, pt_src));

    pt_src->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_assign__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    expect_assert_failure(basic_string_assign(pt_dest, pt_src));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__same_container(void** state)
{
    basic_string_t* pvec = create_basic_string(int);

    basic_string_init(pvec);

    basic_string_assign(pvec, pvec);
    assert_true(basic_string_size(pvec) == 0);
    assert_true(basic_string_capacity(pvec) == 0);

    basic_string_destroy(pvec);
}

void test_basic_string_assign__0_assign_0(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__0_assign_10(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, 0);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 26);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__0_assign_1000(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 1000, 0);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 1500);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__10_assign_0(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 10, 0);
    basic_string_init(pt_src);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 26);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__10_assign_10_basic_string_equal(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 10, 0);
    basic_string_init_elem(pt_src, 10, 0);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 26);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__10_assign_10_basic_string_not_equal(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 10, 100);
    basic_string_init_elem(pt_src, 10, 0);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 26);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__10_assign_1000(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 10, 100);
    basic_string_init_elem(pt_src, 1000, 0);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 1500);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__1000_assign_0(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 1000, 100);
    basic_string_init(pt_src);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 1500);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__1000_assign_10(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 1000, 100);
    basic_string_init_elem(pt_src, 10, 0);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 1500);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__1000_assign_1010(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 1000, 100);
    basic_string_init_elem(pt_src, 1010, 0);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 1500);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__1000_assign_1810(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 1000, 100);
    basic_string_init_elem(pt_src, 1810, 0);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_capacity(pt_dest) == 2715);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__char(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char);
    basic_string_t* pt_src = create_basic_string(char);

    basic_string_init_cstr(pt_dest, "sslak");
    basic_string_init_cstr(pt_src, "xxxxxxxx");

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_size(pt_dest) == 8);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__cstr(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);

    basic_string_init_elem(pt_dest, 10, "abc");
    basic_string_init_elem(pt_src, 3, "xxxxx");

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_size(pt_dest) == 3);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign__libcstl(void** state)
{
    basic_string_t* pt_dest = create_basic_string(vector_t<int>);
    basic_string_t* pt_src = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_dest, 10, pvec);
    basic_string_init(pt_src);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_assign__user_define
{
    int n_elem;
}_test_basic_string_assign__user_define_t;
void test_basic_string_assign__user_define(void** state)
{
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    _test_basic_string_assign__user_define_t t_elem;

    type_register(_test_basic_string_assign__user_define_t, NULL, NULL, NULL, NULL);
    pt_dest = create_basic_string(_test_basic_string_assign__user_define_t);
    pt_src = create_basic_string(_test_basic_string_assign__user_define_t);
    t_elem.n_elem = 100;
    basic_string_init_elem(pt_dest, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_src, 100, &t_elem);

    basic_string_assign(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));
    assert_true(basic_string_size(pt_dest) == 100);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_assign_substring
 */
UT_CASE_DEFINATION(basic_string_assign_substring)
void test_basic_string_assign_substring__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_assign_substring(NULL, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_substring__null_src(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_assign_substring(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_substring__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    pt_dest->_vec_base._pby_finish = (_byte_t*)0x732;
    basic_string_init_elem(pt_src, 10, 100);
    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, 0, NPOS));

    pt_dest->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_assign_substring__non_inited_src(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    pt_src->_vec_base._pby_finish = (_byte_t*)0x732;
    basic_string_init_elem(pt_dest, 10, 100);
    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, 0, NPOS));

    pt_src->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_assign_substring__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);
    basic_string_init_elem(pt_src, 10, 100);
    basic_string_init(pt_dest);

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, 0, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_begin_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, 100);

    basic_string_assign_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);
    assert_true(basic_string_capacity(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_begin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 2, 9999);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == basic_string_length(pt_src));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 87, 1000);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == basic_string_length(pt_src));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 10, 100);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 0);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 1, 100);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, 4);
    assert_true(basic_string_size(pt_dest) == 4);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_middle_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, basic_string_length(pt_src)-3);
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 100, 4566);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_end(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_c_builtin_src_non_empty_npos(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_begin_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, "abcdefg");

    basic_string_assign_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);
    assert_true(basic_string_capacity(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_begin_non_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_assign_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "hij") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_begin_length(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_dest, 3, "xxxx");
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_assign_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 5);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 3), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 4), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_begin_npos(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_dest, 100, "xxxx");
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_assign_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 5);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 3), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 4), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_middle_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_dest, 99, "xxxx");
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_assign_substring(pt_dest, pt_src, 2, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_middle_non_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_assign_substring(pt_dest, pt_src, 2, 2);
    assert_true(basic_string_size(pt_dest) == 2);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "klm") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_middle_length(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_dest, 100, "xxxx");
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_assign_substring(pt_dest, pt_src, 2, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_middle_npos(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_assign_substring(pt_dest, pt_src, 2, NPOS);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_end(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, basic_string_length(pt_src), 0));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstr_src_non_empty_npos(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, NPOS, 0));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_src_non_empty_begin_empty(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init_elem(pt_dest, 99, pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, 2);
    assert_true(basic_string_size(pt_dest) == 2);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_non_empty_begin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init_elem(pt_dest, 2, pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init_elem(pt_dest, 100, pt_elem);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_non_empty_middle_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_substring__successfully_cstl_builtin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

typedef struct _tag_test_basic_string_assign_substring__successfully_user_define
{
    int n_elem;
}_test_basic_string_assign_substring__successfully_user_define_t;
void test_basic_string_assign_substring__successfully_user_define_non_empty_begin_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    type_register(_test_basic_string_assign_substring__successfully_user_define_t, NULL, NULL, NULL, NULL);
    pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init_elem(pt_dest, 3, &t_user);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_assign_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_begin_length(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_assign_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init_elem(pt_dest, 123, &t_user);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_assign_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_assign_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_assign_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_middle_length(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_assign_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_assign_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_assign_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_end(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_substring__successfully_user_define_non_empty_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_assign_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_assign_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    expect_assert_failure(basic_string_assign_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_assign_range
 */
UT_CASE_DEFINATION(basic_string_assign_range)
void test_basic_string_assign_range__null_dest(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt);
    it_begin = basic_string_begin(pt);
    it_end = basic_string_end(pt);

    expect_assert_failure(basic_string_assign_range(NULL, it_begin, it_end));

    basic_string_destroy(pt);
}

void test_basic_string_assign_range__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    pt_dest->_vec_base._pby_finish = (_byte_t*)0x987;
    expect_assert_failure(basic_string_assign_range(pt_dest, it_begin, it_end));

    pt_dest->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_assign_range__invalid_begin_iterator(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    it_begin._t_iteratortype = 23445;
    expect_assert_failure(basic_string_assign_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_range__invalid_end_iterator(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    it_end._t_containertype = 9999;
    expect_assert_failure(basic_string_assign_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_range__invalid_range(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    expect_assert_failure(basic_string_assign_range(pt_dest, it_end, it_begin));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_range__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    expect_assert_failure(basic_string_assign_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_range__successfully_empty_range(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_dest, 22, 900);
    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    basic_string_assign_range(pt_dest, it_begin, it_begin);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_range__successfully_c_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }
    it_begin = iterator_next_n(basic_string_begin(pt_src), 3);
    it_end = iterator_next_n(it_begin, 5);

    basic_string_assign_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_range__successfully_cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_dest, 10, "xxxx");
    basic_string_init_elem(pt_src, 100, "abcdefg");
    it_begin = basic_string_begin(pt_src);
    it_end = iterator_next_n(it_begin, 10);

    basic_string_assign_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(strcmp((char*)basic_string_at(pt_dest, i), "abcdefg") == 0);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_assign_range__successfully_cstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    list_init(pt_elem);
    basic_string_init_elem(pt_dest, 1000, pt_elem);
    list_assign_elem(pt_elem, 18, 23);
    basic_string_init_elem(pt_src, 1004, pt_elem);

    it_begin = iterator_next_n(basic_string_begin(pt_src), 100);
    it_end = basic_string_end(pt_src);

    basic_string_assign_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(list_equal((list_t*)basic_string_at(pt_dest, i), pt_elem));
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_assign_range__successfully_user_define(void** state)
{
    typedef struct _tag_test_basic_string_assign_range__successfully_user_define
    {
        int n_elem;
    }_test_basic_string_assign_range__successfully_user_define_t;

    size_t i = 0;
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;
    _test_basic_string_assign_range__successfully_user_define_t t_user;

    type_register(_test_basic_string_assign_range__successfully_user_define_t, NULL, NULL, NULL, NULL);

    pt_dest = create_basic_string(_test_basic_string_assign_range__successfully_user_define_t);
    pt_src = create_basic_string(_test_basic_string_assign_range__successfully_user_define_t);

    t_user.n_elem = 1;
    basic_string_init_elem(pt_dest, 1, &t_user);
    t_user.n_elem = 28743;
    basic_string_init_elem(pt_src, 10000, &t_user);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    basic_string_assign_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(memcmp((_test_basic_string_assign_range__successfully_user_define_t*)basic_string_at(pt_dest, i),
            &t_user, sizeof(t_user)) == 0);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_assign_cstr
 */
UT_CASE_DEFINATION(basic_string_assign_cstr)
void test_basic_string_assign_cstr__null_container(void** state)
{
    expect_assert_failure(basic_string_assign_cstr(NULL, "abcdef"));
}

void test_basic_string_assign_cstr__non_inited(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x9999;
    expect_assert_failure(basic_string_assign_cstr(pt_basic_string, "abcdefg"));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_assign_cstr__null_valuestring(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_assign_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    basic_string_assign_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__c_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init_elem(pt_basic_string, 30, 100);
    basic_string_assign_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);
    assert_true(*(int*)basic_string_at(pt_basic_string, 2) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefg");
    basic_string_assign_cstr(pt_basic_string, "");
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__char_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_elem(pt_basic_string, 1, 'x');
    basic_string_assign_cstr(pt_basic_string, "abc");
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(*(char*)basic_string_at(pt_basic_string, 0) == 'a');
    assert_true(*(char*)basic_string_at(pt_basic_string, 1) == 'b');
    assert_true(*(char*)basic_string_at(pt_basic_string, 2) == 'c');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    basic_string_assign_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__cstr_init_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_assign_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "hij") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    basic_string_assign_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__libcstl_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init(pt_basic_string);
    basic_string_assign_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_assign_cstr__user_define
{
    int n_elem;
    double d_elem;
}_test_basic_string_assign_cstr__user_define_t;
void test_basic_string_assign_cstr__user_define_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_assign_cstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_assign_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_assign_cstr__user_define_t);

    basic_string_init(pt_basic_string);
    basic_string_assign_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_cstr__user_define_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_assign_cstr__user_define_t);
    _test_basic_string_assign_cstr__user_define_t t_user1;
    _test_basic_string_assign_cstr__user_define_t t_user2;
    _test_basic_string_assign_cstr__user_define_t* elems[5] = {&t_user1, &t_user2, &t_user2, NULL, &t_user1};

    t_user1.n_elem = 4;
    t_user1.d_elem = 9.4;
    t_user2.n_elem = 0;
    t_user2.d_elem = 0.0;
    basic_string_init(pt_basic_string);
    basic_string_assign_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(((_test_basic_string_assign_cstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_assign_cstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 9.4);
    assert_true(((_test_basic_string_assign_cstr__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 0);
    assert_true(((_test_basic_string_assign_cstr__user_define_t*)basic_string_at(pt_basic_string, 1))->d_elem == 0.0);
    assert_true(((_test_basic_string_assign_cstr__user_define_t*)basic_string_at(pt_basic_string, 2))->n_elem == 0);
    assert_true(((_test_basic_string_assign_cstr__user_define_t*)basic_string_at(pt_basic_string, 2))->d_elem == 0.0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_assign_subcstr
 */
UT_CASE_DEFINATION(basic_string_assign_subcstr)
void test_basic_string_assign_subcstr__null_container(void** state)
{
    expect_assert_failure(basic_string_assign_subcstr(NULL, "abcdef", 0));
}

void test_basic_string_assign_subcstr__non_created_container(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x78773;
    expect_assert_failure(basic_string_assign_subcstr(pt_basic_string, "abcdefg", NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_assign_subcstr__null_valuestring(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_assign_subcstr(pt_basic_string, NULL, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init(pt_basic_string);
    basic_string_assign_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__c_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init(pt_basic_string);
    basic_string_assign_subcstr(pt_basic_string, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__c_builtin_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init(pt_basic_string);
    basic_string_assign_subcstr(pt_basic_string, elems, 3);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);
    assert_true(*(int*)basic_string_at(pt_basic_string, 2) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_assign_subcstr(pt_basic_string, "abc", 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__char_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_assign_subcstr(pt_basic_string, "abc", 1);
    assert_true(basic_string_size(pt_basic_string) == 1);
    assert_true(*(char*)basic_string_at(pt_basic_string, 0) == 'a');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__char_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_assign_subcstr(pt_basic_string, "abc", 100);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(*(char*)basic_string_at(pt_basic_string, 0) == 'a');
    assert_true(*(char*)basic_string_at(pt_basic_string, 1) == 'b');
    assert_true(*(char*)basic_string_at(pt_basic_string, 2) == 'c');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_assign_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__cstr_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_assign_subcstr(pt_basic_string, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__cstr_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_assign_subcstr(pt_basic_string, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "hij") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init(pt_basic_string);
    basic_string_assign_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_assign_subcstr__libcstl_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init(pt_basic_string);
    basic_string_assign_subcstr(pt_basic_string, elems, 1);
    assert_true(basic_string_size(pt_basic_string) == 1);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_assign_subcstr__libcstl_builtin_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init(pt_basic_string);
    basic_string_assign_subcstr(pt_basic_string, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_assign_subcstr__user_define
{
    int n_elem;
    double d_elem;
}_test_basic_string_assign_subcstr__user_define_t;
void test_basic_string_assign_subcstr__user_define_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_assign_subcstr__user_define_t t_user;
    _test_basic_string_assign_subcstr__user_define_t* elems[5] = {&t_user, &t_user, &t_user, NULL, &t_user};

    type_register(_test_basic_string_assign_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_assign_subcstr__user_define_t);

    basic_string_init_elem(pt_basic_string, 100, &t_user);
    basic_string_assign_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__user_define_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_assign_subcstr__user_define_t);
    _test_basic_string_assign_subcstr__user_define_t t_user;
    _test_basic_string_assign_subcstr__user_define_t* elems[5] = {&t_user, &t_user, &t_user, NULL, &t_user};

    basic_string_init_elem(pt_basic_string, 100, &t_user);
    t_user.n_elem = 4;
    t_user.d_elem = 0.0;
    basic_string_assign_subcstr(pt_basic_string, elems, 1);
    assert_true(basic_string_size(pt_basic_string) == 1);
    assert_true(((_test_basic_string_assign_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_assign_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 0.0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_assign_subcstr__user_define_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_assign_subcstr__user_define_t);
    _test_basic_string_assign_subcstr__user_define_t t_user1;
    _test_basic_string_assign_subcstr__user_define_t t_user2;
    _test_basic_string_assign_subcstr__user_define_t t_user3;
    _test_basic_string_assign_subcstr__user_define_t* elems[5] = {&t_user1, &t_user2, &t_user3, NULL, &t_user1};

    basic_string_init_elem(pt_basic_string, 100, &t_user1);
    t_user1.n_elem = 4; t_user1.d_elem = 0.0;
    t_user2.n_elem = 0; t_user2.d_elem = 9.24;
    t_user3.n_elem = 0; t_user3.d_elem = 0.0;
    basic_string_assign_subcstr(pt_basic_string, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(((_test_basic_string_assign_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_assign_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 0.0);
    assert_true(((_test_basic_string_assign_subcstr__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 0);
    assert_true(((_test_basic_string_assign_subcstr__user_define_t*)basic_string_at(pt_basic_string, 1))->d_elem == 9.24);
    assert_true(((_test_basic_string_assign_subcstr__user_define_t*)basic_string_at(pt_basic_string, 2))->n_elem == 0);
    assert_true(((_test_basic_string_assign_subcstr__user_define_t*)basic_string_at(pt_basic_string, 2))->d_elem == 0.0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_append
 */
UT_CASE_DEFINATION(basic_string_append)
void test_basic_string_append__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_append(NULL, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append__null_src(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_append(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_src);
    pt_dest->_vec_base._pby_finish = (_byte_t*)0x22;

    expect_assert_failure(basic_string_append(pt_dest, pt_src));

    pt_dest->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_append__non_inited_src(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    pt_src->_vec_base._pby_finish = (_byte_t*)0x22;

    expect_assert_failure(basic_string_append(pt_dest, pt_src));

    pt_src->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_append__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    expect_assert_failure(basic_string_append(pt_dest, pt_src));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append__same_container(void** state)
{
    basic_string_t* pvec = create_basic_string(int);

    basic_string_init_elem(pvec, 10, 100);

    basic_string_append(pvec, pvec);
    assert_true(basic_string_size(pvec) == 20);

    basic_string_destroy(pvec);
}

void test_basic_string_append__0_assign_0(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    basic_string_append(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append__0_assign_10(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, 0);

    basic_string_append(pt_dest, pt_src);
    assert_true(basic_string_equal(pt_dest, pt_src));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append__10_assign_0(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 10, 0);
    basic_string_init(pt_src);

    basic_string_append(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 10);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append__1000_assign_1810(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 1000, 100);
    basic_string_init_elem(pt_src, 1810, 0);

    basic_string_append(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 2810);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 1000)
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append__char(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char);
    basic_string_t* pt_src = create_basic_string(char);

    basic_string_init_cstr(pt_dest, "sslak");
    basic_string_init_cstr(pt_src, "xxxxxxxx");

    basic_string_append(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 13);
    assert_true(strncmp((char*)basic_string_c_str(pt_dest), "sslakxxxxxxxx", 13) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);

    basic_string_init_elem(pt_dest, 10, "abc");
    basic_string_init_elem(pt_src, 3, "xxxxx");

    basic_string_append(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 13);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 10)
        {
            assert_true(strncmp((char*)basic_string_at(pt_dest, i), "abc", 3) == 0);
        }
        else
        {
            assert_true(strncmp((char*)basic_string_at(pt_dest, i), "xxxxx", 5) == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append__libcstl(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(vector_t<int>);
    basic_string_t* pt_src = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_dest, 10, pvec);
    vector_resize(pvec, 10);
    basic_string_init_elem(pt_src, 10, pvec);

    basic_string_append(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 20);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 10)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_dest, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_dest, i)) == 10);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_append__user_define
{
    int n_elem;
}_test_basic_string_append__user_define_t;
void test_basic_string_append__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    _test_basic_string_append__user_define_t t_elem;

    type_register(_test_basic_string_append__user_define_t, NULL, NULL, NULL, NULL);
    pt_dest = create_basic_string(_test_basic_string_append__user_define_t);
    pt_src = create_basic_string(_test_basic_string_append__user_define_t);
    t_elem.n_elem = 100;
    basic_string_init_elem(pt_dest, 10, &t_elem);
    t_elem.n_elem = 0;
    basic_string_init_elem(pt_src, 100, &t_elem);

    basic_string_append(pt_dest, pt_src);
    assert_true(basic_string_size(pt_dest) == 110);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 10)
        {
            assert_true(((_test_basic_string_append__user_define_t*)basic_string_at(pt_dest, i))->n_elem == 100);
        }
        else
        {
            assert_true(((_test_basic_string_append__user_define_t*)basic_string_at(pt_dest, i))->n_elem == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_append_substring
 */
UT_CASE_DEFINATION(basic_string_append_substring)
void test_basic_string_append_substring__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_append_substring(NULL, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_substring__null_src(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    expect_assert_failure(basic_string_append_substring(pt_basic_string, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_substring__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    pt_dest->_vec_base._pby_finish = (_byte_t*)0x732;
    basic_string_init_elem(pt_src, 10, 100);
    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, 0, NPOS));

    pt_dest->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_append_substring__non_inited_src(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    pt_src->_vec_base._pby_finish = (_byte_t*)0x732;
    basic_string_init_elem(pt_dest, 10, 100);
    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, 0, NPOS));

    pt_src->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_append_substring__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);
    basic_string_init_elem(pt_src, 10, 100);
    basic_string_init(pt_dest);

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, 0, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_begin_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, 100);

    basic_string_append_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_append_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_begin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 2, 9999);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_append_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 12);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 2)
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 9999);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == i - 2);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 87, 1000);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_append_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 97);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 87)
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 1000);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == i - 87);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 10, 100);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == 100);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 1, 100);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, 4);
    assert_true(basic_string_size(pt_dest) == 5);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 1)
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3 - 1);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_middle_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, basic_string_length(pt_src)-3);
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init_elem(pt_dest, 100, 4566);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 107);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 100)
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 4566);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3 - 100);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_end(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_c_builtin_src_non_empty_npos(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_begin_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, "abcdefg");

    basic_string_append_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_begin_non_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_append_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "hij") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_begin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_dest, 3, "xxxx");
    basic_string_init_elem(pt_src, 5, "abc");

    basic_string_append_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 8);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 3)
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "xxxx") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "abc") == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_dest, 100, "xxxx");
    basic_string_init_elem(pt_src, 5, "abc");

    basic_string_append_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 105);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 100)
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "xxxx") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "abc") == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_dest, 99, "xxxx");
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_append_substring(pt_dest, pt_src, 2, 0);
    assert_true(basic_string_size(pt_dest) == 99);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(strcmp((char*)basic_string_at(pt_dest, i), "xxxx") == 0);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_middle_non_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_append_substring(pt_dest, pt_src, 2, 2);
    assert_true(basic_string_size(pt_dest) == 2);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "klm") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_middle_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init_elem(pt_dest, 100, "xxxx");
    basic_string_init_elem(pt_src, 5, "abc");

    basic_string_append_substring(pt_dest, pt_src, 2, 3);
    assert_true(basic_string_size(pt_dest) == 103);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 100)
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "xxxx") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "abc") == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_middle_npos(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    basic_string_append_substring(pt_dest, pt_src, 2, NPOS);
    assert_true(basic_string_size(pt_dest) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 0), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 1), "klm") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_dest, 2), "nop") == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_end(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, basic_string_length(pt_src), 0));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstr_src_non_empty_npos(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_push_back(pt_src, "abc");
    basic_string_push_back(pt_src, "def");
    basic_string_push_back(pt_src, "hij");
    basic_string_push_back(pt_src, "klm");
    basic_string_push_back(pt_src, "nop");

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, NPOS, 0));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_cstl_builtin_src_non_empty_begin_empty(void** state)
{
    int i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_append_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init_elem(pt_dest, 99, pt_elem);
    list_push_back(pt_elem, 100);
    basic_string_init_elem(pt_src, 10, pt_elem);

    basic_string_append_substring(pt_dest, pt_src, 0, 2);
    assert_true(basic_string_size(pt_dest) == 101);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 99)
        {
            assert_true(list_size((list_t*)basic_string_at(pt_dest, i)) == 0);
        }
        else
        {
            assert_true(list_size((list_t*)basic_string_at(pt_dest, i)) == 1);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_non_empty_begin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_append_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init_elem(pt_dest, 2, pt_elem);
    list_push_back(pt_elem, 100);
    basic_string_init_elem(pt_src, 10, pt_elem);

    basic_string_append_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 12);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 2)
        {
            assert_true(list_size((list_t*)basic_string_at(pt_dest, i)) == 0);
        }
        else
        {
            assert_true(list_size((list_t*)basic_string_at(pt_dest, i)) == 1);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init_elem(pt_dest, 100, pt_elem);
    list_push_back(pt_elem, 100);
    basic_string_init_elem(pt_src, 10, pt_elem);

    basic_string_append_substring(pt_dest, pt_src, 3, 3);
    assert_true(basic_string_size(pt_dest) == 103);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 100)
        {
            assert_true(list_size((list_t*)basic_string_at(pt_dest, i)) == 0);
        }
        else
        {
            assert_true(list_size((list_t*)basic_string_at(pt_dest, i)) == 1);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_non_empty_middle_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)list_front((list_t*)basic_string_at(pt_dest, i)) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_length(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_substring__successfully_cstl_builtin_npos(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    list_init(pt_elem);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);

    for(i = 0; i < 10; ++i)
    {
        list_clear(pt_elem);
        list_push_back(pt_elem, i);
        basic_string_push_back(pt_src, pt_elem);
    }

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

typedef struct _tag_test_basic_string_append_substring__successfully_user_define
{
    int n_elem;
}_test_basic_string_append_substring__successfully_user_define_t;
void test_basic_string_append_substring__successfully_user_define_non_empty_begin_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    type_register(_test_basic_string_append_substring__successfully_user_define_t, NULL, NULL, NULL, NULL);
    pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_append_substring(pt_dest, pt_src, 0, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_begin_non_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_dest, 3, &t_user);
    t_user.n_elem = -99;
    basic_string_init_elem(pt_src, 10, &t_user);

    basic_string_append_substring(pt_dest, pt_src, 0, 3);
    assert_true(basic_string_size(pt_dest) == 6);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 3)
        {
            assert_true(((_test_basic_string_append_substring__successfully_user_define_t*)
                basic_string_at(pt_dest, i))->n_elem == 100);
        }
        else
        {
            assert_true(((_test_basic_string_append_substring__successfully_user_define_t*)
                basic_string_at(pt_dest, i))->n_elem == -99);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_begin_length(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_append_substring(pt_dest, pt_src, 0, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_append_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_begin_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    t_user.n_elem = 345;
    basic_string_init_elem(pt_dest, 123, &t_user);
    t_user.n_elem = 1000;
    basic_string_init_elem(pt_src, 10, &t_user);

    basic_string_append_substring(pt_dest, pt_src, 0, NPOS);
    assert_true(basic_string_size(pt_dest) == 133);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 123)
        {
            assert_true(((_test_basic_string_append_substring__successfully_user_define_t*)
                basic_string_at(pt_dest, i))->n_elem == 345);
        }
        else
        {
            assert_true(((_test_basic_string_append_substring__successfully_user_define_t*)
                basic_string_at(pt_dest, i))->n_elem == 1000);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_middle_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, 0);
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_middle_non_empty(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, 3);
    assert_true(basic_string_size(pt_dest) == 3);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_append_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_middle_length(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, basic_string_length(pt_src));
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_append_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_middle_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    basic_string_append_substring(pt_dest, pt_src, 3, NPOS);
    assert_true(basic_string_size(pt_dest) == 7);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(((_test_basic_string_append_substring__successfully_user_define_t*)
            basic_string_at(pt_dest, i))->n_elem == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_end(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, basic_string_length(pt_src), NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_substring__successfully_user_define_non_empty_npos(void** state)
{
    size_t i = 0;
    _test_basic_string_append_substring__successfully_user_define_t t_user;
    basic_string_t* pt_dest = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_t* pt_src = create_basic_string(_test_basic_string_append_substring__successfully_user_define_t);
    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_src, &t_user);
    }

    expect_assert_failure(basic_string_append_substring(pt_dest, pt_src, NPOS, NPOS));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_append_range
 */
UT_CASE_DEFINATION(basic_string_append_range)
void test_basic_string_append_range__null_dest(void** state)
{
    basic_string_t* pt = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt);
    it_begin = basic_string_begin(pt);
    it_end = basic_string_end(pt);

    expect_assert_failure(basic_string_append_range(NULL, it_begin, it_end));

    basic_string_destroy(pt);
}

void test_basic_string_append_range__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    pt_dest->_vec_base._pby_finish = (_byte_t*)0x987;
    expect_assert_failure(basic_string_append_range(pt_dest, it_begin, it_end));

    pt_dest->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_append_range__invalid_begin_iterator(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    it_begin._t_iteratortype = 23445;
    expect_assert_failure(basic_string_append_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_range__invalid_end_iterator(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    it_end._t_containertype = 9999;
    expect_assert_failure(basic_string_append_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_range__invalid_range(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    expect_assert_failure(basic_string_append_range(pt_dest, it_end, it_begin));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_range__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    expect_assert_failure(basic_string_append_range(pt_dest, it_begin, it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_range__successfully_empty_range(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_dest, 22, 900);
    basic_string_init_elem(pt_src, 19, 323);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    basic_string_append_range(pt_dest, it_begin, it_begin);
    assert_true(basic_string_size(pt_dest) == 22);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == 900);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_range__successfully_c_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_src, i);
    }
    it_begin = iterator_next_n(basic_string_begin(pt_src), 3);
    it_end = iterator_next_n(it_begin, 5);

    basic_string_append_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == iterator_distance(it_begin, it_end));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == i + 3);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_range__successfully_cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_dest, 10, "xxxx");
    basic_string_init_elem(pt_src, 100, "abcdefg");
    it_begin = basic_string_begin(pt_src);
    it_end = iterator_next_n(it_begin, 10);

    basic_string_append_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == 10 + iterator_distance(it_begin, it_end));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 10)
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "xxxx") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "abcdefg") == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_append_range__successfully_cstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(list_t<int>);
    basic_string_t* pt_src = create_basic_string(list_t<int>);
    list_t* pt_elem = create_list(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    list_init(pt_elem);
    basic_string_init_elem(pt_dest, 1000, pt_elem);
    list_assign_elem(pt_elem, 18, 23);
    basic_string_init_elem(pt_src, 1004, pt_elem);

    it_begin = iterator_next_n(basic_string_begin(pt_src), 100);
    it_end = basic_string_end(pt_src);

    basic_string_append_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == 1000 + iterator_distance(it_begin, it_end));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 1000)
        {
            assert_true(list_size((list_t*)basic_string_at(pt_dest, i)) == 0);
        }
        else
        {
            assert_true(list_size((list_t*)basic_string_at(pt_dest, i)) == 18);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    list_destroy(pt_elem);
}

void test_basic_string_append_range__successfully_user_define(void** state)
{
    typedef struct _tag_test_basic_string_append_range__successfully_user_define
    {
        int n_elem;
    }_test_basic_string_append_range__successfully_user_define_t;

    size_t i = 0;
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;
    _test_basic_string_append_range__successfully_user_define_t t_user;

    type_register(_test_basic_string_append_range__successfully_user_define_t, NULL, NULL, NULL, NULL);

    pt_dest = create_basic_string(_test_basic_string_append_range__successfully_user_define_t);
    pt_src = create_basic_string(_test_basic_string_append_range__successfully_user_define_t);

    t_user.n_elem = 1;
    basic_string_init_elem(pt_dest, 1, &t_user);
    t_user.n_elem = 28743;
    basic_string_init_elem(pt_src, 10000, &t_user);
    it_begin = basic_string_begin(pt_src);
    it_end = basic_string_end(pt_src);

    basic_string_append_range(pt_dest, it_begin, it_end);
    assert_true(basic_string_size(pt_dest) == 1 + iterator_distance(it_begin, it_end));
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 1)
        {
            assert_true(((_test_basic_string_append_range__successfully_user_define_t*)
                basic_string_at(pt_dest, i))->n_elem == 1);
        }
        else
        {
            assert_true(((_test_basic_string_append_range__successfully_user_define_t*)
                basic_string_at(pt_dest, i))->n_elem == 28743);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
void test_basic_string_append_range__same_container(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_basic_string, 22, 900);
    it_begin = basic_string_begin(pt_basic_string);
    it_end = basic_string_end(pt_basic_string);

    basic_string_append_range(pt_basic_string, it_begin, it_end);
    assert_true(basic_string_size(pt_basic_string) == 44);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 900);
    }

    basic_string_destroy(pt_basic_string);
}
*/

/*
 * test basic_string_append_cstr
 */
UT_CASE_DEFINATION(basic_string_append_cstr)
void test_basic_string_append_cstr__null_container(void** state)
{
    expect_assert_failure(basic_string_append_cstr(NULL, "abcdef"));
}

void test_basic_string_append_cstr__non_inited(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x9999;
    expect_assert_failure(basic_string_append_cstr(pt_basic_string, "abcdefg"));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_append_cstr__null_valuestring(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_append_cstr(pt_basic_string, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init(pt_basic_string);
    basic_string_append_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__c_builtin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 9, 9, 0, 13, 5455};

    basic_string_init_elem(pt_basic_string, 30, 100);
    basic_string_append_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 33);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 30)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 9);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefg");
    basic_string_append_cstr(pt_basic_string, "");
    assert_true(basic_string_size(pt_basic_string) == 7);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__char_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_elem(pt_basic_string, 1, 'x');
    basic_string_append_cstr(pt_basic_string, "abc");
    assert_true(basic_string_size(pt_basic_string) == 4);
    assert_true(*(char*)basic_string_at(pt_basic_string, 0) == 'x');
    assert_true(*(char*)basic_string_at(pt_basic_string, 1) == 'a');
    assert_true(*(char*)basic_string_at(pt_basic_string, 2) == 'b');
    assert_true(*(char*)basic_string_at(pt_basic_string, 3) == 'c');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    basic_string_append_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__cstr_init_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_append_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 6);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 3), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 4), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 5), "hij") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* elems[] = {NULL};

    basic_string_init(pt_basic_string);
    basic_string_append_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__libcstl_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init(pt_basic_string);
    basic_string_append_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_append_cstr__user_define
{
    int n_elem;
    double d_elem;
}_test_basic_string_append_cstr__user_define_t;
void test_basic_string_append_cstr__user_define_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_append_cstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_append_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_append_cstr__user_define_t);

    basic_string_init(pt_basic_string);
    basic_string_append_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_cstr__user_define_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_append_cstr__user_define_t);
    _test_basic_string_append_cstr__user_define_t t_user1;
    _test_basic_string_append_cstr__user_define_t t_user2;
    _test_basic_string_append_cstr__user_define_t* elems[5] = {&t_user1, &t_user2, &t_user2, NULL, &t_user1};

    t_user1.n_elem = 4;
    t_user1.d_elem = 9.4;
    t_user2.n_elem = 0;
    t_user2.d_elem = 0.0;
    basic_string_init_elem(pt_basic_string, 1, &t_user1);
    basic_string_append_cstr(pt_basic_string, elems);
    assert_true(basic_string_size(pt_basic_string) == 4);
    assert_true(((_test_basic_string_append_cstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_append_cstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 9.4);
    assert_true(((_test_basic_string_append_cstr__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 4);
    assert_true(((_test_basic_string_append_cstr__user_define_t*)basic_string_at(pt_basic_string, 1))->d_elem == 9.4);
    assert_true(((_test_basic_string_append_cstr__user_define_t*)basic_string_at(pt_basic_string, 2))->n_elem == 0);
    assert_true(((_test_basic_string_append_cstr__user_define_t*)basic_string_at(pt_basic_string, 2))->d_elem == 0.0);
    assert_true(((_test_basic_string_append_cstr__user_define_t*)basic_string_at(pt_basic_string, 3))->n_elem == 0);
    assert_true(((_test_basic_string_append_cstr__user_define_t*)basic_string_at(pt_basic_string, 3))->d_elem == 0.0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_append_subcstr
 */
UT_CASE_DEFINATION(basic_string_append_subcstr)
void test_basic_string_append_subcstr__null_container(void** state)
{
    expect_assert_failure(basic_string_append_subcstr(NULL, "abcdef", 0));
}

void test_basic_string_append_subcstr__non_created_container(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x78773;
    expect_assert_failure(basic_string_append_subcstr(pt_basic_string, "abcdefg", NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_append_subcstr__null_valuestring(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_append_subcstr(pt_basic_string, NULL, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init(pt_basic_string);
    basic_string_append_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__c_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init(pt_basic_string);
    basic_string_append_subcstr(pt_basic_string, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__c_builtin_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init(pt_basic_string);
    basic_string_append_subcstr(pt_basic_string, elems, 3);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);
    assert_true(*(int*)basic_string_at(pt_basic_string, 2) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_append_subcstr(pt_basic_string, "abc", 0);
    assert_true(basic_string_size(pt_basic_string) == 10);
    assert_true(strncmp((char*)basic_string_c_str(pt_basic_string), "xxxxxxxxxx", 10) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__char_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_append_subcstr(pt_basic_string, "abc", 1);
    assert_true(basic_string_size(pt_basic_string) == 11);
    assert_true(strncmp((char*)basic_string_c_str(pt_basic_string), "xxxxxxxxxxa", 11) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__char_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_append_subcstr(pt_basic_string, "abc", 100);
    assert_true(basic_string_size(pt_basic_string) == 13);
    assert_true(strncmp((char*)basic_string_c_str(pt_basic_string), "xxxxxxxxxxabc", 13) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_append_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 1);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__cstr_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_append_subcstr(pt_basic_string, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "xxxxxxxxxx") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "def") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__cstr_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_append_subcstr(pt_basic_string, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 4);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "xxxxxxxxxx") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 3), "hij") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init(pt_basic_string);
    basic_string_append_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_append_subcstr__libcstl_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init(pt_basic_string);
    basic_string_append_subcstr(pt_basic_string, elems, 1);
    assert_true(basic_string_size(pt_basic_string) == 1);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_append_subcstr__libcstl_builtin_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init(pt_basic_string);
    basic_string_append_subcstr(pt_basic_string, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_append_subcstr__user_define
{
    int n_elem;
    double d_elem;
}_test_basic_string_append_subcstr__user_define_t;
void test_basic_string_append_subcstr__user_define_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_append_subcstr__user_define_t t_user;
    _test_basic_string_append_subcstr__user_define_t* elems[5] = {&t_user, &t_user, &t_user, NULL, &t_user};

    type_register(_test_basic_string_append_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_append_subcstr__user_define_t);

    basic_string_init_elem(pt_basic_string, 100, &t_user);
    basic_string_append_subcstr(pt_basic_string, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 100);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__user_define_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_append_subcstr__user_define_t);
    _test_basic_string_append_subcstr__user_define_t t_user;
    _test_basic_string_append_subcstr__user_define_t* elems[5] = {&t_user, &t_user, &t_user, NULL, &t_user};

    t_user.n_elem = 100;
    t_user.d_elem = -0.3;
    basic_string_init_elem(pt_basic_string, 100, &t_user);
    t_user.n_elem = 4;
    t_user.d_elem = 0.0;
    basic_string_append_subcstr(pt_basic_string, elems, 1);
    assert_true(basic_string_size(pt_basic_string) == 101);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 100)
        {
            assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 100);
            assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->d_elem == -0.3);
        }
        else
        {
            assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 4);
            assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->d_elem == 0.0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_append_subcstr__user_define_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_append_subcstr__user_define_t);
    _test_basic_string_append_subcstr__user_define_t t_user1;
    _test_basic_string_append_subcstr__user_define_t t_user2;
    _test_basic_string_append_subcstr__user_define_t t_user3;
    _test_basic_string_append_subcstr__user_define_t* elems[5] = {&t_user1, &t_user2, &t_user3, NULL, &t_user1};

    t_user1.n_elem = 100;
    t_user1.d_elem = 100.0;
    basic_string_init_elem(pt_basic_string, 1, &t_user1);
    t_user1.n_elem = 4; t_user1.d_elem = 0.0;
    t_user2.n_elem = 0; t_user2.d_elem = 9.24;
    t_user3.n_elem = 0; t_user3.d_elem = 0.0;
    basic_string_append_subcstr(pt_basic_string, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 4);
    assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 100);
    assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 100.0);
    assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 4);
    assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, 1))->d_elem == 0.0);
    assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, 2))->n_elem == 0);
    assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, 2))->d_elem == 9.24);
    assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, 3))->n_elem == 0);
    assert_true(((_test_basic_string_append_subcstr__user_define_t*)basic_string_at(pt_basic_string, 3))->d_elem == 0.0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_insert_string
 */
UT_CASE_DEFINATION(basic_string_insert_string)
void test_basic_string_insert_string__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_insert_string(NULL, 0, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_string__null_insert(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_insert_string(pt_basic_string, 0, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_string__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_insert);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_insert_string(pt_basic_string, 0, pt_insert));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
    */
}

void test_basic_string_insert_string__non_inited_insert(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_insert);

    pt_insert->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_insert_string(pt_basic_string, 0, pt_insert));

    pt_insert->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
    */
}

void test_basic_string_insert_string__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(double);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_insert);

    expect_assert_failure(basic_string_insert_string(pt_basic_string, 0, pt_insert));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__same_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_insert_string(pt_basic_string, 0, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_string__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_insert);

    expect_assert_failure(basic_string_insert_string(pt_basic_string, 180, pt_insert));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__c_builtin_begin_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_insert);

    basic_string_insert_string(pt_basic_string, 0, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__c_builtin_middle_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_insert, 5, 200);

    basic_string_insert_string(pt_basic_string, 5, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 9)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 200);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__char_middle_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_insert = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init(pt_insert);

    basic_string_insert_string(pt_basic_string, 4, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__char_begin_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_insert = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init_elem(pt_insert, 5, 'n');

    basic_string_insert_string(pt_basic_string, 0, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'n');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__cstr_middle_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_insert = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "xxxxx");
    basic_string_init(pt_insert);

    basic_string_insert_string(pt_basic_string, 4, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__cstr_begin_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_insert = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "xxxxx");
    basic_string_init_elem(pt_insert, 5, "mn");

    basic_string_insert_string(pt_basic_string, 0, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "mn") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxxxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__libcstl_builtin_middle_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    basic_string_t* pt_insert = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);

    list_init(plist);
    basic_string_init_elem(pt_basic_string, 10, plist);
    basic_string_init(pt_insert);

    basic_string_insert_string(pt_basic_string, 4, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
    list_destroy(plist);
}

void test_basic_string_insert_string__libcstl_builtin_begin_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    basic_string_t* pt_insert = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);

    list_init(plist);
    basic_string_init_elem(pt_basic_string, 10, plist);
    list_push_back(plist, 10);
    basic_string_init_elem(pt_insert, 5, plist);

    basic_string_insert_string(pt_basic_string, 0, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(list_size((list_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
        else
        {
            assert_true(list_size((list_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_insert_string__user_define
{
    int n_elem;
}_test_basic_string_insert_string__user_define_t;
void test_basic_string_insert_string__user_define_middle_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_insert = NULL;
    _test_basic_string_insert_string__user_define_t t_elem;

    type_register(_test_basic_string_insert_string__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_insert_string__user_define_t);
    pt_insert = create_basic_string(_test_basic_string_insert_string__user_define_t);

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);
    basic_string_init(pt_insert);

    basic_string_insert_string(pt_basic_string, 4, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_string__user_define_begin_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_insert_string__user_define_t);
    basic_string_t* pt_insert = create_basic_string(_test_basic_string_insert_string__user_define_t);
    _test_basic_string_insert_string__user_define_t t_elem;

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);
    t_elem.n_elem = 50;
    basic_string_init_elem(pt_insert, 5, &t_elem);

    basic_string_insert_string(pt_basic_string, 0, pt_insert);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(((_test_basic_string_insert_string__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 50);
        }
        else
        {
            assert_true(((_test_basic_string_insert_string__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

/*
 * test basic_string_insert_substring
 */
UT_CASE_DEFINATION(basic_string_insert_substring)
void test_basic_string_insert_substring__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_insert_substring(NULL, 0, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_substring__null_insert(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_insert_substring(pt_basic_string, 0, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_substring__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_insert, 10, 100);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_insert_substring(pt_basic_string, 0, pt_insert, 0, NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
    */
}

void test_basic_string_insert_substring__non_inited_insert(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_insert);

    pt_insert->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_insert_substring(pt_basic_string, 0, pt_insert, 0, NPOS));

    pt_insert->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
    */
}

void test_basic_string_insert_substring__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(double);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_insert, 10, 100);

    expect_assert_failure(basic_string_insert_substring(pt_basic_string, 0, pt_insert, 0, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__same_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_insert_substring(pt_basic_string, 0, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_substring__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_insert, 10, 100);

    expect_assert_failure(basic_string_insert_substring(pt_basic_string, 180, pt_insert, 0, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__invalid_startpos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_insert, 10, 100);

    expect_assert_failure(basic_string_insert_substring(pt_basic_string, 0, pt_insert, 120, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__c_builtin_begin_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_insert, 10, 100);

    basic_string_insert_substring(pt_basic_string, 0, pt_insert, 4, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__c_builtin_middle_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_insert = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_insert, 5, 200);

    basic_string_insert_substring(pt_basic_string, 5, pt_insert, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 9)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 200);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__char_middle_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_insert = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init_elem(pt_insert, 10, 'x');

    basic_string_insert_substring(pt_basic_string, 4, pt_insert, 0, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__char_begin_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_insert = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init_elem(pt_insert, 15, 'n');

    basic_string_insert_substring(pt_basic_string, 0, pt_insert, 5, 5);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'n');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__cstr_middle_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_insert = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "xxxxx");
    basic_string_init_elem(pt_insert, 10, "abcd");

    basic_string_insert_substring(pt_basic_string, 4, pt_insert, 3, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__cstr_begin_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_insert = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "xxxxx");
    basic_string_init_elem(pt_insert, 5, "mn");

    basic_string_insert_substring(pt_basic_string, 0, pt_insert, 0, 239);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "mn") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxxxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__libcstl_builtin_middle_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    basic_string_t* pt_insert = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);

    list_init(plist);
    basic_string_init_elem(pt_basic_string, 10, plist);
    basic_string_init_elem(pt_insert, 10, plist);

    basic_string_insert_substring(pt_basic_string, 4, pt_insert, 0, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
    list_destroy(plist);
}

void test_basic_string_insert_substring__libcstl_builtin_begin_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    basic_string_t* pt_insert = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);

    list_init(plist);
    basic_string_init_elem(pt_basic_string, 10, plist);
    list_push_back(plist, 10);
    basic_string_init_elem(pt_insert, 5, plist);

    basic_string_insert_substring(pt_basic_string, 0, pt_insert, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(list_size((list_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
        else
        {
            assert_true(list_size((list_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_insert_substring__user_define
{
    int n_elem;
}_test_basic_string_insert_substring__user_define_t;
void test_basic_string_insert_substring__user_define_middle_insert_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_insert = NULL;
    _test_basic_string_insert_substring__user_define_t t_elem;

    type_register(_test_basic_string_insert_substring__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_insert_substring__user_define_t);
    pt_insert = create_basic_string(_test_basic_string_insert_substring__user_define_t);

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);
    basic_string_init_elem(pt_insert, 10, &t_elem);

    basic_string_insert_substring(pt_basic_string, 4, pt_insert, 0, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

void test_basic_string_insert_substring__user_define_begin_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_insert_substring__user_define_t);
    basic_string_t* pt_insert = create_basic_string(_test_basic_string_insert_substring__user_define_t);
    _test_basic_string_insert_substring__user_define_t t_elem;

    t_elem.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_elem);
    t_elem.n_elem = 50;
    basic_string_init_elem(pt_insert, 5, &t_elem);

    basic_string_insert_substring(pt_basic_string, 0, pt_insert, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(((_test_basic_string_insert_substring__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 50);
        }
        else
        {
            assert_true(((_test_basic_string_insert_substring__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_insert);
}

/*
 * test basic_string_insert_range
 */
UT_CASE_DEFINATION(basic_string_insert_range)
void test_basic_string_insert_range__null_basic_string(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    expect_assert_failure(basic_string_insert_range(NULL, basic_string_begin(pt_dest),
        basic_string_begin(pt_src), basic_string_end(pt_src)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    pt_dest->_vec_base._pby_finish = (_byte_t*)0x34345;
    expect_assert_failure(basic_string_insert_range(pt_dest, basic_string_begin(pt_dest),
        basic_string_begin(pt_src), basic_string_end(pt_src)));

    pt_dest->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    */
}

void test_basic_string_insert_range__invalid_pos(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_pos;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_pos._t_containertype = 3333;
    expect_assert_failure(basic_string_insert_range(pt_dest, it_pos,
        basic_string_begin(pt_src), basic_string_end(pt_src)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__invalid_begin(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_begin;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_begin._t_iteratortype = 11111;
    expect_assert_failure(basic_string_insert_range(pt_dest, basic_string_begin(pt_dest),
        it_begin, basic_string_end(pt_src)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__invalid_end(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);
    basic_string_iterator_t it_end;

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    it_end._t_iteratortype = 11111;
    expect_assert_failure(basic_string_insert_range(pt_dest, basic_string_begin(pt_dest),
        basic_string_begin(pt_src), it_end));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__invalid_range(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, 100);
    expect_assert_failure(basic_string_insert_range(pt_dest, basic_string_begin(pt_dest),
        basic_string_end(pt_src), basic_string_begin(pt_src)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}


void test_basic_string_insert_range__not_same_type(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(double);

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, 100);
    expect_assert_failure(basic_string_insert_range(pt_dest, basic_string_begin(pt_dest),
        basic_string_begin(pt_src), basic_string_end(pt_src)));

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
void test_basic_string_insert_range__range_belong_to_dest(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);

    basic_string_init_elem(pt_dest, 10, 100);
    expect_assert_failure(basic_string_insert_range(pt_dest, basic_string_begin(pt_dest),
        basic_string_begin(pt_dest), basic_string_end(pt_dest)));

    basic_string_destroy(pt_dest);
}
*/

void test_basic_string_insert_range__c_builtin_empty_insert_empty(void** state)
{
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init(pt_src);
    basic_string_insert_range(pt_dest, basic_string_begin(pt_dest), basic_string_begin(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__c_builtin_empty_insert_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init(pt_dest);
    basic_string_init_elem(pt_src, 10, 100);
    basic_string_insert_range(pt_dest, basic_string_end(pt_dest), basic_string_begin(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == 100);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__c_builtin_non_empty_insert_begin_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 5, 99);
    basic_string_init_elem(pt_src, 10, 100);
    basic_string_insert_range(pt_dest, basic_string_begin(pt_dest), basic_string_end(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 5);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == 99);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__c_builtin_non_empty_insert_middle_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 5, 99);
    basic_string_init_elem(pt_src, 10, 100);
    basic_string_insert_range(pt_dest, iterator_next(basic_string_begin(pt_dest)),
        basic_string_begin(pt_src), basic_string_begin(pt_src));
    assert_true(basic_string_size(pt_dest) == 5);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == 99);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__c_builtin_non_empty_insert_end_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 5, 99);
    basic_string_init(pt_src);
    basic_string_insert_range(pt_dest, basic_string_end(pt_dest),
        basic_string_begin(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 5);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_dest, i) == 99);
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__c_builtin_non_empty_insert_begin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 5, 99);
    basic_string_init_elem(pt_src, 10, 100);
    basic_string_insert_range(pt_dest, basic_string_begin(pt_dest),
        basic_string_begin(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 15);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 99);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__c_builtin_non_empty_insert_middle_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 5, 99);
    basic_string_init_elem(pt_src, 10, 100);
    basic_string_insert_range(pt_dest, iterator_next(basic_string_begin(pt_dest)),
        basic_string_begin(pt_src), iterator_next_n(basic_string_begin(pt_src), 5));
    assert_true(basic_string_size(pt_dest) == 10);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 1 || i > 5)
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 99);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 100);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__c_builtin_non_empty_insert_end_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(int);
    basic_string_t* pt_src = create_basic_string(int);

    basic_string_init_elem(pt_dest, 5, 99);
    basic_string_init_elem(pt_src, 10, 100);
    basic_string_insert_range(pt_dest, basic_string_end(pt_dest),
        iterator_prev_n(basic_string_end(pt_src), 7), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 12);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 99);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_dest, i) == 100);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__char(void** state)
{
    basic_string_t* pt_dest = create_basic_string(char);
    basic_string_t* pt_src = create_basic_string(char);

    basic_string_init_cstr(pt_dest, "xxxxxxxx");
    basic_string_init_cstr(pt_src, "abcdefg");
    basic_string_insert_range(pt_dest, iterator_next_n(basic_string_begin(pt_dest), 3),
        basic_string_begin(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 15);
    assert_true(strncmp((char*)basic_string_c_str(pt_dest), "xxxabcdefgxxxxx", 15) == 0);

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(char*);
    basic_string_t* pt_src = create_basic_string(char*);

    basic_string_init_elem(pt_dest, 5, "xxxxx");
    basic_string_init_elem(pt_src, 10, "abcde");
    basic_string_insert_range(pt_dest, basic_string_end(pt_dest),
        basic_string_begin(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 15);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 5)
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "xxxxx") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_dest, i), "abcde") == 0);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

void test_basic_string_insert_range__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = create_basic_string(vector_t<int>);
    basic_string_t* pt_src = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_dest, 10, pvec);
    vector_push_back(pvec, 2);
    basic_string_init_elem(pt_src, 10, pvec);
    basic_string_insert_range(pt_dest, iterator_next(basic_string_begin(pt_dest)),
        basic_string_begin(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 20);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 1 || i > 10)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_dest, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_dest, i)) == 1);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_insert_range__user_define
{
    int n_elem;
}_test_basic_string_range__user_define_t;
void test_basic_string_insert_range__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_dest = NULL;
    basic_string_t* pt_src = NULL;
    _test_basic_string_range__user_define_t t_user;

    type_register(_test_basic_string_range__user_define_t, NULL, NULL, NULL, NULL);
    pt_dest = create_basic_string(_test_basic_string_range__user_define_t);
    pt_src = create_basic_string(_test_basic_string_range__user_define_t);

    t_user.n_elem = 555;
    basic_string_init_elem(pt_dest, 10, &t_user);
    t_user.n_elem = 9;
    basic_string_init_elem(pt_src, 5, &t_user);
    basic_string_insert_range(pt_dest, basic_string_end(pt_dest), basic_string_begin(pt_src), basic_string_end(pt_src));
    assert_true(basic_string_size(pt_dest) == 15);
    for(i = 0; i < basic_string_size(pt_dest); ++i)
    {
        if(i < 10)
        {
            assert_true(((_test_basic_string_range__user_define_t*)basic_string_at(pt_dest, i))->n_elem == 555);
        }
        else
        {
            assert_true(((_test_basic_string_range__user_define_t*)basic_string_at(pt_dest, i))->n_elem == 9);
        }
    }

    basic_string_destroy(pt_dest);
    basic_string_destroy(pt_src);
}

/*
 * test basic_string_insert_cstr
 */
UT_CASE_DEFINATION(basic_string_insert_cstr)
void test_basic_string_insert_cstr__null_container(void** state)
{
    expect_assert_failure(basic_string_insert_cstr(NULL, 0, "abcdef"));
}

void test_basic_string_insert_cstr__non_inited(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x9999;
    expect_assert_failure(basic_string_insert_cstr(pt_basic_string, 0, "abcdefg"));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_insert_cstr__null_valuestring(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_insert_cstr(pt_basic_string, 0, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abc");
    expect_assert_failure(basic_string_insert_cstr(pt_basic_string, 178, "abcdefg"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};

    basic_string_init_elem(pt_basic_string, 1, 0);
    basic_string_insert_cstr(pt_basic_string, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 1);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__c_builtin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 9, 9, 0, 13, 5455};

    basic_string_init_elem(pt_basic_string, 30, 100);
    basic_string_insert_cstr(pt_basic_string, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 33);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 3)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 9);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefg");
    basic_string_insert_cstr(pt_basic_string, 3, "");
    assert_true(basic_string_size(pt_basic_string) == 7);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__char_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_elem(pt_basic_string, 2, 'x');
    basic_string_insert_cstr(pt_basic_string, 1, "abc");
    assert_true(basic_string_size(pt_basic_string) == 5);
    assert_true(*(char*)basic_string_at(pt_basic_string, 0) == 'x');
    assert_true(*(char*)basic_string_at(pt_basic_string, 1) == 'a');
    assert_true(*(char*)basic_string_at(pt_basic_string, 2) == 'b');
    assert_true(*(char*)basic_string_at(pt_basic_string, 3) == 'c');
    assert_true(*(char*)basic_string_at(pt_basic_string, 4) == 'x');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {NULL};

    basic_string_init_elem(pt_basic_string, 3, "abc");
    basic_string_insert_cstr(pt_basic_string, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__cstr_init_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_insert_cstr(pt_basic_string, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 6);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 3), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 4), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 5), "hij") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[] = {NULL};

    list_init(plist);
    basic_string_init_elem(pt_basic_string, 1, plist);
    basic_string_insert_cstr(pt_basic_string, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 1);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_insert_cstr__libcstl_builtin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init_elem(pt_basic_string, 3, plist);
    list_push_back(plist, 3);
    basic_string_insert_cstr(pt_basic_string, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 6);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 3)
        {
            assert_true(list_size((list_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
        else
        {
            assert_true(list_size((list_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_insert_cstr__user_define
{
    int n_elem;
    double d_elem;
}_test_basic_string_insert_cstr__user_define_t;
void test_basic_string_insert_cstr__user_define_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_insert_cstr__user_define_t t_user;
    _test_basic_string_insert_cstr__user_define_t* elems[] = {NULL};

    type_register(_test_basic_string_insert_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_insert_cstr__user_define_t);

    basic_string_init_elem(pt_basic_string, 4, &t_user);
    basic_string_insert_cstr(pt_basic_string, 3, elems);
    assert_true(basic_string_size(pt_basic_string) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_cstr__user_define_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_insert_cstr__user_define_t);
    _test_basic_string_insert_cstr__user_define_t t_user1;
    _test_basic_string_insert_cstr__user_define_t t_user2;
    _test_basic_string_insert_cstr__user_define_t* elems[5] = {&t_user1, &t_user2, &t_user2, NULL, &t_user1};

    t_user1.n_elem = 4;
    t_user1.d_elem = 9.4;
    t_user2.n_elem = 0;
    t_user2.d_elem = 0.0;
    basic_string_init_elem(pt_basic_string, 1, &t_user1);
    basic_string_insert_cstr(pt_basic_string, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 4);
    assert_true(((_test_basic_string_insert_cstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_insert_cstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 9.4);
    assert_true(((_test_basic_string_insert_cstr__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 0);
    assert_true(((_test_basic_string_insert_cstr__user_define_t*)basic_string_at(pt_basic_string, 1))->d_elem == 0.0);
    assert_true(((_test_basic_string_insert_cstr__user_define_t*)basic_string_at(pt_basic_string, 2))->n_elem == 0);
    assert_true(((_test_basic_string_insert_cstr__user_define_t*)basic_string_at(pt_basic_string, 2))->d_elem == 0.0);
    assert_true(((_test_basic_string_insert_cstr__user_define_t*)basic_string_at(pt_basic_string, 3))->n_elem == 4);
    assert_true(((_test_basic_string_insert_cstr__user_define_t*)basic_string_at(pt_basic_string, 3))->d_elem == 9.4);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_insert_subcstr
 */
UT_CASE_DEFINATION(basic_string_insert_subcstr)
void test_basic_string_insert_subcstr__null_container(void** state)
{
    expect_assert_failure(basic_string_insert_subcstr(NULL, 0, "abcdef", 0));
}

void test_basic_string_insert_subcstr__non_created_container(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x78773;
    expect_assert_failure(basic_string_insert_subcstr(pt_basic_string, 0, "abcdefg", NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_insert_subcstr__null_valuestring(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_insert_subcstr(pt_basic_string, 0, NULL, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abc");
    expect_assert_failure(basic_string_insert_subcstr(pt_basic_string, 178, "abcdefg", NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__c_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 5, 2, 0, 13, 5455};

    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__c_builtin_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 9, 9, 0, 13, 5455};

    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 2)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 9);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__c_builtin_total(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {9, 9, 9, 0, 13, 5455};

    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 3);
    assert_true(basic_string_size(pt_basic_string) == 13);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 3)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 9);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__char_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_insert_subcstr(pt_basic_string, 3, "abc", 0);
    assert_true(basic_string_size(pt_basic_string) == 10);
    assert_true(strncmp((char*)basic_string_c_str(pt_basic_string), "xxxxxxxxxx", 10) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__char_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_insert_subcstr(pt_basic_string, 2, "abc", 1);
    assert_true(basic_string_size(pt_basic_string) == 11);
    assert_true(strncmp((char*)basic_string_c_str(pt_basic_string), "xxaxxxxxxxx", 11) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__char_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "xxxxxxxxxx");
    basic_string_insert_subcstr(pt_basic_string, 5, "abc", 100);
    assert_true(basic_string_size(pt_basic_string) == 13);
    assert_true(strncmp((char*)basic_string_c_str(pt_basic_string), "xxxxxabcxxxxx", 13) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__cstr_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 1);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__cstr_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "xxxxxxxxxx") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__cstr_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "hij", NULL};

    basic_string_init_elem(pt_basic_string, 1, "xxxxxxxxxx");
    basic_string_insert_subcstr(pt_basic_string, 0, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 4);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "def") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 2), "hij") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 3), "xxxxxxxxxx") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__libcstl_builtin_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init_elem(pt_basic_string, 1, plist);
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 1);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_insert_subcstr__libcstl_builtin_non_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 1);
    assert_true(basic_string_size(pt_basic_string) == 4);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

void test_basic_string_insert_subcstr__libcstl_builtin_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);
    list_t* elems[5];

    list_init(plist);
    elems[0] = plist;
    elems[1] = plist;
    elems[2] = plist;
    elems[3] = NULL;
    elems[4] = plist;
    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_insert_subcstr(pt_basic_string, 0, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 6);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_insert_subcstr__user_define
{
    int n_elem;
    double d_elem;
}_test_basic_string_insert_subcstr__user_define_t;
void test_basic_string_insert_subcstr__user_define_empty(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_insert_subcstr__user_define_t t_user;
    _test_basic_string_insert_subcstr__user_define_t* elems[5] = {&t_user, &t_user, &t_user, NULL, &t_user};

    type_register(_test_basic_string_insert_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_insert_subcstr__user_define_t);

    basic_string_init_elem(pt_basic_string, 100, &t_user);
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 100);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__user_define_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_insert_subcstr__user_define_t);
    _test_basic_string_insert_subcstr__user_define_t t_user;
    _test_basic_string_insert_subcstr__user_define_t* elems[5] = {&t_user, &t_user, &t_user, NULL, &t_user};

    t_user.n_elem = 100;
    t_user.d_elem = -0.3;
    basic_string_init_elem(pt_basic_string, 100, &t_user);
    t_user.n_elem = 4;
    t_user.d_elem = 0.0;
    basic_string_insert_subcstr(pt_basic_string, 0, elems, 1);
    assert_true(basic_string_size(pt_basic_string) == 101);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 1)
        {
            assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 4);
            assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->d_elem == 0.0);
        }
        else
        {
            assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 100);
            assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->d_elem == -0.3);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_insert_subcstr__user_define_total(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(_test_basic_string_insert_subcstr__user_define_t);
    _test_basic_string_insert_subcstr__user_define_t t_user1;
    _test_basic_string_insert_subcstr__user_define_t t_user2;
    _test_basic_string_insert_subcstr__user_define_t t_user3;
    _test_basic_string_insert_subcstr__user_define_t* elems[5] = {&t_user1, &t_user2, &t_user3, NULL, &t_user1};

    t_user1.n_elem = 100;
    t_user1.d_elem = 100.0;
    basic_string_init_elem(pt_basic_string, 1, &t_user1);
    t_user1.n_elem = 4; t_user1.d_elem = 0.0;
    t_user2.n_elem = 0; t_user2.d_elem = 9.24;
    t_user3.n_elem = 0; t_user3.d_elem = 0.0;
    basic_string_insert_subcstr(pt_basic_string, 0, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 4);
    assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 4);
    assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, 0))->d_elem == 0.0);
    assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 0);
    assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, 1))->d_elem == 9.24);
    assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, 2))->n_elem == 0);
    assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, 2))->d_elem == 0.0);
    assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, 3))->n_elem == 100);
    assert_true(((_test_basic_string_insert_subcstr__user_define_t*)basic_string_at(pt_basic_string, 3))->d_elem == 100.0);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_erase
 */
UT_CASE_DEFINATION(basic_string_erase)
void test_basic_string_erase__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    expect_assert_failure(basic_string_erase(NULL, basic_string_begin(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_non_inited = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_non_inited);
    pt_non_inited->_vec_base._pby_start = (_byte_t*)0x777;
    expect_assert_failure(basic_string_erase(pt_non_inited, basic_string_begin(pt_basic_string)));

    pt_non_inited->_vec_base._pby_start = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_non_inited);
    */
}

void test_basic_string_erase__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;

    basic_string_init_elem(pt_basic_string, 10, 100);
    it_pos = basic_string_begin(pt_basic_string);
    it_pos._t_containertype = 9999;
    expect_assert_failure(basic_string_erase(pt_basic_string, it_pos));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase__empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_erase(pt_basic_string, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase__c_builtin_begin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }

    it_pos = basic_string_erase(pt_basic_string, basic_string_begin(pt_basic_string));
    assert_true(basic_string_size(pt_basic_string) == 9);
    assert_true(*(int*)iterator_get_pointer(it_pos) == 1);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase__c_builtin_middle(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }

    it_pos = basic_string_erase(pt_basic_string, iterator_next(basic_string_begin(pt_basic_string)));
    assert_true(basic_string_size(pt_basic_string) == 9);
    assert_true(*(int*)iterator_get_pointer(it_pos) == 2);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase__c_builtin_last(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;

    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        basic_string_push_back(pt_basic_string, i);
    }

    it_pos = basic_string_erase(pt_basic_string, iterator_prev(basic_string_end(pt_basic_string)));
    assert_true(basic_string_size(pt_basic_string) == 9);
    assert_true(iterator_equal(it_pos, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase__char(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_iterator_t it_pos;

    basic_string_init_cstr(pt_basic_string, "abcdefg");

    it_pos = basic_string_erase(pt_basic_string, basic_string_begin(pt_basic_string));
    assert_true(basic_string_size(pt_basic_string) == 6);
    assert_true(*(char*)iterator_get_pointer(it_pos) == 'b');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase__cstr(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_iterator_t it_pos;
    const char* elems[] = {"abc", "def", "hij", "null", NULL};

    basic_string_init_cstr(pt_basic_string, elems);

    it_pos = basic_string_erase(pt_basic_string, iterator_next(basic_string_begin(pt_basic_string)));
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(strcmp((char*)iterator_get_pointer(it_pos), "hij") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    basic_string_iterator_t it_pos;
    list_t* plist = create_list(int);

    basic_string_init(pt_basic_string);
    list_init(plist);
    for(i = 0; i < 10; ++i)
    {
        list_clear(plist);
        list_push_back(plist, i);
        basic_string_push_back(pt_basic_string, plist);
    }

    it_pos = basic_string_erase(pt_basic_string, iterator_prev(basic_string_end(pt_basic_string)));
    assert_true(basic_string_size(pt_basic_string) == 9);
    assert_true(iterator_equal(it_pos, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_erase__user_define
{
    int n_elem;
}_test_basic_string_erase__user_define_t;
void test_basic_string_erase__user_define(void** state)
{
    basic_string_t* pt_basic_string = NULL;
    basic_string_iterator_t it_pos;
    _test_basic_string_erase__user_define_t t_user;

    type_register(_test_basic_string_erase__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_erase__user_define_t);
    basic_string_init(pt_basic_string);
    t_user.n_elem = 1;
    basic_string_push_back(pt_basic_string, &t_user);
    t_user.n_elem = 2;
    basic_string_push_back(pt_basic_string, &t_user);
    t_user.n_elem = 3;
    basic_string_push_back(pt_basic_string, &t_user);

    it_pos = basic_string_erase(pt_basic_string, basic_string_begin(pt_basic_string));
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(((_test_basic_string_erase__user_define_t*)iterator_get_pointer(it_pos))->n_elem == 2);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_erase_range
 */
UT_CASE_DEFINATION(basic_string_erase_range)
void test_basic_string_erase_range__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 2, 100);
    expect_assert_failure(basic_string_erase_range(
        NULL, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x5555;
    expect_assert_failure(basic_string_erase_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string)));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_erase_range__invalid_begin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_begin;

    basic_string_init_elem(pt_basic_string, 2, 100);
    it_begin._t_containertype = 44444;
    expect_assert_failure(basic_string_erase_range(pt_basic_string, it_begin, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__invalid_end(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_end;

    basic_string_init_elem(pt_basic_string, 2, 100);
    it_end._t_iteratortype = 34455;
    expect_assert_failure(basic_string_erase_range(pt_basic_string, basic_string_begin(pt_basic_string), it_end));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__invalid_range(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 2, 100);
    expect_assert_failure(basic_string_erase_range(
        pt_basic_string, basic_string_end(pt_basic_string), basic_string_begin(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;

    basic_string_init(pt_basic_string);
    it_pos = basic_string_erase_range(
        pt_basic_string, basic_string_end(pt_basic_string), basic_string_begin(pt_basic_string));
    assert_true(basic_string_size(pt_basic_string) == 0);
    assert_true(iterator_equal(it_pos, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__c_builtin_begin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;
    int elems[] = {4, 2, 6, 9, 1, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    it_pos = basic_string_erase_range(pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 2));
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(*(int*)iterator_get_pointer(it_pos) == 6);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__c_builtin_middle(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;
    int elems[] = {4, 2, 6, 9, 1, 5, 19, 45, 234, 11, 87, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    it_pos = basic_string_erase_range(pt_basic_string, iterator_next(basic_string_begin(pt_basic_string)),
        iterator_next_n(basic_string_begin(pt_basic_string), 5));
    assert_true(basic_string_size(pt_basic_string) == 7);
    assert_true(*(int*)iterator_get_pointer(it_pos) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__c_builtin_end(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;
    int elems[] = {4, 2, 6, 9, 1, 5, 19, 45, 234, 11, 87, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    it_pos = basic_string_erase_range(pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        basic_string_end(pt_basic_string));
    assert_true(basic_string_size(pt_basic_string) == 5);
    assert_true(iterator_equal(it_pos, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__c_builtin_all(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;
    int elems[] = {4, 2, 6, 9, 1, 5, 19, 45, 234, 11, 87, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    it_pos = basic_string_erase_range(pt_basic_string, basic_string_begin(pt_basic_string),
        basic_string_end(pt_basic_string));
    assert_true(basic_string_size(pt_basic_string) == 0);
    assert_true(iterator_equal(it_pos, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__c_builtin_erase_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_pos;
    int elems[] = {4, 2, 6, 9, 1, 5, 19, 45, 234, 11, 87, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    it_pos = basic_string_erase_range(pt_basic_string, basic_string_begin(pt_basic_string),
        basic_string_begin(pt_basic_string));
    assert_true(basic_string_size(pt_basic_string) == 11);
    assert_true(*(int*)iterator_get_pointer(it_pos) == 4);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__char(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_iterator_t it_pos;

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    it_pos = basic_string_erase_range(pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 4));
    assert_true(basic_string_size(pt_basic_string) == 6);
    assert_true(*(char*)iterator_get_pointer(it_pos) == 'e');

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__cstr(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_iterator_t it_pos;
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    it_pos = basic_string_erase_range(pt_basic_string, iterator_next(basic_string_begin(pt_basic_string)),
        iterator_next_n(basic_string_begin(pt_basic_string), 4));
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(strcmp((char*)iterator_get_pointer(it_pos), "mno") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_range__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    basic_string_iterator_t it_pos;
    list_t* plist = create_list(int);

    list_init(plist);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        list_clear(plist);
        list_push_back(plist, i);
        basic_string_push_back(pt_basic_string, plist);
    }
    it_pos = basic_string_erase_range(pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        basic_string_end(pt_basic_string));
    assert_true(basic_string_size(pt_basic_string) == 3);
    assert_true(iterator_equal(it_pos, basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_erase_range__user_define
{
    int n_elem;
}_test_basic_string_erase_range__user_define_t;
void test_basic_string_erase_range__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    basic_string_iterator_t it_pos;
    _test_basic_string_erase_range__user_define_t t_user;

    type_register(_test_basic_string_erase_range__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_erase_range__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_user);
    }
    it_pos = basic_string_erase_range(pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_prev(basic_string_end(pt_basic_string)));
    assert_true(basic_string_size(pt_basic_string) == 4);
    assert_true(((_test_basic_string_erase_range__user_define_t*)iterator_get_pointer(it_pos))->n_elem == 9);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_erase_substring
 */
UT_CASE_DEFINATION(basic_string_erase_substring)
void test_basic_string_erase_substring__null_basic_string(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_erase_substring(NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__non_inited_basic_string(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x8888;
    expect_assert_failure(basic_string_erase_substring(pt_basic_string, 0, NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_erase_substring__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);

    basic_string_init_elem(pt_basic_string, 3, 100);
    expect_assert_failure(basic_string_erase_substring(pt_basic_string, 8, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__c_builtin_begin(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {6, 3, 9, 1, 98, 4, 5, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_erase_substring(pt_basic_string, 0, 5);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 4);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__c_builtin_middle(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {6, 3, 9, 1, 98, 4, 5, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_erase_substring(pt_basic_string, 1, 5);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 6);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__c_builtin_end(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {6, 3, 9, 1, 98, 4, 5, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_erase_substring(pt_basic_string, 2, 5);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 6);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 3);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__c_builtin_all(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {6, 3, 9, 1, 98, 4, 5, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_erase_substring(pt_basic_string, 0, 1234);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__c_builtin_erase_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {6, 3, 9, 1, 98, 4, 5, 0};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_erase_substring(pt_basic_string, 4, 0);
    assert_true(basic_string_size(pt_basic_string) == 7);
    assert_true(*(int*)basic_string_at(pt_basic_string, 0) == 6);
    assert_true(*(int*)basic_string_at(pt_basic_string, 1) == 3);
    assert_true(*(int*)basic_string_at(pt_basic_string, 2) == 9);
    assert_true(*(int*)basic_string_at(pt_basic_string, 3) == 1);
    assert_true(*(int*)basic_string_at(pt_basic_string, 4) == 98);
    assert_true(*(int*)basic_string_at(pt_basic_string, 5) == 4);
    assert_true(*(int*)basic_string_at(pt_basic_string, 6) == 5);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__char(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init_cstr(pt_basic_string, "abcdefghij");
    basic_string_erase_substring(pt_basic_string, 0, 3);
    assert_true(basic_string_size(pt_basic_string) == 7);
    assert_true(strncmp((char*)basic_string_c_str(pt_basic_string), "defghij", 7) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__cstr(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"abc", "def", "ghi", "jkl", "mno", NULL};

    basic_string_init_cstr(pt_basic_string, elems);
    basic_string_erase_substring(pt_basic_string, 1, 3);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 0), "abc") == 0);
    assert_true(strcmp((char*)basic_string_at(pt_basic_string, 1), "mno") == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_erase_substring__libcstr_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(list_t<int>);
    list_t* plist = create_list(int);

    basic_string_init(pt_basic_string);
    list_init(plist);
    for(i = 0; i < 10; ++i)
    {
        list_clear(plist);
        list_push_back(plist, i);
        basic_string_push_back(pt_basic_string, plist);
    }

    basic_string_erase_substring(pt_basic_string, 2, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(*(int*)list_front((list_t*)basic_string_at(pt_basic_string, 0)) == 0);
    assert_true(*(int*)list_front((list_t*)basic_string_at(pt_basic_string, 1)) == 1);

    basic_string_destroy(pt_basic_string);
    list_destroy(plist);
}

typedef struct _tag_test_basic_string_erase_substring__user_define
{
    int n_elem;
}_test_basic_string_erase_substring__user_define_t;
void test_basic_string_erase_substring__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_erase_substring__user_define_t t_user;

    type_register(_test_basic_string_erase_substring__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_erase_substring__user_define_t);
    basic_string_init(pt_basic_string);
    for(i = 0; i < 10; ++i)
    {
        t_user.n_elem = i;
        basic_string_push_back(pt_basic_string, &t_user);
    }

    basic_string_erase_substring(pt_basic_string, 1, 8);
    assert_true(basic_string_size(pt_basic_string) == 2);
    assert_true(((_test_basic_string_erase_substring__user_define_t*)basic_string_at(pt_basic_string, 0))->n_elem == 0);
    assert_true(((_test_basic_string_erase_substring__user_define_t*)basic_string_at(pt_basic_string, 1))->n_elem == 9);

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_replace
 */
UT_CASE_DEFINATION(basic_string_replace)
void test_basic_string_replace__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_replace(NULL, 0, NPOS, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace__null_replace(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_replace(pt_basic_string, 0, NPOS, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_replace);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_replace(pt_basic_string, 0, NPOS, pt_replace));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_replace__non_inited_replace(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    pt_replace->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_replace(pt_basic_string, 0, NPOS, pt_replace));

    pt_replace->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_replace__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(double);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    expect_assert_failure(basic_string_replace(pt_basic_string, 0, NPOS, pt_replace));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__same_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace(pt_basic_string, 0, NPOS, pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    expect_assert_failure(basic_string_replace(pt_basic_string, 180, NPOS, pt_replace));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_replace(pt_basic_string, 0, 0, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 500);

    basic_string_replace(pt_basic_string, 0, 0, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_replace(pt_basic_string, 0, 3, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 500);

    basic_string_replace(pt_basic_string, 0, 3, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_replace(pt_basic_string, 3, 0, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 500);

    basic_string_replace(pt_basic_string, 5, 0, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_replace(pt_basic_string, 3, 5, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 2, 500);

    basic_string_replace(pt_basic_string, 5, 3, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_replace(pt_basic_string, 3, NPOS, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 5, 500);

    basic_string_replace(pt_basic_string, 5, 150, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_replace(pt_basic_string, 0, 150, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 4, 500);

    basic_string_replace(pt_basic_string, 0, NPOS, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_replace = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init_elem(pt_replace, 5, 'b');

    basic_string_replace(pt_basic_string, 0, 3, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_replace = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "abc");
    basic_string_init_elem(pt_replace, 50, "xxx");

    basic_string_replace(pt_basic_string, 4, 5, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 55);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 53)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_replace = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);
    basic_string_init_elem(pt_replace, 20, pvec);

    basic_string_replace(pt_basic_string, 4, NPOS, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 24);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_replace__user_define
{
    int n_elem;
}_test_basic_string_replace__user_define_t;
void test_basic_string_replace__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_replace = NULL;
    _test_basic_string_replace__user_define_t t_user;

    type_register(_test_basic_string_replace__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_replace__user_define_t);
    pt_replace = create_basic_string(_test_basic_string_replace__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;
    basic_string_init_elem(pt_replace, 20, &t_user);

    basic_string_replace(pt_basic_string, 0, NPOS, pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_replace__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

/*
 * test basic_string_replace_substring
 */
UT_CASE_DEFINATION(basic_string_replace_substring)
void test_basic_string_replace_substring__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_substring(NULL, 0, NPOS, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_substring__null_replace(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_substring(pt_basic_string, 0, NPOS, NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_substring__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_replace, 10, 100);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_replace_substring(pt_basic_string, 0, NPOS, pt_replace, 0, NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_replace_substring__non_inited_replace(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    pt_replace->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_replace_substring(pt_basic_string, 0, NPOS, pt_replace, 0, NPOS));

    pt_replace->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_replace_substring__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(double);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 100.0);

    expect_assert_failure(basic_string_replace_substring(pt_basic_string, 0, NPOS, pt_replace, 0, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__same_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_substring(pt_basic_string, 0, NPOS, pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_substring__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 100);

    expect_assert_failure(basic_string_replace_substring(pt_basic_string, 180, NPOS, pt_replace, 0, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__invalid_position(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    expect_assert_failure(basic_string_replace_substring(pt_basic_string, 8, NPOS, pt_replace, 0, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 0, 0, pt_replace, 0, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 0, 0, pt_replace, 0, 10);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 0, 3, pt_replace, 67, 0);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 0, 3, pt_replace, 45, 10);
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 3, 0, pt_replace, 66, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 5, 0, pt_replace, 90, 233);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 3, 5, pt_replace, 5, 0);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 2, 500);

    basic_string_replace_substring(pt_basic_string, 5, 3, pt_replace, 0, 55);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 3, NPOS, pt_replace, 0, 0);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 5, 500);

    basic_string_replace_substring(pt_basic_string, 5, 150, pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_substring(pt_basic_string, 0, 150, pt_replace, 56, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 4, 500);

    basic_string_replace_substring(pt_basic_string, 0, NPOS, pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_replace = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init_elem(pt_replace, 5, 'b');

    basic_string_replace_substring(pt_basic_string, 0, 3, pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_replace = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "abc");
    basic_string_init_elem(pt_replace, 50, "xxx");

    basic_string_replace_substring(pt_basic_string, 4, 5, pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 55);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 53)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_substring__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_replace = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);
    basic_string_init_elem(pt_replace, 20, pvec);

    basic_string_replace_substring(pt_basic_string, 4, NPOS, pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 24);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_replace_substring__user_define
{
    int n_elem;
}_test_basic_string_replace_substring__user_define_t;
void test_basic_string_replace_substring__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_replace = NULL;
    _test_basic_string_replace_substring__user_define_t t_user;

    type_register(_test_basic_string_replace_substring__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_replace_substring__user_define_t);
    pt_replace = create_basic_string(_test_basic_string_replace_substring__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;
    basic_string_init_elem(pt_replace, 20, &t_user);

    basic_string_replace_substring(pt_basic_string, 0, NPOS, pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_replace_substring__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

/*
 * test basic_string_replace_cstr
 */
UT_CASE_DEFINATION(basic_string_replace_cstr)
void test_basic_string_replace_cstr__null_dest(void** state)
{
    expect_assert_failure(basic_string_replace_cstr(NULL, 0, NPOS, "abcd"));
}

void test_basic_string_replace_cstr__null_replace(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_cstr(pt_basic_string, 0, NPOS, NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 5, 0};
    basic_string_init(pt_basic_string);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_replace_cstr(pt_basic_string, 0, NPOS, elems));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_replace_cstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 5, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_cstr(pt_basic_string, 180, NPOS, elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 0, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[11] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);
    memset(elems, 0x00, 11 * sizeof(int));
    for(i = 0; i < 10; ++i)
    {
        elems[i] = 500;
    }

    basic_string_replace_cstr(pt_basic_string, 0, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 0, 3, elems);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[11] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);
    for(i = 0; i < 10; ++i)
    {
        elems[i] = 500;
    }

    basic_string_replace_cstr(pt_basic_string, 0, 3, elems);
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 3, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[11] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);
    for(i = 0; i < 10; ++i)
    {
        elems[i] = 500;
    }

    basic_string_replace_cstr(pt_basic_string, 5, 0, elems);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 3, 5, elems);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 5, 3, elems);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 3, NPOS, elems);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 5, 150, elems);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 0, 150, elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_cstr(pt_basic_string, 0, NPOS, elems);
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    basic_string_replace_cstr(pt_basic_string, 0, 3, "bbbbb");
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"xxxx", "xxxx", "xxxx", "xxxx", "xxxx", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    basic_string_replace_cstr(pt_basic_string, 4, 5, elems);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 8)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_cstr__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);

    basic_string_replace_cstr(pt_basic_string, 4, NPOS, elems);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_replace_cstr__user_define
{
    int n_elem;
}_test_basic_string_replace_cstr__user_define_t;
void test_basic_string_replace_cstr__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_replace_cstr__user_define_t t_user;
    _test_basic_string_replace_cstr__user_define_t* elems[] = {&t_user, &t_user, &t_user, &t_user, &t_user, NULL};

    type_register(_test_basic_string_replace_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_replace_cstr__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;

    basic_string_replace_cstr(pt_basic_string, 0, NPOS, elems);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_replace_cstr__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_replace_subcstr
 */
UT_CASE_DEFINATION(basic_string_replace_subcstr)
void test_basic_string_replace_subcstr__null_dest(void** state)
{
    expect_assert_failure(basic_string_replace_subcstr(NULL, 0, NPOS, "abcde", NPOS));
}

void test_basic_string_replace_subcstr__null_replace(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_subcstr(pt_basic_string, 0, NPOS, NULL, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 5, 67, 0};
    basic_string_init(pt_basic_string);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_replace_subcstr(pt_basic_string, 0, NPOS, elems, NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_replace_subcstr__invalid_pos(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 5, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_subcstr(pt_basic_string, 180, NPOS, elems, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {2, 3, 4, 5, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 0, 0, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 0, 0, elems, 5);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 0, 3, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 0, 3, elems, 10);
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 3, 0, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 5, 0, elems, 100);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {4, 5, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 3, 5, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 5, 3, elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 3, NPOS, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 5, 150, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 0, 150, elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_replace_subcstr(pt_basic_string, 0, NPOS, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    basic_string_replace_subcstr(pt_basic_string, 0, 3, "bbbbb", NPOS);
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"xxx", "xxx", "xxx", "xxx", "xxx", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    basic_string_replace_subcstr(pt_basic_string, 4, 5, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 8)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_subcstr__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);

    basic_string_replace_subcstr(pt_basic_string, 4, NPOS, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_replace_subcstr__user_define
{
    int n_elem;
}_test_basic_string_replace_subcstr__user_define_t;
void test_basic_string_replace_subcstr__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_replace_subcstr__user_define_t t_user;
    _test_basic_string_replace_subcstr__user_define_t* elems[] = {&t_user, &t_user, &t_user, NULL};

    type_register(_test_basic_string_replace_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_replace_subcstr__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;

    basic_string_replace_subcstr(pt_basic_string, 0, NPOS, elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_replace_subcstr__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_range_replace
 */
UT_CASE_DEFINATION(basic_string_range_replace)
void test_basic_string_range_replace__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_range_replace(
        NULL, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace__null_replace(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init(pt_basic_string);

    expect_assert_failure(basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_init(pt_replace);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_replace), basic_string_end(pt_replace), pt_replace));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_range_replace__non_inited_replace(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    pt_replace->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace));

    pt_replace->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_range_replace__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(double);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    expect_assert_failure(basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__same_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_basic_string));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace__invalid_range(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    expect_assert_failure(basic_string_range_replace(
        pt_basic_string, basic_string_end(pt_basic_string), basic_string_begin(pt_basic_string), pt_replace));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 500);

    basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 500);

    basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_range_replace(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 500);

    basic_string_range_replace(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 5), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_range_replace(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 8), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 2, 500);

    basic_string_range_replace(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 8), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_range_replace(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        basic_string_end(pt_basic_string), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 5, 500);

    basic_string_range_replace(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        basic_string_end(pt_basic_string), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 4, 500);

    basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_replace = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init_elem(pt_replace, 5, 'b');

    basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_replace = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "abc");
    basic_string_init_elem(pt_replace, 50, "xxx");

    basic_string_range_replace(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        iterator_next_n(basic_string_begin(pt_basic_string), 9), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 55);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 53)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_replace = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);
    basic_string_init_elem(pt_replace, 20, pvec);

    basic_string_range_replace(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        basic_string_end(pt_basic_string), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 24);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_range_replace__user_define
{
    int n_elem;
}_test_basic_string_range_replace__user_define_t;
void test_basic_string_range_replace__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_replace = NULL;
    _test_basic_string_range_replace__user_define_t t_user;

    type_register(_test_basic_string_range_replace__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_range_replace__user_define_t);
    pt_replace = create_basic_string(_test_basic_string_range_replace__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;
    basic_string_init_elem(pt_replace, 20, &t_user);

    basic_string_range_replace(
        pt_basic_string, basic_string_begin(pt_basic_string),
        basic_string_end(pt_basic_string), pt_replace);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_range_replace__user_define_t*)basic_string_at(pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

/*
 * test basic_string_range_replace_substring
 */
UT_CASE_DEFINATION(basic_string_range_replace_substring)
void test_basic_string_range_replace_substring__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_range_replace_substring(
        NULL, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_substring__null_replace(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), NULL, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_substring__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_replace, 10, 100);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_replace), basic_string_end(pt_replace), pt_replace, 0, NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_range_replace_substring__non_inited_replace(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    pt_replace->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace, 0, NPOS));

    pt_replace->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_range_replace_substring__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(double);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 100.0);

    expect_assert_failure(basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace, 0, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__same_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_basic_string, 0, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_substring__invalid_range(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 100);

    expect_assert_failure(basic_string_range_replace_substring(
        pt_basic_string, basic_string_end(pt_basic_string), basic_string_begin(pt_basic_string), pt_replace, 0, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__invalid_position(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init(pt_replace);

    expect_assert_failure(basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace, 0, NPOS));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string), pt_replace, 0, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string), pt_replace, 0, 10);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), pt_replace, 67, 0);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), pt_replace, 45, 10);
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), pt_replace, 66, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 5), pt_replace, 90, 233);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 8), pt_replace, 5, 0);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 2, 500);

    basic_string_range_replace_substring(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 8), pt_replace, 0, 55);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        basic_string_end(pt_basic_string), pt_replace, 0, 0);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 5, 500);

    basic_string_range_replace_substring(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        basic_string_end(pt_basic_string), pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace, 56, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 4, 500);

    basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_replace = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init_elem(pt_replace, 5, 'b');

    basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_replace = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "abc");
    basic_string_init_elem(pt_replace, 50, "xxx");

    basic_string_range_replace_substring(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        iterator_next_n(basic_string_begin(pt_basic_string), 9), pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 55);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 53)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_range_replace_substring__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_replace = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);
    basic_string_init_elem(pt_replace, 20, pvec);

    basic_string_range_replace_substring(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        basic_string_end(pt_basic_string), pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 24);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_range_replace_substring__user_define
{
    int n_elem;
}_test_basic_string_range_replace_substring__user_define_t;
void test_basic_string_range_replace_substring__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_replace = NULL;
    _test_basic_string_range_replace_substring__user_define_t t_user;

    type_register(_test_basic_string_range_replace_substring__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_range_replace_substring__user_define_t);
    pt_replace = create_basic_string(_test_basic_string_range_replace_substring__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;
    basic_string_init_elem(pt_replace, 20, &t_user);

    basic_string_range_replace_substring(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), pt_replace, 0, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_range_replace_substring__user_define_t*)basic_string_at(
            pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

/*
 * test basic_string_range_replace_cstr
 */
UT_CASE_DEFINATION(basic_string_range_replace_cstr)
void test_basic_string_range_replace_cstr__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_range_replace_cstr(
        NULL, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), "abcd"));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__null_replace(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), NULL));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;
    int elems[] = {3, 5, 0};
    basic_string_init(pt_basic_string);

    it_begin = basic_string_begin(pt_basic_string);
    it_end = basic_string_end(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_range_replace_cstr(
        pt_basic_string, it_begin, it_end, elems));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_range_replace_cstr__invalid_range(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 5, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_range_replace_cstr(
        pt_basic_string, basic_string_end(pt_basic_string), basic_string_begin(pt_basic_string), elems));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string), elems);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[11] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);
    memset(elems, 0x00, 11 * sizeof(int));
    for(i = 0; i < 10; ++i)
    {
        elems[i] = 500;
    }

    basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string), elems);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), elems);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[11] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);
    for(i = 0; i < 10; ++i)
    {
        elems[i] = 500;
    }

    basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), elems);
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), elems);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[11] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);
    for(i = 0; i < 10; ++i)
    {
        elems[i] = 500;
    }

    basic_string_range_replace_cstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 5), elems);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 8), elems);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 8), elems);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        basic_string_end(pt_basic_string), elems);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        basic_string_end(pt_basic_string), elems);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), elems);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), elems);
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), "bbbbb");
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"xxxx", "xxxx", "xxxx", "xxxx", "xxxx", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    basic_string_range_replace_cstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        iterator_next_n(basic_string_begin(pt_basic_string), 9), elems);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 8)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_cstr__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);

    basic_string_range_replace_cstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        basic_string_end(pt_basic_string), elems);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_range_replace_cstr__user_define
{
    int n_elem;
}_test_basic_string_range_replace_cstr__user_define_t;
void test_basic_string_range_replace_cstr__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_range_replace_cstr__user_define_t t_user;
    _test_basic_string_range_replace_cstr__user_define_t* elems[] = {&t_user, &t_user, &t_user, &t_user, &t_user, NULL};

    type_register(_test_basic_string_range_replace_cstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_range_replace_cstr__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;

    basic_string_range_replace_cstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), elems);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_range_replace_cstr__user_define_t*)basic_string_at(
            pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_range_replace_subcstr
 */
UT_CASE_DEFINATION(basic_string_range_replace_subcstr)
void test_basic_string_range_replace_subcstr__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(char);

    basic_string_init(pt_basic_string);
    expect_assert_failure(basic_string_range_replace_subcstr(
        NULL, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), "abcde", NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__null_replace(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), NULL, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_iterator_t it_begin;
    basic_string_iterator_t it_end;
    int elems[] = {3, 4, 5, 67, 0};
    basic_string_init(pt_basic_string);

    it_begin = basic_string_begin(pt_basic_string);
    it_end = basic_string_end(pt_basic_string);
    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_range_replace_subcstr(
        pt_basic_string, it_begin, it_end, elems, NPOS));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    */
}

void test_basic_string_range_replace_subcstr__invalid_range(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {3, 4, 5, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_end(pt_basic_string), basic_string_begin(pt_basic_string), elems, NPOS));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {2, 3, 4, 5, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string), elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string), elems, 5);
    assert_true(basic_string_size(pt_basic_string) == 15);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), elems, 10);
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 5), elems, 100);
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {4, 5, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 8), elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 8), elems, 2);
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        basic_string_end(pt_basic_string), elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        basic_string_end(pt_basic_string), elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), elems, 0);
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    int elems[] = {500, 500, 500, 500, 0};
    basic_string_init_elem(pt_basic_string, 10, 100);

    basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');

    basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3), "bbbbb", NPOS);
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    const char* elems[] = {"xxx", "xxx", "xxx", "xxx", "xxx", NULL};
    basic_string_init_elem(pt_basic_string, 10, "abc");

    basic_string_range_replace_subcstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        iterator_next_n(basic_string_begin(pt_basic_string), 9), elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 8)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_range_replace_subcstr__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);
    vector_t* elems[] = {pvec, pvec, pvec, NULL};

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);

    basic_string_range_replace_subcstr(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        basic_string_end(pt_basic_string), elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_range_replace_subcstr__user_define
{
    int n_elem;
}_test_basic_string_range_replace_subcstr__user_define_t;
void test_basic_string_range_replace_subcstr__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    _test_basic_string_range_replace_subcstr__user_define_t t_user;
    _test_basic_string_range_replace_subcstr__user_define_t* elems[] = {&t_user, &t_user, &t_user, NULL};

    type_register(_test_basic_string_range_replace_subcstr__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_range_replace_subcstr__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;

    basic_string_range_replace_subcstr(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string), elems, NPOS);
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_range_replace_subcstr__user_define_t*)basic_string_at(
            pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
}

/*
 * test basic_string_replace_range
 */
UT_CASE_DEFINATION(basic_string_replace_range)
void test_basic_string_replace_range__null_dest(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_range(
        NULL, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string),
        basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_range__non_inited_dest(void** state)
{
    /* comment for 2.2
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init(pt_basic_string);
    basic_string_init_elem(pt_replace, 10, 100);

    pt_basic_string->_vec_base._pby_finish = (_byte_t*)0x887;
    expect_assert_failure(basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_replace), basic_string_end(pt_replace),
        basic_string_begin(pt_replace), basic_string_end(pt_replace)));

    pt_basic_string->_vec_base._pby_finish = NULL;
    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    */
}

void test_basic_string_replace_range__not_same_type(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(double);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 10, 100.0);

    expect_assert_failure(basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string),
        basic_string_begin(pt_replace), basic_string_end(pt_replace)));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__same_container(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);

    expect_assert_failure(basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string),
        basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string)));

    basic_string_destroy(pt_basic_string);
}

void test_basic_string_replace_range__invalid_range(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 100);

    expect_assert_failure(basic_string_replace_range(
        pt_basic_string, basic_string_end(pt_basic_string), basic_string_begin(pt_basic_string),
        basic_string_begin(pt_replace), basic_string_end(pt_replace)));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__invalid_replace_range(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 100);

    expect_assert_failure(basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string),
        basic_string_end(pt_replace), basic_string_begin(pt_replace)));

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_begin_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string),
        basic_string_begin(pt_replace), basic_string_begin(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_begin_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_begin(pt_basic_string),
        basic_string_begin(pt_replace), iterator_next_n(basic_string_begin(pt_replace), 10));
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_begin_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_replace), 67), iterator_next_n(basic_string_begin(pt_replace), 67));
    assert_true(basic_string_size(pt_basic_string) == 7);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_begin_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3),/* pt_replace, 45, 10);*/
        iterator_next_n(basic_string_begin(pt_replace), 45), iterator_next_n(basic_string_begin(pt_replace), 55));
    assert_true(basic_string_size(pt_basic_string) == 17);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 10)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_middle_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 3),/* pt_replace, 66, 0);*/
        iterator_next_n(basic_string_begin(pt_replace), 66), iterator_next_n(basic_string_begin(pt_replace), 66));
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_middle_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 5),/* pt_replace, 90, 233);*/
        iterator_next_n(basic_string_begin(pt_replace), 90), basic_string_end(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 14)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_middle_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        iterator_next_n(basic_string_begin(pt_basic_string), 8),/* pt_replace, 5, 0);*/
        iterator_next_n(basic_string_begin(pt_replace), 5), iterator_next_n(basic_string_begin(pt_replace), 5));
    assert_true(basic_string_size(pt_basic_string) == 5);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_middle_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 2, 500);

    basic_string_replace_range(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        iterator_next_n(basic_string_begin(pt_basic_string), 8),/* pt_replace, 0, 55);*/
        basic_string_begin(pt_replace), basic_string_end(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 9);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5 || i > 6)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_end_non_empty_replace_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 3),
        basic_string_end(pt_basic_string), /*pt_replace, 0, 0);*/
        basic_string_begin(pt_replace), basic_string_begin(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 3);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_end_non_empty_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 5, 500);

    basic_string_replace_range(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 5),
        basic_string_end(pt_basic_string),/* pt_replace, 0, NPOS);*/
        basic_string_begin(pt_replace), basic_string_end(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 10);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 100);
        }
        else
        {
            assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_all_replace_empty(void** state)
{
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 100, 500);

    basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string),/* pt_replace, 56, 0);*/
        iterator_next_n(basic_string_begin(pt_replace), 56), iterator_next_n(basic_string_begin(pt_replace), 56));
    assert_true(basic_string_size(pt_basic_string) == 0);

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__c_builtin_all_replace_non_empty(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(int);
    basic_string_t* pt_replace = create_basic_string(int);
    basic_string_init_elem(pt_basic_string, 10, 100);
    basic_string_init_elem(pt_replace, 4, 500);

    basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string),/* pt_replace, 0, NPOS);*/
        basic_string_begin(pt_replace), basic_string_end(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 4);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(*(int*)basic_string_at(pt_basic_string, i) == 500);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__char(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char);
    basic_string_t* pt_replace = create_basic_string(char);
    basic_string_init_elem(pt_basic_string, 10, 'a');
    basic_string_init_elem(pt_replace, 5, 'b');

    basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string),
        iterator_next_n(basic_string_begin(pt_basic_string), 3),/* pt_replace, 0, NPOS);*/
        basic_string_begin(pt_replace), basic_string_end(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 12);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 5)
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'b');
        }
        else
        {
            assert_true(*(char*)basic_string_at(pt_basic_string, i) == 'a');
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__cstr(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(char*);
    basic_string_t* pt_replace = create_basic_string(char*);
    basic_string_init_elem(pt_basic_string, 10, "abc");
    basic_string_init_elem(pt_replace, 50, "xxx");

    basic_string_replace_range(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        iterator_next_n(basic_string_begin(pt_basic_string), 9),/* pt_replace, 0, NPOS);*/
        basic_string_begin(pt_replace), basic_string_end(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 55);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4 || i > 53)
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "abc") == 0);
        }
        else
        {
            assert_true(strcmp((char*)basic_string_at(pt_basic_string, i), "xxx") == 0);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

void test_basic_string_replace_range__libcstl_builtin(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = create_basic_string(vector_t<int>);
    basic_string_t* pt_replace = create_basic_string(vector_t<int>);
    vector_t* pvec = create_vector(int);

    vector_init(pvec);
    basic_string_init_elem(pt_basic_string, 10, pvec);
    vector_push_back(pvec, 19);
    basic_string_init_elem(pt_replace, 20, pvec);

    basic_string_replace_range(
        pt_basic_string, iterator_next_n(basic_string_begin(pt_basic_string), 4),
        basic_string_end(pt_basic_string),/* pt_replace, 0, NPOS);*/
        basic_string_begin(pt_replace), basic_string_end(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 24);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        if(i < 4)
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 0);
        }
        else
        {
            assert_true(vector_size((vector_t*)basic_string_at(pt_basic_string, i)) == 1);
        }
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
    vector_destroy(pvec);
}

typedef struct _tag_test_basic_string_replace_range__user_define
{
    int n_elem;
}_test_basic_string_replace_range__user_define_t;
void test_basic_string_replace_range__user_define(void** state)
{
    size_t i = 0;
    basic_string_t* pt_basic_string = NULL;
    basic_string_t* pt_replace = NULL;
    _test_basic_string_replace_range__user_define_t t_user;

    type_register(_test_basic_string_replace_range__user_define_t, NULL, NULL, NULL, NULL);
    pt_basic_string = create_basic_string(_test_basic_string_replace_range__user_define_t);
    pt_replace = create_basic_string(_test_basic_string_replace_range__user_define_t);
    t_user.n_elem = 100;
    basic_string_init_elem(pt_basic_string, 10, &t_user);
    t_user.n_elem = 555;
    basic_string_init_elem(pt_replace, 20, &t_user);

    basic_string_replace_range(
        pt_basic_string, basic_string_begin(pt_basic_string), basic_string_end(pt_basic_string),/* pt_replace, 0, NPOS);*/
        basic_string_begin(pt_replace), basic_string_end(pt_replace));
    assert_true(basic_string_size(pt_basic_string) == 20);
    for(i = 0; i < basic_string_size(pt_basic_string); ++i)
    {
        assert_true(((_test_basic_string_replace_range__user_define_t*)basic_string_at(
            pt_basic_string, i))->n_elem == 555);
    }

    basic_string_destroy(pt_basic_string);
    basic_string_destroy(pt_replace);
}

